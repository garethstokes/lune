Module {modName = "JsonParseDemo", modExports = [ExposeValue "main",ExposeValue "testParse",ExposeValue "testInvalid",ExposeValue "encodeDemo"], modImports = [Import {impName = "Lune.Prelude", impAs = Nothing, impExposing = Just [ExposeType "IO" ExposeOpaque,ExposeType "Result" ExposeAll,ExposeType "Unit" ExposeOpaque,ExposeValue "unit",ExposeType "List" ExposeAll,ExposeType "Bool" ExposeAll,ExposeType "String" ExposeOpaque]},Import {impName = "Lune.IO", impAs = Just "IO", impExposing = Nothing},Import {impName = "Lune.String", impAs = Just "Str", impExposing = Nothing},Import {impName = "Lune.Json", impAs = Just "Json", impExposing = Nothing},Import {impName = "Lune.Json", impAs = Nothing, impExposing = Just [ExposeType "Json" ExposeOpaque]},Import {impName = "Lune.Json.Encode", impAs = Just "E", impExposing = Nothing}], modDecls = [DeclTypeSig "main" (QualType {qualConstraints = [], qualType = TypeApp (TypeCon "IO") (TypeCon "Unit")}),DeclValue "main" [] (DoBlock [DiscardBindStmt (App (FieldAccess (Var "IO") "println") (StringLit "=== Parse Tests ===")),DiscardBindStmt (Var "testParse"),DiscardBindStmt (Var "testInvalid"),DiscardBindStmt (App (FieldAccess (Var "IO") "println") (StringLit "=== Encode Tests ===")),DiscardBindStmt (Var "testEncode"),ExprStmt (App (Var "pure") (Var "unit"))]),DeclTypeSig "testParse" (QualType {qualConstraints = [], qualType = TypeApp (TypeCon "IO") (TypeCon "Unit")}),DeclValue "testParse" [] (Case (App (FieldAccess (Var "Json") "parse") (StringLit "{\"name\":\"Alice\",\"age\":30}")) [Alt (PCon "Ok" [PVar "json"]) (App (FieldAccess (Var "IO") "println") (App (App (FieldAccess (Var "Str") "append") (StringLit "Parsed: ")) (App (FieldAccess (Var "Json") "stringify") (Var "json")))),Alt (PCon "Err" [PVar "msg"]) (App (FieldAccess (Var "IO") "println") (App (App (FieldAccess (Var "Str") "append") (StringLit "Error: ")) (Var "msg")))]),DeclTypeSig "testInvalid" (QualType {qualConstraints = [], qualType = TypeApp (TypeCon "IO") (TypeCon "Unit")}),DeclValue "testInvalid" [] (Case (App (FieldAccess (Var "Json") "parse") (StringLit "{invalid json}")) [Alt (PCon "Ok" [PWildcard]) (App (FieldAccess (Var "IO") "println") (StringLit "Unexpected success")),Alt (PCon "Err" [PVar "msg"]) (App (FieldAccess (Var "IO") "println") (App (App (FieldAccess (Var "Str") "append") (StringLit "Expected error: ")) (Var "msg")))]),DeclTypeSig "testEncode" (QualType {qualConstraints = [], qualType = TypeApp (TypeCon "IO") (TypeCon "Unit")}),DeclValue "testEncode" [] (DoBlock [DiscardBindStmt (App (FieldAccess (Var "IO") "println") (App (App (FieldAccess (Var "Str") "append") (StringLit "Encoded object: ")) (App (FieldAccess (Var "Json") "stringify") (Var "encodeDemo")))),DiscardBindStmt (App (FieldAccess (Var "IO") "println") (App (App (FieldAccess (Var "Str") "append") (StringLit "Encoded array: ")) (App (FieldAccess (Var "Json") "stringify") (Var "arrDemo")))),DiscardBindStmt (App (FieldAccess (Var "IO") "println") (App (App (FieldAccess (Var "Str") "append") (StringLit "Encoded null: ")) (App (FieldAccess (Var "Json") "stringify") (FieldAccess (Var "E") "null")))),ExprStmt (App (Var "pure") (Var "unit"))]),DeclTypeSig "encodeDemo" (QualType {qualConstraints = [], qualType = TypeCon "Json"}),DeclValue "encodeDemo" [] (App (FieldAccess (Var "E") "object") (App (App (Var "Cons") (RecordLiteral [("key",StringLit "name"),("value",App (FieldAccess (Var "E") "string") (StringLit "Bob"))])) (App (App (Var "Cons") (RecordLiteral [("key",StringLit "active"),("value",App (FieldAccess (Var "E") "bool") (Var "True"))])) (App (App (Var "Cons") (RecordLiteral [("key",StringLit "score"),("value",App (FieldAccess (Var "E") "int") (IntLit 42))])) (Var "Nil"))))),DeclTypeSig "arrDemo" (QualType {qualConstraints = [], qualType = TypeCon "Json"}),DeclValue "arrDemo" [] (App (App (FieldAccess (Var "E") "list") (FieldAccess (Var "E") "int")) (App (App (Var "Cons") (IntLit 1)) (App (App (Var "Cons") (IntLit 2)) (App (App (Var "Cons") (IntLit 3)) (Var "Nil")))))]}
