Module {modName = "HttpParseTest", modExports = [ExposeValue "main"], modImports = [Import {impName = "Lune.IO", impAs = Just "IO", impExposing = Nothing},Import {impName = "Lune.Http", impAs = Just "Http", impExposing = Nothing},Import {impName = "Lune.String", impAs = Just "Str", impExposing = Nothing},Import {impName = "Lune.Prelude", impAs = Nothing, impExposing = Just [ExposeType "Result" ExposeAll,ExposeType "IO" ExposeOpaque,ExposeType "Unit" ExposeOpaque]}], modDecls = [DeclTypeSig "main" (QualType {qualConstraints = [], qualType = TypeApp (TypeCon "IO") (TypeCon "Unit")}),DeclValue "main" [] (DoBlock [ExprStmt (App (FieldAccess (Var "IO") "println") (StringLit "=== HTTP Parse Test ===")),ExprStmt (Var "testParseGet"),ExprStmt (Var "testParsePost")]),DeclTypeSig "testParseGet" (QualType {qualConstraints = [], qualType = TypeApp (TypeCon "IO") (TypeCon "Unit")}),DeclValue "testParseGet" [] (Case (App (Var "prim_parseHttpRequest") (StringLit "GET /users/123 HTTP/1.1\r\nHost: localhost\r\n\r\n")) [Alt (PCon "Err" [PVar "e"]) (App (FieldAccess (Var "IO") "println") (App (App (FieldAccess (Var "Str") "append") (StringLit "Parse error: ")) (Var "e"))),Alt (PCon "Ok" [PVar "req"]) (DoBlock [ExprStmt (App (FieldAccess (Var "IO") "println") (App (App (FieldAccess (Var "Str") "append") (StringLit "Path: ")) (FieldAccess (Var "req") "path"))),ExprStmt (App (FieldAccess (Var "IO") "println") (StringLit "GET request parsed successfully"))])]),DeclTypeSig "testParsePost" (QualType {qualConstraints = [], qualType = TypeApp (TypeCon "IO") (TypeCon "Unit")}),DeclValue "testParsePost" [] (Case (App (Var "prim_parseHttpRequest") (StringLit "POST /users HTTP/1.1\r\nContent-Type: application/json\r\n\r\n{\"name\":\"Alice\"}")) [Alt (PCon "Err" [PVar "e"]) (App (FieldAccess (Var "IO") "println") (App (App (FieldAccess (Var "Str") "append") (StringLit "Parse error: ")) (Var "e"))),Alt (PCon "Ok" [PVar "req"]) (DoBlock [ExprStmt (App (FieldAccess (Var "IO") "println") (App (App (FieldAccess (Var "Str") "append") (StringLit "Path: ")) (FieldAccess (Var "req") "path"))),ExprStmt (App (FieldAccess (Var "IO") "println") (App (App (FieldAccess (Var "Str") "append") (StringLit "Body: ")) (FieldAccess (Var "req") "body"))),ExprStmt (App (FieldAccess (Var "IO") "println") (StringLit "POST request parsed successfully"))])])]}
