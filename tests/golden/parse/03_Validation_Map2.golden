Module {modName = "ValidationDemo", modExports = [ExposeType "Validation" ExposeAll,ExposeValue "map2",ExposeValue "validateUser"], modImports = [Import {impName = "Lune.Int", impAs = Just "Int", impExposing = Nothing}], modDecls = [DeclType "Validation" ["e","a"] [TypeCtor "Invalid" [TypeVar "e"],TypeCtor "Valid" [TypeVar "a"]],DeclTypeSig "appendErrors" (QualType {qualConstraints = [], qualType = TypeArrow (TypeApp (TypeCon "List") (TypeCon "String")) (TypeArrow (TypeApp (TypeCon "List") (TypeCon "String")) (TypeApp (TypeCon "List") (TypeCon "String")))}),DeclValue "appendErrors" [PVar "xs",PVar "ys"] (Case (Var "xs") [Alt (PCon "Nil" []) (Var "ys"),Alt (PCon "Cons" [PVar "x",PVar "xt"]) (App (App (Var "Cons") (Var "x")) (App (App (Var "appendErrors") (Var "xt")) (Var "ys")))]),DeclTypeSig "map2" (QualType {qualConstraints = [], qualType = TypeArrow (TypeArrow (TypeVar "a") (TypeArrow (TypeVar "b") (TypeVar "c"))) (TypeArrow (TypeApp (TypeApp (TypeCon "Validation") (TypeApp (TypeCon "List") (TypeCon "String"))) (TypeVar "a")) (TypeArrow (TypeApp (TypeApp (TypeCon "Validation") (TypeApp (TypeCon "List") (TypeCon "String"))) (TypeVar "b")) (TypeApp (TypeApp (TypeCon "Validation") (TypeApp (TypeCon "List") (TypeCon "String"))) (TypeVar "c"))))}),DeclValue "map2" [PVar "f",PVar "va",PVar "vb"] (Case (Var "va") [Alt (PCon "Invalid" [PVar "ea"]) (Case (Var "vb") [Alt (PCon "Invalid" [PVar "eb"]) (App (Var "Invalid") (App (App (Var "appendErrors") (Var "ea")) (Var "eb"))),Alt (PCon "Valid" [PWildcard]) (App (Var "Invalid") (Var "ea"))]),Alt (PCon "Valid" [PVar "a"]) (Case (Var "vb") [Alt (PCon "Invalid" [PVar "eb"]) (App (Var "Invalid") (Var "eb")),Alt (PCon "Valid" [PVar "b"]) (App (Var "Valid") (App (App (Var "f") (Var "a")) (Var "b")))])]),DeclTypeAlias "User" [] (TypeRecord [("name",TypeCon "String"),("age",TypeCon "Int")]),DeclTypeSig "validateName" (QualType {qualConstraints = [], qualType = TypeArrow (TypeCon "String") (TypeApp (TypeApp (TypeCon "Validation") (TypeApp (TypeCon "List") (TypeCon "String"))) (TypeCon "String"))}),DeclValue "validateName" [PVar "s"] (App (Var "Valid") (Var "s")),DeclTypeSig "validateAge" (QualType {qualConstraints = [], qualType = TypeArrow (TypeCon "Int") (TypeApp (TypeApp (TypeCon "Validation") (TypeApp (TypeCon "List") (TypeCon "String"))) (TypeCon "Int"))}),DeclValue "validateAge" [PVar "n"] (Case (App (App (FieldAccess (Var "Int") "gte") (Var "n")) (IntLit 0)) [Alt (PCon "True" []) (App (Var "Valid") (Var "n")),Alt (PCon "False" []) (App (Var "Invalid") (App (App (Var "Cons") (StringLit "age must be >= 0")) (Var "Nil")))]),DeclTypeSig "mkUser" (QualType {qualConstraints = [], qualType = TypeArrow (TypeCon "String") (TypeArrow (TypeCon "Int") (TypeCon "User"))}),DeclValue "mkUser" [PVar "name",PVar "age"] (RecordLiteral [("name",Var "name"),("age",Var "age")]),DeclTypeSig "validateUser" (QualType {qualConstraints = [], qualType = TypeArrow (TypeRecord [("name",TypeCon "String"),("age",TypeCon "Int")]) (TypeApp (TypeApp (TypeCon "Validation") (TypeApp (TypeCon "List") (TypeCon "String"))) (TypeCon "User"))}),DeclValue "validateUser" [PVar "input"] (App (App (App (Var "map2") (Var "mkUser")) (App (Var "validateName") (FieldAccess (Var "input") "name"))) (App (Var "validateAge") (FieldAccess (Var "input") "age")))]}
