Module {modName = "DatabaseCRUD", modExports = [ExposeValue "main"], modImports = [Import {impName = "Lune.IO", impAs = Just "IO", impExposing = Nothing},Import {impName = "Lune.Prelude", impAs = Nothing, impExposing = Just [ExposeType "IO" ExposeOpaque,ExposeType "Result" ExposeAll,ExposeType "Unit" ExposeOpaque,ExposeType "List" ExposeAll,ExposeType "Maybe" ExposeAll,ExposeType "Int" ExposeOpaque,ExposeType "String" ExposeOpaque,ExposeType "Bool" ExposeAll]},Import {impName = "Lune.Database", impAs = Just "Database", impExposing = Just [ExposeType "DbValue" ExposeAll]},Import {impName = "Lune.Database.Decode", impAs = Just "Decode", impExposing = Just [ExposeType "Decoder" ExposeOpaque]},Import {impName = "Lune.Database.Query", impAs = Just "Query", impExposing = Just [ExposeType "Table" ExposeOpaque,ExposeType "Column" ExposeOpaque,ExposeType "Query" ExposeOpaque,ExposeType "Order" ExposeAll,ExposeType "QueryType" ExposeAll]},Import {impName = "Lune.String", impAs = Just "Str", impExposing = Nothing}], modDecls = [DeclTypeSig "users" (QualType {qualConstraints = [], qualType = TypeCon "Table"}),DeclValue "users" [] (App (FieldAccess (Var "Query") "table") (StringLit "users")),DeclTypeSig "users_id" (QualType {qualConstraints = [], qualType = TypeApp (TypeCon "Column") (TypeCon "Int")}),DeclValue "users_id" [] (App (App (FieldAccess (Var "Query") "column") (Var "users")) (StringLit "id")),DeclTypeSig "users_name" (QualType {qualConstraints = [], qualType = TypeApp (TypeCon "Column") (TypeCon "String")}),DeclValue "users_name" [] (App (App (FieldAccess (Var "Query") "column") (Var "users")) (StringLit "name")),DeclTypeSig "users_email" (QualType {qualConstraints = [], qualType = TypeApp (TypeCon "Column") (TypeCon "String")}),DeclValue "users_email" [] (App (App (FieldAccess (Var "Query") "column") (Var "users")) (StringLit "email")),DeclTypeAlias "User" [] (TypeRecord [("id",TypeCon "Int"),("name",TypeCon "String"),("email",TypeCon "String")]),DeclTypeSig "userDecoder" (QualType {qualConstraints = [], qualType = TypeApp (TypeCon "Decoder") (TypeCon "User")}),DeclValue "userDecoder" [] (App (App (App (App (FieldAccess (Var "Decode") "map3") (Lam [PVar "id",PVar "name",PVar "email"] (RecordLiteral [("id",Var "id"),("name",Var "name"),("email",Var "email")]))) (App (App (FieldAccess (Var "Decode") "index") (IntLit 0)) (FieldAccess (Var "Decode") "int"))) (App (App (FieldAccess (Var "Decode") "index") (IntLit 1)) (FieldAccess (Var "Decode") "string"))) (App (App (FieldAccess (Var "Decode") "index") (IntLit 2)) (FieldAccess (Var "Decode") "string"))),DeclTypeSig "insertQuery" (QualType {qualConstraints = [], qualType = TypeApp (TypeCon "Query") (TypeCon "User")}),DeclValue "insertQuery" [] (App (FieldAccess (Var "Query") "returning") (App (App (FieldAccess (Var "Query") "values") (App (App (Var "Cons") (App (App (FieldAccess (Var "Query") "set") (Var "users_name")) (App (FieldAccess (Var "Database") "string") (StringLit "Alice")))) (App (App (Var "Cons") (App (App (FieldAccess (Var "Query") "set") (Var "users_email")) (App (FieldAccess (Var "Database") "string") (StringLit "alice@example.com")))) (Var "Nil")))) (App (App (FieldAccess (Var "Query") "insert") (Var "users")) (Var "userDecoder")))),DeclTypeSig "insertNoReturnQuery" (QualType {qualConstraints = [], qualType = TypeApp (TypeCon "Query") (TypeCon "User")}),DeclValue "insertNoReturnQuery" [] (App (App (FieldAccess (Var "Query") "values") (App (App (Var "Cons") (App (App (FieldAccess (Var "Query") "set") (Var "users_name")) (App (FieldAccess (Var "Database") "string") (StringLit "Bob")))) (App (App (Var "Cons") (App (App (FieldAccess (Var "Query") "set") (Var "users_email")) (App (FieldAccess (Var "Database") "string") (StringLit "bob@example.com")))) (Var "Nil")))) (App (App (FieldAccess (Var "Query") "insert") (Var "users")) (Var "userDecoder"))),DeclTypeSig "updateQuery" (QualType {qualConstraints = [], qualType = TypeApp (TypeCon "Query") (TypeCon "User")}),DeclValue "updateQuery" [] (App (FieldAccess (Var "Query") "returning") (App (App (FieldAccess (Var "Query") "where_") (App (App (FieldAccess (Var "Query") "eq") (Var "users_id")) (App (FieldAccess (Var "Database") "int") (IntLit 42)))) (App (App (FieldAccess (Var "Query") "values") (App (App (Var "Cons") (App (App (FieldAccess (Var "Query") "set") (Var "users_name")) (App (FieldAccess (Var "Database") "string") (StringLit "Updated Name")))) (Var "Nil"))) (App (App (FieldAccess (Var "Query") "update") (Var "users")) (Var "userDecoder"))))),DeclTypeSig "deleteQuery" (QualType {qualConstraints = [], qualType = TypeApp (TypeCon "Query") (TypeCon "Unit")}),DeclValue "deleteQuery" [] (App (App (FieldAccess (Var "Query") "where_") (App (App (FieldAccess (Var "Query") "eq") (Var "users_id")) (App (FieldAccess (Var "Database") "int") (IntLit 42)))) (App (FieldAccess (Var "Query") "delete") (Var "users"))),DeclTypeSig "main" (QualType {qualConstraints = [], qualType = TypeApp (TypeCon "IO") (TypeCon "Unit")}),DeclValue "main" [] (DoBlock [ExprStmt (App (FieldAccess (Var "IO") "println") (StringLit "=== CRUD Query Builder Examples ===")),ExprStmt (App (FieldAccess (Var "IO") "println") (StringLit "")),ExprStmt (Var "insertExample"),ExprStmt (App (FieldAccess (Var "IO") "println") (StringLit "")),ExprStmt (Var "insertNoReturnExample"),ExprStmt (App (FieldAccess (Var "IO") "println") (StringLit "")),ExprStmt (Var "updateExample"),ExprStmt (App (FieldAccess (Var "IO") "println") (StringLit "")),ExprStmt (Var "deleteExample"),ExprStmt (App (FieldAccess (Var "IO") "println") (StringLit "")),ExprStmt (App (FieldAccess (Var "IO") "println") (StringLit "Done!"))]),DeclTypeSig "insertExample" (QualType {qualConstraints = [], qualType = TypeApp (TypeCon "IO") (TypeCon "Unit")}),DeclValue "insertExample" [] (DoBlock [ExprStmt (App (FieldAccess (Var "IO") "println") (StringLit "1. INSERT with RETURNING:")),ExprStmt (App (FieldAccess (Var "IO") "println") (StringLit "   Query.insert users userDecoder")),ExprStmt (App (FieldAccess (Var "IO") "println") (StringLit "     |> Query.values [set name, set email]")),ExprStmt (App (FieldAccess (Var "IO") "println") (StringLit "     |> Query.returning")),ExprStmt (App (Var "printSql") (Var "insertQuery"))]),DeclTypeSig "insertNoReturnExample" (QualType {qualConstraints = [], qualType = TypeApp (TypeCon "IO") (TypeCon "Unit")}),DeclValue "insertNoReturnExample" [] (DoBlock [ExprStmt (App (FieldAccess (Var "IO") "println") (StringLit "2. INSERT without RETURNING:")),ExprStmt (App (FieldAccess (Var "IO") "println") (StringLit "   Query.insert users userDecoder")),ExprStmt (App (FieldAccess (Var "IO") "println") (StringLit "     |> Query.values [set name, set email]")),ExprStmt (App (Var "printSql") (Var "insertNoReturnQuery"))]),DeclTypeSig "updateExample" (QualType {qualConstraints = [], qualType = TypeApp (TypeCon "IO") (TypeCon "Unit")}),DeclValue "updateExample" [] (DoBlock [ExprStmt (App (FieldAccess (Var "IO") "println") (StringLit "3. UPDATE with WHERE and RETURNING:")),ExprStmt (App (FieldAccess (Var "IO") "println") (StringLit "   Query.update users userDecoder")),ExprStmt (App (FieldAccess (Var "IO") "println") (StringLit "     |> Query.values [set name]")),ExprStmt (App (FieldAccess (Var "IO") "println") (StringLit "     |> Query.where_ (Query.eq users_id 42)")),ExprStmt (App (FieldAccess (Var "IO") "println") (StringLit "     |> Query.returning")),ExprStmt (App (Var "printSql") (Var "updateQuery"))]),DeclTypeSig "deleteExample" (QualType {qualConstraints = [], qualType = TypeApp (TypeCon "IO") (TypeCon "Unit")}),DeclValue "deleteExample" [] (DoBlock [ExprStmt (App (FieldAccess (Var "IO") "println") (StringLit "4. DELETE with WHERE:")),ExprStmt (App (FieldAccess (Var "IO") "println") (StringLit "   Query.delete users")),ExprStmt (App (FieldAccess (Var "IO") "println") (StringLit "     |> Query.where_ (Query.eq users_id 42)")),ExprStmt (App (Var "printSql") (Var "deleteQuery"))]),DeclTypeSig "printSql" (QualType {qualConstraints = [], qualType = TypeArrow (TypeApp (TypeCon "Query") (TypeVar "a")) (TypeApp (TypeCon "IO") (TypeCon "Unit"))}),DeclValue "printSql" [PVar "q"] (App (FieldAccess (Var "IO") "println") (App (App (FieldAccess (Var "Str") "append") (StringLit "   SQL: ")) (App (FieldAccess (Var "Query") "getSql") (Var "q"))))]}
