Module {modName = "QueryParams", modExports = [ExposeValue "main"], modImports = [Import {impName = "Lune.IO", impAs = Just "IO", impExposing = Nothing},Import {impName = "Lune.Prelude", impAs = Nothing, impExposing = Just [ExposeType "IO" ExposeOpaque,ExposeType "Unit" ExposeOpaque,ExposeType "Maybe" ExposeAll,ExposeType "List" ExposeAll]}], modDecls = [DeclTypeSig "main" (QualType {qualConstraints = [], qualType = TypeApp (TypeCon "IO") (TypeCon "Unit")}),DeclValue "main" [] (DoBlock [LetStmt "params" (App (Var "prim_parseQueryString") (StringLit "/search?q=hello&page=2&sort=asc")),ExprStmt (App (Var "printParams") (Var "params"))]),DeclTypeSig "printParams" (QualType {qualConstraints = [], qualType = TypeArrow (TypeApp (TypeCon "List") (TypeRecord [("key",TypeCon "String"),("value",TypeCon "String")])) (TypeApp (TypeCon "IO") (TypeCon "Unit"))}),DeclValue "printParams" [PVar "ps"] (Case (Var "ps") [Alt (PCon "Nil" []) (App (FieldAccess (Var "IO") "println") (StringLit "done")),Alt (PCon "Cons" [PVar "p",PVar "rest"]) (DoBlock [ExprStmt (App (FieldAccess (Var "IO") "println") (App (App (Var "prim_appendString") (FieldAccess (Var "p") "key")) (App (App (Var "prim_appendString") (StringLit "=")) (FieldAccess (Var "p") "value")))),ExprStmt (App (Var "printParams") (Var "rest"))])])]}
