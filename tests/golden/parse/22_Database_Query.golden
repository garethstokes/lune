Module {modName = "DatabaseQuery", modExports = [ExposeValue "main"], modImports = [Import {impName = "Lune.IO", impAs = Just "IO", impExposing = Nothing},Import {impName = "Lune.Prelude", impAs = Nothing, impExposing = Just [ExposeType "IO" ExposeOpaque,ExposeType "Result" ExposeAll,ExposeType "Unit" ExposeOpaque,ExposeType "List" ExposeAll,ExposeType "Maybe" ExposeAll,ExposeType "Int" ExposeOpaque,ExposeType "String" ExposeOpaque,ExposeType "Bool" ExposeAll]},Import {impName = "Lune.Database", impAs = Just "Database", impExposing = Just [ExposeType "DbValue" ExposeAll]},Import {impName = "Lune.Database.Decode", impAs = Just "Decode", impExposing = Just [ExposeType "Decoder" ExposeOpaque]},Import {impName = "Lune.Database.Query", impAs = Just "Query", impExposing = Just [ExposeType "Table" ExposeOpaque,ExposeType "Column" ExposeOpaque,ExposeType "Query" ExposeOpaque,ExposeType "Order" ExposeAll]},Import {impName = "Lune.String", impAs = Just "Str", impExposing = Nothing}], modDecls = [DeclTypeSig "users" (QualType {qualConstraints = [], qualType = TypeCon "Table"}),DeclValue "users" [] (App (FieldAccess (Var "Query") "table") (StringLit "users")),DeclTypeSig "users_id" (QualType {qualConstraints = [], qualType = TypeApp (TypeCon "Column") (TypeCon "Int")}),DeclValue "users_id" [] (App (App (FieldAccess (Var "Query") "column") (Var "users")) (StringLit "id")),DeclTypeSig "users_name" (QualType {qualConstraints = [], qualType = TypeApp (TypeCon "Column") (TypeCon "String")}),DeclValue "users_name" [] (App (App (FieldAccess (Var "Query") "column") (Var "users")) (StringLit "name")),DeclTypeSig "users_email" (QualType {qualConstraints = [], qualType = TypeApp (TypeCon "Column") (TypeCon "String")}),DeclValue "users_email" [] (App (App (FieldAccess (Var "Query") "column") (Var "users")) (StringLit "email")),DeclTypeAlias "User" [] (TypeRecord [("id",TypeCon "Int"),("name",TypeCon "String"),("email",TypeCon "String")]),DeclTypeSig "userDecoder" (QualType {qualConstraints = [], qualType = TypeApp (TypeCon "Decoder") (TypeCon "User")}),DeclValue "userDecoder" [] (App (App (App (App (FieldAccess (Var "Decode") "map3") (Lam [PVar "id",PVar "name",PVar "email"] (RecordLiteral [("id",Var "id"),("name",Var "name"),("email",Var "email")]))) (App (App (FieldAccess (Var "Decode") "index") (IntLit 0)) (FieldAccess (Var "Decode") "int"))) (App (App (FieldAccess (Var "Decode") "index") (IntLit 1)) (FieldAccess (Var "Decode") "string"))) (App (App (FieldAccess (Var "Decode") "index") (IntLit 2)) (FieldAccess (Var "Decode") "string"))),DeclTypeSig "simpleQuery" (QualType {qualConstraints = [], qualType = TypeApp (TypeCon "Query") (TypeCon "User")}),DeclValue "simpleQuery" [] (App (App (FieldAccess (Var "Query") "select") (Var "users")) (Var "userDecoder")),DeclTypeSig "whereQuery" (QualType {qualConstraints = [], qualType = TypeApp (TypeCon "Query") (TypeCon "User")}),DeclValue "whereQuery" [] (App (App (FieldAccess (Var "Query") "where_") (App (App (FieldAccess (Var "Query") "eq") (Var "users_id")) (App (FieldAccess (Var "Database") "int") (IntLit 42)))) (App (App (FieldAccess (Var "Query") "select") (Var "users")) (Var "userDecoder"))),DeclTypeSig "orderByLimitQuery" (QualType {qualConstraints = [], qualType = TypeApp (TypeCon "Query") (TypeCon "User")}),DeclValue "orderByLimitQuery" [] (App (App (FieldAccess (Var "Query") "limit") (IntLit 10)) (App (App (App (FieldAccess (Var "Query") "orderBy") (Var "users_name")) (Var "Asc")) (App (App (FieldAccess (Var "Query") "select") (Var "users")) (Var "userDecoder")))),DeclTypeSig "combinedQuery" (QualType {qualConstraints = [], qualType = TypeApp (TypeCon "Query") (TypeCon "User")}),DeclValue "combinedQuery" [] (App (App (FieldAccess (Var "Query") "limit") (IntLit 5)) (App (App (App (FieldAccess (Var "Query") "orderBy") (Var "users_name")) (Var "Desc")) (App (App (FieldAccess (Var "Query") "where_") (App (App (FieldAccess (Var "Query") "eq") (Var "users_id")) (App (FieldAccess (Var "Database") "int") (IntLit 42)))) (App (App (FieldAccess (Var "Query") "select") (Var "users")) (Var "userDecoder"))))),DeclTypeSig "main" (QualType {qualConstraints = [], qualType = TypeApp (TypeCon "IO") (TypeCon "Unit")}),DeclValue "main" [] (DoBlock [ExprStmt (App (FieldAccess (Var "IO") "println") (StringLit "=== Query Builder Examples ===")),ExprStmt (App (FieldAccess (Var "IO") "println") (StringLit "")),ExprStmt (Var "simpleSelectExample"),ExprStmt (App (FieldAccess (Var "IO") "println") (StringLit "")),ExprStmt (Var "whereExample"),ExprStmt (App (FieldAccess (Var "IO") "println") (StringLit "")),ExprStmt (Var "orderByLimitExample"),ExprStmt (App (FieldAccess (Var "IO") "println") (StringLit "")),ExprStmt (Var "combinedExample"),ExprStmt (App (FieldAccess (Var "IO") "println") (StringLit "")),ExprStmt (App (FieldAccess (Var "IO") "println") (StringLit "Done!"))]),DeclTypeSig "simpleSelectExample" (QualType {qualConstraints = [], qualType = TypeApp (TypeCon "IO") (TypeCon "Unit")}),DeclValue "simpleSelectExample" [] (DoBlock [ExprStmt (App (FieldAccess (Var "IO") "println") (StringLit "1. Simple SELECT:")),ExprStmt (App (FieldAccess (Var "IO") "println") (StringLit "   Query.select users userDecoder")),ExprStmt (App (Var "printSql") (Var "simpleQuery"))]),DeclTypeSig "whereExample" (QualType {qualConstraints = [], qualType = TypeApp (TypeCon "IO") (TypeCon "Unit")}),DeclValue "whereExample" [] (DoBlock [ExprStmt (App (FieldAccess (Var "IO") "println") (StringLit "2. SELECT with WHERE:")),ExprStmt (App (FieldAccess (Var "IO") "println") (StringLit "   Query.where_ (Query.eq users_id (Database.int 42))")),ExprStmt (App (FieldAccess (Var "IO") "println") (StringLit "     (Query.select users userDecoder)")),ExprStmt (App (Var "printSql") (Var "whereQuery"))]),DeclTypeSig "orderByLimitExample" (QualType {qualConstraints = [], qualType = TypeApp (TypeCon "IO") (TypeCon "Unit")}),DeclValue "orderByLimitExample" [] (DoBlock [ExprStmt (App (FieldAccess (Var "IO") "println") (StringLit "3. SELECT with ORDER BY and LIMIT:")),ExprStmt (App (FieldAccess (Var "IO") "println") (StringLit "   Query.limit 10")),ExprStmt (App (FieldAccess (Var "IO") "println") (StringLit "     (Query.orderBy users_name Asc")),ExprStmt (App (FieldAccess (Var "IO") "println") (StringLit "       (Query.select users userDecoder))")),ExprStmt (App (Var "printSql") (Var "orderByLimitQuery"))]),DeclTypeSig "combinedExample" (QualType {qualConstraints = [], qualType = TypeApp (TypeCon "IO") (TypeCon "Unit")}),DeclValue "combinedExample" [] (DoBlock [ExprStmt (App (FieldAccess (Var "IO") "println") (StringLit "4. Combined query:")),ExprStmt (App (FieldAccess (Var "IO") "println") (StringLit "   Query.limit 5")),ExprStmt (App (FieldAccess (Var "IO") "println") (StringLit "     (Query.orderBy users_name Desc")),ExprStmt (App (FieldAccess (Var "IO") "println") (StringLit "       (Query.where_ (Query.eq users_id (Database.int 42))")),ExprStmt (App (FieldAccess (Var "IO") "println") (StringLit "         (Query.select users userDecoder)))")),ExprStmt (App (Var "printSql") (Var "combinedQuery"))]),DeclTypeSig "printSql" (QualType {qualConstraints = [], qualType = TypeArrow (TypeApp (TypeCon "Query") (TypeVar "a")) (TypeApp (TypeCon "IO") (TypeCon "Unit"))}),DeclValue "printSql" [PVar "q"] (App (FieldAccess (Var "IO") "println") (App (App (FieldAccess (Var "Str") "append") (StringLit "   SQL: ")) (App (FieldAccess (Var "Query") "getSql") (Var "q"))))]}
