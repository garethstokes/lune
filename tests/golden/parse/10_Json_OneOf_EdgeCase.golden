Module {modName = "JsonOneOfEdgeCase", modExports = [ExposeValue "main",ExposeValue "testOneOfLastError"], modImports = [Import {impName = "Lune.Prelude", impAs = Nothing, impExposing = Just [ExposeType "IO" ExposeOpaque,ExposeType "Result" ExposeAll,ExposeType "Unit" ExposeOpaque,ExposeValue "unit",ExposeType "List" ExposeAll,ExposeType "Bool" ExposeAll,ExposeType "String" ExposeOpaque,ExposeType "Int" ExposeOpaque]},Import {impName = "Lune.IO", impAs = Just "IO", impExposing = Nothing},Import {impName = "Lune.String", impAs = Just "Str", impExposing = Nothing},Import {impName = "Lune.Json", impAs = Just "Json", impExposing = Nothing},Import {impName = "Lune.Json", impAs = Nothing, impExposing = Just [ExposeType "Json" ExposeOpaque]},Import {impName = "Lune.Json.Decode", impAs = Just "D", impExposing = Nothing},Import {impName = "Lune.Json.Decode", impAs = Nothing, impExposing = Just [ExposeType "PathItem" ExposeAll]}], modDecls = [DeclTypeSig "main" (QualType {qualConstraints = [], qualType = TypeApp (TypeCon "IO") (TypeCon "Unit")}),DeclValue "main" [] (DoBlock [DiscardBindStmt (App (FieldAccess (Var "IO") "println") (StringLit "=== oneOf Edge Case Test ===")),DiscardBindStmt (Var "testOneOfLastError"),ExprStmt (App (Var "pure") (Var "unit"))]),DeclTypeSig "testOneOfLastError" (QualType {qualConstraints = [], qualType = TypeApp (TypeCon "IO") (TypeCon "Unit")}),DeclValue "testOneOfLastError" [] (Case (App (FieldAccess (Var "Json") "parse") (StringLit "{}")) [Alt (PCon "Err" [PWildcard]) (App (FieldAccess (Var "IO") "println") (StringLit "FAIL: Parse failed")),Alt (PCon "Ok" [PVar "json"]) (App (Var "checkOneOfResult") (Var "json"))]),DeclTypeSig "checkOneOfResult" (QualType {qualConstraints = [], qualType = TypeArrow (TypeCon "Json") (TypeApp (TypeCon "IO") (TypeCon "Unit"))}),DeclValue "checkOneOfResult" [PVar "json"] (Case (App (App (FieldAccess (Var "D") "decodeValue") (App (FieldAccess (Var "D") "oneOf") (App (App (Var "Cons") (App (App (FieldAccess (Var "D") "field") (StringLit "a")) (FieldAccess (Var "D") "int"))) (App (App (Var "Cons") (App (App (FieldAccess (Var "D") "field") (StringLit "b")) (FieldAccess (Var "D") "int"))) (Var "Nil"))))) (Var "json")) [Alt (PCon "Ok" [PWildcard]) (App (FieldAccess (Var "IO") "println") (StringLit "FAIL: Unexpected success")),Alt (PCon "Err" [PVar "err"]) (Case (App (Var "checkPath") (FieldAccess (Var "err") "path")) [Alt (PCon "True" []) (App (FieldAccess (Var "IO") "println") (App (App (FieldAccess (Var "Str") "append") (StringLit "PASS: Got expected error with path [Field \"b\"]: ")) (FieldAccess (Var "err") "message"))),Alt (PCon "False" []) (App (FieldAccess (Var "IO") "println") (App (App (FieldAccess (Var "Str") "append") (StringLit "FAIL: Wrong path, expected [Field \"b\"], message: ")) (FieldAccess (Var "err") "message")))])]),DeclTypeSig "checkPath" (QualType {qualConstraints = [], qualType = TypeArrow (TypeApp (TypeCon "List") (TypeCon "PathItem")) (TypeCon "Bool")}),DeclValue "checkPath" [PVar "path"] (Case (Var "path") [Alt (PCon "Cons" [PVar "item",PCon "Nil" []]) (Case (Var "item") [Alt (PCon "Field" [PVar "name"]) (Case (App (App (FieldAccess (Var "Str") "eq") (Var "name")) (StringLit "b")) [Alt (PCon "True" []) (Var "True"),Alt (PCon "False" []) (Var "False")]),Alt (PCon "Index" [PWildcard]) (Var "False")]),Alt PWildcard (Var "False")])]}
