Module {modName = "JsonDecode", modExports = [ExposeValue "main"], modImports = [Import {impName = "Lune.IO", impAs = Just "IO", impExposing = Nothing},Import {impName = "Lune.Json", impAs = Just "Json", impExposing = Nothing},Import {impName = "Lune.Json.Decode", impAs = Just "D", impExposing = Nothing},Import {impName = "Lune.Json.Decode", impAs = Nothing, impExposing = Just [ExposeType "Decoder" ExposeOpaque]},Import {impName = "Lune.String", impAs = Just "Str", impExposing = Nothing},Import {impName = "Lune.Prelude", impAs = Nothing, impExposing = Just [ExposeType "IO" ExposeOpaque,ExposeType "Unit" ExposeOpaque,ExposeType "Result" ExposeAll,ExposeType "Maybe" ExposeAll,ExposeType "String" ExposeOpaque,ExposeType "Float" ExposeOpaque]}], modDecls = [DeclTypeSig "main" (QualType {qualConstraints = [], qualType = TypeApp (TypeCon "IO") (TypeCon "Unit")}),DeclValue "main" [] (DoBlock [ExprStmt (App (FieldAccess (Var "IO") "println") (StringLit "=== JSON Decoding ===")),ExprStmt (Var "decodeUser"),ExprStmt (Var "decodeNested"),ExprStmt (Var "decodeWithMaybe")]),DeclTypeSig "decodeUser" (QualType {qualConstraints = [], qualType = TypeApp (TypeCon "IO") (TypeCon "Unit")}),DeclValue "decodeUser" [] (Case (App (FieldAccess (Var "Json") "parse") (StringLit "{\"name\":\"Bob\",\"score\":87.5}")) [Alt (PCon "Err" [PVar "msg"]) (App (FieldAccess (Var "IO") "println") (App (App (FieldAccess (Var "Str") "append") (StringLit "Parse error: ")) (Var "msg"))),Alt (PCon "Ok" [PVar "json"]) (Case (App (App (FieldAccess (Var "D") "decodeValue") (Var "userDecoder")) (Var "json")) [Alt (PCon "Err" [PVar "err"]) (App (FieldAccess (Var "IO") "println") (App (App (FieldAccess (Var "Str") "append") (StringLit "Decode error: ")) (FieldAccess (Var "err") "message"))),Alt (PCon "Ok" [PVar "user"]) (App (FieldAccess (Var "IO") "println") (App (App (FieldAccess (Var "Str") "append") (StringLit "User: ")) (FieldAccess (Var "user") "name")))])]),DeclTypeSig "userDecoder" (QualType {qualConstraints = [], qualType = TypeApp (TypeCon "Decoder") (TypeRecord [("name",TypeCon "String",[]),("score",TypeCon "Float",[])])}),DeclValue "userDecoder" [] (App (App (App (FieldAccess (Var "D") "map2") (Lam [PVar "n",PVar "s"] (RecordLiteral [("name",Var "n"),("score",Var "s")]))) (App (App (FieldAccess (Var "D") "field") (StringLit "name")) (FieldAccess (Var "D") "string"))) (App (App (FieldAccess (Var "D") "field") (StringLit "score")) (FieldAccess (Var "D") "float"))),DeclTypeSig "decodeNested" (QualType {qualConstraints = [], qualType = TypeApp (TypeCon "IO") (TypeCon "Unit")}),DeclValue "decodeNested" [] (Case (App (FieldAccess (Var "Json") "parse") (StringLit "{\"data\":{\"value\":42.0}}")) [Alt (PCon "Err" [PWildcard]) (App (FieldAccess (Var "IO") "println") (StringLit "Parse failed")),Alt (PCon "Ok" [PVar "json"]) (Case (App (App (FieldAccess (Var "D") "decodeValue") (App (App (FieldAccess (Var "D") "at") (App (App (Var "Cons") (StringLit "data")) (App (App (Var "Cons") (StringLit "value")) (Var "Nil")))) (FieldAccess (Var "D") "float"))) (Var "json")) [Alt (PCon "Err" [PVar "err"]) (App (FieldAccess (Var "IO") "println") (App (App (FieldAccess (Var "Str") "append") (StringLit "Error: ")) (FieldAccess (Var "err") "message"))),Alt (PCon "Ok" [PVar "v"]) (App (FieldAccess (Var "IO") "println") (App (App (FieldAccess (Var "Str") "append") (StringLit "Nested value: ")) (App (FieldAccess (Var "Str") "fromFloat") (Var "v"))))])]),DeclTypeSig "decodeWithMaybe" (QualType {qualConstraints = [], qualType = TypeApp (TypeCon "IO") (TypeCon "Unit")}),DeclValue "decodeWithMaybe" [] (Case (App (FieldAccess (Var "Json") "parse") (StringLit "{\"required\":1,\"optional\":null}")) [Alt (PCon "Err" [PWildcard]) (App (FieldAccess (Var "IO") "println") (StringLit "Parse failed")),Alt (PCon "Ok" [PVar "json"]) (Case (App (App (FieldAccess (Var "D") "decodeValue") (App (App (FieldAccess (Var "D") "field") (StringLit "optional")) (App (FieldAccess (Var "D") "maybe") (FieldAccess (Var "D") "int")))) (Var "json")) [Alt (PCon "Err" [PVar "err"]) (App (FieldAccess (Var "IO") "println") (App (App (FieldAccess (Var "Str") "append") (StringLit "Error: ")) (FieldAccess (Var "err") "message"))),Alt (PCon "Ok" [PCon "Nothing" []]) (App (FieldAccess (Var "IO") "println") (StringLit "Optional field is null")),Alt (PCon "Ok" [PCon "Just" [PVar "n"]]) (App (FieldAccess (Var "IO") "println") (StringLit "Has value"))])])]}
