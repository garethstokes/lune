Module {modName = "RequestHelpers", modExports = [ExposeValue "main"], modImports = [Import {impName = "Lune.IO", impAs = Just "IO", impExposing = Nothing},Import {impName = "Lune.Http", impAs = Nothing, impExposing = Just [ExposeType "Method" ExposeAll]},Import {impName = "Lune.Http.Request", impAs = Just "Req", impExposing = Nothing},Import {impName = "Lune.String", impAs = Just "Str", impExposing = Nothing},Import {impName = "Lune.Prelude", impAs = Nothing, impExposing = Just [ExposeType "IO" ExposeOpaque,ExposeType "Unit" ExposeOpaque,ExposeType "Maybe" ExposeAll]}], modDecls = [DeclTypeSig "main" (QualType {qualConstraints = [], qualType = TypeApp (TypeCon "IO") (TypeCon "Unit")}),DeclValue "main" [] (DoBlock [LetStmt "req" (RecordLiteral [("method",Var "GET"),("path",StringLit "/users/42?format=json&verbose=true"),("headers",App (App (Var "Cons") (RecordLiteral [("key",StringLit "Content-Type"),("value",StringLit "application/json")])) (App (App (Var "Cons") (RecordLiteral [("key",StringLit "Authorization"),("value",StringLit "Bearer token123")])) (Var "Nil"))),("body",StringLit "{\"name\":\"Alice\"}")]),ExprStmt (Case (App (App (FieldAccess (Var "Req") "query") (StringLit "format")) (Var "req")) [Alt (PCon "Nothing" []) (App (FieldAccess (Var "IO") "println") (StringLit "format: not found")),Alt (PCon "Just" [PVar "v"]) (App (FieldAccess (Var "IO") "println") (App (App (FieldAccess (Var "Str") "append") (StringLit "format: ")) (Var "v")))]),ExprStmt (Case (App (App (FieldAccess (Var "Req") "query") (StringLit "verbose")) (Var "req")) [Alt (PCon "Nothing" []) (App (FieldAccess (Var "IO") "println") (StringLit "verbose: not found")),Alt (PCon "Just" [PVar "v"]) (App (FieldAccess (Var "IO") "println") (App (App (FieldAccess (Var "Str") "append") (StringLit "verbose: ")) (Var "v")))]),ExprStmt (Case (App (App (FieldAccess (Var "Req") "query") (StringLit "missing")) (Var "req")) [Alt (PCon "Nothing" []) (App (FieldAccess (Var "IO") "println") (StringLit "missing: not found")),Alt (PCon "Just" [PVar "v"]) (App (FieldAccess (Var "IO") "println") (App (App (FieldAccess (Var "Str") "append") (StringLit "missing: ")) (Var "v")))]),ExprStmt (Case (App (App (FieldAccess (Var "Req") "header") (StringLit "content-type")) (Var "req")) [Alt (PCon "Nothing" []) (App (FieldAccess (Var "IO") "println") (StringLit "ct: not found")),Alt (PCon "Just" [PVar "v"]) (App (FieldAccess (Var "IO") "println") (App (App (FieldAccess (Var "Str") "append") (StringLit "ct: ")) (Var "v")))]),ExprStmt (Case (App (App (FieldAccess (Var "Req") "header") (StringLit "authorization")) (Var "req")) [Alt (PCon "Nothing" []) (App (FieldAccess (Var "IO") "println") (StringLit "auth: not found")),Alt (PCon "Just" [PVar "v"]) (App (FieldAccess (Var "IO") "println") (App (App (FieldAccess (Var "Str") "append") (StringLit "auth: ")) (Var "v")))])])]}
