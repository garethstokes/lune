Module {modName = "Main", modExports = [ExposeValue "main"], modImports = [Import {impName = "Lune.IO", impAs = Just "IO", impExposing = Nothing},Import {impName = "Lune.List", impAs = Just "List", impExposing = Nothing},Import {impName = "Lune.String", impAs = Just "Str", impExposing = Nothing},Import {impName = "Lune.Task", impAs = Just "Task", impExposing = Nothing},Import {impName = "Lune.System", impAs = Just "System", impExposing = Just [ExposeType "Arch" ExposeAll,ExposeType "Error" ExposeAll,ExposeType "OS" ExposeAll]}], modDecls = [DeclTypeSig "main" (QualType {qualConstraints = [], qualType = TypeApp (TypeApp (TypeCon "Task") (TypeCon "Unit")) (TypeCon "Unit")}),DeclValue "main" [] (DoBlock [BindStmt (PVar "r") (App (FieldAccess (Var "Task") "result") (FieldAccess (Var "System") "inventory")),ExprStmt (Case (Var "r") [Alt (PCon "Err" [PVar "e"]) (App (FieldAccess (Var "IO") "println") (App (App (FieldAccess (Var "Str") "append") (StringLit "inventory error: ")) (App (Var "errorToString") (Var "e")))),Alt (PCon "Ok" [PVar "inv"]) (DoBlock [ExprStmt (App (FieldAccess (Var "IO") "println") (App (App (FieldAccess (Var "Str") "append") (StringLit "os=")) (App (Var "osToString") (FieldAccess (FieldAccess (Var "inv") "platform") "os")))),ExprStmt (App (FieldAccess (Var "IO") "println") (App (App (FieldAccess (Var "Str") "append") (StringLit "arch=")) (App (Var "archToString") (FieldAccess (FieldAccess (Var "inv") "platform") "arch")))),ExprStmt (App (FieldAccess (Var "IO") "println") (App (App (FieldAccess (Var "Str") "append") (StringLit "cpu_model=")) (App (App (Var "maybeString") (StringLit "unknown")) (FieldAccess (FieldAccess (Var "inv") "cpu") "model")))),ExprStmt (App (FieldAccess (Var "IO") "println") (App (App (FieldAccess (Var "Str") "append") (StringLit "logical_cores=")) (App (FieldAccess (Var "Str") "fromInt") (FieldAccess (FieldAccess (Var "inv") "cpu") "logicalCores")))),ExprStmt (App (FieldAccess (Var "IO") "println") (App (App (FieldAccess (Var "Str") "append") (StringLit "mem_total_bytes=")) (App (FieldAccess (Var "Str") "fromInt") (FieldAccess (FieldAccess (Var "inv") "memory") "totalBytes")))),ExprStmt (App (FieldAccess (Var "IO") "println") (App (App (FieldAccess (Var "Str") "append") (StringLit "disks=")) (App (FieldAccess (Var "Str") "fromInt") (App (FieldAccess (Var "List") "length") (FieldAccess (Var "inv") "disks"))))),ExprStmt (App (FieldAccess (Var "IO") "println") (App (App (FieldAccess (Var "Str") "append") (StringLit "net_ifaces=")) (App (FieldAccess (Var "Str") "fromInt") (App (FieldAccess (Var "List") "length") (FieldAccess (Var "inv") "net"))))),ExprStmt (App (FieldAccess (Var "IO") "println") (App (App (FieldAccess (Var "Str") "append") (StringLit "gpus=")) (App (FieldAccess (Var "Str") "fromInt") (App (FieldAccess (Var "List") "length") (FieldAccess (Var "inv") "gpus"))))),ExprStmt (App (Var "printGpus") (FieldAccess (Var "inv") "gpus"))])])]),DeclTypeSig "errorToString" (QualType {qualConstraints = [], qualType = TypeArrow (TypeCon "System.Error") (TypeCon "String")}),DeclValue "errorToString" [PVar "err"] (Case (Var "err") [Alt (PCon "NotImplemented" [PVar "os"]) (App (App (FieldAccess (Var "Str") "append") (StringLit "NotImplemented(")) (App (App (FieldAccess (Var "Str") "append") (App (Var "osToString") (Var "os"))) (StringLit ")"))),Alt (PCon "ReadError" [PVar "msg"]) (App (App (FieldAccess (Var "Str") "append") (StringLit "ReadError(")) (App (App (FieldAccess (Var "Str") "append") (Var "msg")) (StringLit ")"))),Alt (PCon "ParseError" [PVar "msg"]) (App (App (FieldAccess (Var "Str") "append") (StringLit "ParseError(")) (App (App (FieldAccess (Var "Str") "append") (Var "msg")) (StringLit ")"))),Alt (PCon "PermissionDenied" [PVar "msg"]) (App (App (FieldAccess (Var "Str") "append") (StringLit "PermissionDenied(")) (App (App (FieldAccess (Var "Str") "append") (Var "msg")) (StringLit ")")))]),DeclTypeSig "osToString" (QualType {qualConstraints = [], qualType = TypeArrow (TypeCon "System.OS") (TypeCon "String")}),DeclValue "osToString" [PVar "os"] (Case (Var "os") [Alt (PCon "Linux" []) (StringLit "linux"),Alt (PCon "Darwin" []) (StringLit "darwin"),Alt (PCon "Windows" []) (StringLit "windows")]),DeclTypeSig "archToString" (QualType {qualConstraints = [], qualType = TypeArrow (TypeCon "System.Arch") (TypeCon "String")}),DeclValue "archToString" [PVar "arch"] (Case (Var "arch") [Alt (PCon "X86_64" []) (StringLit "x86_64"),Alt (PCon "AArch64" []) (StringLit "aarch64"),Alt (PCon "RiscV64" []) (StringLit "riscv64"),Alt (PCon "UnknownArch" [PVar "s"]) (App (App (FieldAccess (Var "Str") "append") (StringLit "unknown(")) (App (App (FieldAccess (Var "Str") "append") (Var "s")) (StringLit ")")))]),DeclTypeSig "maybeString" (QualType {qualConstraints = [], qualType = TypeArrow (TypeCon "String") (TypeArrow (TypeApp (TypeCon "Maybe") (TypeCon "String")) (TypeCon "String"))}),DeclValue "maybeString" [PVar "def",PVar "m"] (Case (Var "m") [Alt (PCon "Nothing" []) (Var "def"),Alt (PCon "Just" [PVar "s"]) (Var "s")]),DeclTypeSig "printGpus" (QualType {qualConstraints = [], qualType = TypeArrow (TypeApp (TypeCon "List") (TypeCon "System.GpuInfo")) (TypeApp (TypeApp (TypeCon "Task") (TypeCon "Unit")) (TypeCon "Unit"))}),DeclValue "printGpus" [PVar "gpus"] (Case (Var "gpus") [Alt (PCon "Nil" []) (App (FieldAccess (Var "IO") "println") (StringLit "gpu_list=[]")),Alt PWildcard (DoBlock [ExprStmt (App (FieldAccess (Var "IO") "println") (StringLit "gpu_list=")),ExprStmt (App (Var "printGpusLines") (Var "gpus"))])]),DeclTypeSig "printGpusLines" (QualType {qualConstraints = [], qualType = TypeArrow (TypeApp (TypeCon "List") (TypeCon "System.GpuInfo")) (TypeApp (TypeApp (TypeCon "Task") (TypeCon "Unit")) (TypeCon "Unit"))}),DeclValue "printGpusLines" [PVar "gpus"] (Case (Var "gpus") [Alt (PCon "Nil" []) (App (FieldAccess (Var "IO") "println") (StringLit "")),Alt (PCon "Cons" [PVar "g",PVar "rest"]) (DoBlock [ExprStmt (App (FieldAccess (Var "IO") "println") (App (Var "formatGpu") (Var "g"))),ExprStmt (App (Var "printGpusLines") (Var "rest"))])]),DeclTypeSig "formatGpu" (QualType {qualConstraints = [], qualType = TypeArrow (TypeCon "System.GpuInfo") (TypeCon "String")}),DeclValue "formatGpu" [PVar "g"] (App (App (FieldAccess (Var "Str") "join") (StringLit " ")) (App (App (Var "Cons") (StringLit "gpu")) (App (App (Var "Cons") (App (App (FieldAccess (Var "Str") "append") (StringLit "driver=")) (App (App (Var "maybeString") (StringLit "-")) (FieldAccess (Var "g") "driver")))) (App (App (Var "Cons") (App (App (FieldAccess (Var "Str") "append") (StringLit "pci=")) (App (Var "pciToString") (FieldAccess (Var "g") "pci")))) (App (App (Var "Cons") (App (App (FieldAccess (Var "Str") "append") (StringLit "vram_total_bytes=")) (App (App (Var "maybeInt") (StringLit "-")) (FieldAccess (Var "g") "vramTotalBytes")))) (Var "Nil")))))),DeclTypeSig "pciToString" (QualType {qualConstraints = [], qualType = TypeArrow (TypeApp (TypeCon "Maybe") (TypeCon "System.PciAddress")) (TypeCon "String")}),DeclValue "pciToString" [PVar "mpci"] (Case (Var "mpci") [Alt (PCon "Nothing" []) (StringLit "-"),Alt (PCon "Just" [PVar "p"]) (App (App (FieldAccess (Var "Str") "join") (StringLit ":")) (App (App (Var "Cons") (App (FieldAccess (Var "Str") "fromInt") (FieldAccess (Var "p") "domain"))) (App (App (Var "Cons") (App (FieldAccess (Var "Str") "fromInt") (FieldAccess (Var "p") "bus"))) (App (App (Var "Cons") (App (App (FieldAccess (Var "Str") "append") (App (FieldAccess (Var "Str") "fromInt") (FieldAccess (Var "p") "device"))) (App (App (FieldAccess (Var "Str") "append") (StringLit ".")) (App (FieldAccess (Var "Str") "fromInt") (FieldAccess (Var "p") "function"))))) (Var "Nil")))))]),DeclTypeSig "maybeInt" (QualType {qualConstraints = [], qualType = TypeArrow (TypeCon "String") (TypeArrow (TypeApp (TypeCon "Maybe") (TypeCon "Int")) (TypeCon "String"))}),DeclValue "maybeInt" [PVar "def",PVar "m"] (Case (Var "m") [Alt (PCon "Nothing" []) (Var "def"),Alt (PCon "Just" [PVar "n"]) (App (FieldAccess (Var "Str") "fromInt") (Var "n"))])]}
