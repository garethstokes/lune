Module {modName = "ParseDemo", modExports = [ExposeValue "parsePort",ExposeValue "demo",ExposeValue "demo2"], modImports = [Import {impName = "Lune.Bool", impAs = Just "Bool", impExposing = Nothing},Import {impName = "Lune.Int", impAs = Just "Int", impExposing = Nothing},Import {impName = "Lune.String", impAs = Just "String", impExposing = Nothing}], modDecls = [DeclTypeSig "guard" (QualType {qualConstraints = [], qualType = TypeArrow (TypeCon "Bool") (TypeArrow (TypeVar "e") (TypeApp (TypeApp (TypeCon "Result") (TypeVar "e")) (TypeCon "Unit")))}),DeclValue "guard" [PVar "cond",PVar "err"] (Case (Var "cond") [Alt (PCon "True" []) (App (Var "Ok") (Var "unit")),Alt (PCon "False" []) (App (Var "Err") (Var "err"))]),DeclTypeSig "parsePort" (QualType {qualConstraints = [], qualType = TypeArrow (TypeCon "String") (TypeApp (TypeApp (TypeCon "Result") (TypeCon "String")) (TypeCon "Int"))}),DeclValue "parsePort" [PVar "s"] (DoBlock [BindStmt (PVar "n") (App (FieldAccess (Var "String") "toInt") (Var "s")),DiscardBindStmt (App (App (Var "guard") (App (App (FieldAccess (Var "Bool") "and") (App (App (FieldAccess (Var "Int") "gte") (Var "n")) (IntLit 1))) (App (App (FieldAccess (Var "Int") "lte") (Var "n")) (IntLit 65535)))) (StringLit "port out of range")),ExprStmt (App (Var "pure") (Var "n"))]),DeclTypeSig "demo" (QualType {qualConstraints = [], qualType = TypeApp (TypeApp (TypeCon "Result") (TypeCon "String")) (TypeCon "Int")}),DeclValue "demo" [] (App (Var "parsePort") (StringLit "80")),DeclTypeSig "demo2" (QualType {qualConstraints = [], qualType = TypeApp (TypeApp (TypeCon "Result") (TypeCon "String")) (TypeCon "Int")}),DeclValue "demo2" [] (App (Var "parsePort") (StringLit "99999"))]}
