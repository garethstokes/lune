CoreModule {coreName = "HealthAgent", coreDecls = [CoreDecl "$dictFunctor_IO" (CRecord [("map",CLam [PVar "f",PVar "ma"] (CApp (CApp (CVar "$primIOBind") (CVar "ma")) (CLam [PVar "a"] (CApp (CVar "$primIOPure") (CApp (CVar "f") (CVar "a"))))))]),CoreDecl "$dictApplicative_IO" (CRecord [("$superFunctor",CVar "$dictFunctor_IO"),("pure",CVar "$primIOPure"),("apply",CLam [PVar "mf",PVar "ma"] (CApp (CApp (CVar "$primIOBind") (CVar "mf")) (CLam [PVar "f"] (CApp (CApp (CVar "$primIOBind") (CVar "ma")) (CLam [PVar "a"] (CApp (CVar "$primIOPure") (CApp (CVar "f") (CVar "a"))))))))]),CoreDecl "$dictMonad_IO" (CRecord [("$superApplicative",CVar "$dictApplicative_IO"),("andThen",CVar "$primIOBind"),("then",CVar "$primIOThen")]),CoreDecl "$dictFunctor_Task" (CRecord [("map",CLam [PVar "f",PVar "ta"] (CCase (CVar "ta") [CoreAlt (PCon "Lune.Prelude.Task" [Located {locSpan = Span {spanStartLine = 0, spanStartCol = 0, spanEndLine = 0, spanEndCol = 0}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "io"}]) (CApp (CVar "Lune.Prelude.Task") (CApp (CApp (CVar "$primIOBind") (CVar "io")) (CLam [PVar "r"] (CCase (CVar "r") [CoreAlt (PCon "Lune.Prelude.Err" [Located {locSpan = Span {spanStartLine = 0, spanStartCol = 0, spanEndLine = 0, spanEndCol = 0}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "e"}]) (CApp (CVar "$primIOPure") (CApp (CVar "Lune.Prelude.Err") (CVar "e"))),CoreAlt (PCon "Lune.Prelude.Ok" [Located {locSpan = Span {spanStartLine = 0, spanStartCol = 0, spanEndLine = 0, spanEndCol = 0}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "a"}]) (CApp (CVar "$primIOPure") (CApp (CVar "Lune.Prelude.Ok") (CApp (CVar "f") (CVar "a"))))]))))]))]),CoreDecl "$dictApplicative_Task" (CRecord [("$superFunctor",CVar "$dictFunctor_Task"),("pure",CLam [PVar "a"] (CApp (CVar "Lune.Prelude.Task") (CApp (CVar "$primIOPure") (CApp (CVar "Lune.Prelude.Ok") (CVar "a"))))),("apply",CLam [PVar "tf",PVar "ta"] (CCase (CVar "tf") [CoreAlt (PCon "Lune.Prelude.Task" [Located {locSpan = Span {spanStartLine = 0, spanStartCol = 0, spanEndLine = 0, spanEndCol = 0}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "ioF"}]) (CCase (CVar "ta") [CoreAlt (PCon "Lune.Prelude.Task" [Located {locSpan = Span {spanStartLine = 0, spanStartCol = 0, spanEndLine = 0, spanEndCol = 0}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "ioA"}]) (CApp (CVar "Lune.Prelude.Task") (CApp (CApp (CVar "$primIOBind") (CVar "ioF")) (CLam [PVar "rf"] (CCase (CVar "rf") [CoreAlt (PCon "Lune.Prelude.Err" [Located {locSpan = Span {spanStartLine = 0, spanStartCol = 0, spanEndLine = 0, spanEndCol = 0}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "e"}]) (CApp (CVar "$primIOPure") (CApp (CVar "Lune.Prelude.Err") (CVar "e"))),CoreAlt (PCon "Lune.Prelude.Ok" [Located {locSpan = Span {spanStartLine = 0, spanStartCol = 0, spanEndLine = 0, spanEndCol = 0}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "f"}]) (CApp (CApp (CVar "$primIOBind") (CVar "ioA")) (CLam [PVar "ra"] (CCase (CVar "ra") [CoreAlt (PCon "Lune.Prelude.Err" [Located {locSpan = Span {spanStartLine = 0, spanStartCol = 0, spanEndLine = 0, spanEndCol = 0}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "e"}]) (CApp (CVar "$primIOPure") (CApp (CVar "Lune.Prelude.Err") (CVar "e"))),CoreAlt (PCon "Lune.Prelude.Ok" [Located {locSpan = Span {spanStartLine = 0, spanStartCol = 0, spanEndLine = 0, spanEndCol = 0}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "a"}]) (CApp (CVar "$primIOPure") (CApp (CVar "Lune.Prelude.Ok") (CApp (CVar "f") (CVar "a"))))])))]))))])]))]),CoreDecl "$dictMonad_Task" (CRecord [("$superApplicative",CVar "$dictApplicative_Task"),("andThen",CLam [PVar "ta",PVar "k"] (CCase (CVar "ta") [CoreAlt (PCon "Lune.Prelude.Task" [Located {locSpan = Span {spanStartLine = 0, spanStartCol = 0, spanEndLine = 0, spanEndCol = 0}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "io"}]) (CApp (CVar "Lune.Prelude.Task") (CApp (CApp (CVar "$primIOBind") (CVar "io")) (CLam [PVar "r"] (CCase (CVar "r") [CoreAlt (PCon "Lune.Prelude.Err" [Located {locSpan = Span {spanStartLine = 0, spanStartCol = 0, spanEndLine = 0, spanEndCol = 0}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "e"}]) (CApp (CVar "$primIOPure") (CApp (CVar "Lune.Prelude.Err") (CVar "e"))),CoreAlt (PCon "Lune.Prelude.Ok" [Located {locSpan = Span {spanStartLine = 0, spanStartCol = 0, spanEndLine = 0, spanEndCol = 0}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "a"}]) (CCase (CApp (CVar "k") (CVar "a")) [CoreAlt (PCon "Lune.Prelude.Task" [Located {locSpan = Span {spanStartLine = 0, spanStartCol = 0, spanEndLine = 0, spanEndCol = 0}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "io2"}]) (CVar "io2")])]))))])),("then",CLam [PVar "ta",PVar "tb"] (CCase (CVar "ta") [CoreAlt (PCon "Lune.Prelude.Task" [Located {locSpan = Span {spanStartLine = 0, spanStartCol = 0, spanEndLine = 0, spanEndCol = 0}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "ioA"}]) (CApp (CVar "Lune.Prelude.Task") (CApp (CApp (CVar "$primIOBind") (CVar "ioA")) (CLam [PVar "r"] (CCase (CVar "r") [CoreAlt (PCon "Lune.Prelude.Err" [Located {locSpan = Span {spanStartLine = 0, spanStartCol = 0, spanEndLine = 0, spanEndCol = 0}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "e"}]) (CApp (CVar "$primIOPure") (CApp (CVar "Lune.Prelude.Err") (CVar "e"))),CoreAlt (PCon "Lune.Prelude.Ok" [Located {locSpan = Span {spanStartLine = 0, spanStartCol = 0, spanEndLine = 0, spanEndCol = 0}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PWildcard}]) (CCase (CVar "tb") [CoreAlt (PCon "Lune.Prelude.Task" [Located {locSpan = Span {spanStartLine = 0, spanStartCol = 0, spanEndLine = 0, spanEndCol = 0}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "ioB"}]) (CVar "ioB")])]))))]))]),CoreDecl "$dictFunctor_Result" (CRecord [("map",CLam [PVar "f",PVar "r"] (CCase (CVar "r") [CoreAlt (PCon "Lune.Prelude.Err" [Located {locSpan = Span {spanStartLine = 0, spanStartCol = 0, spanEndLine = 0, spanEndCol = 0}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "e"}]) (CApp (CVar "Lune.Prelude.Err") (CVar "e")),CoreAlt (PCon "Lune.Prelude.Ok" [Located {locSpan = Span {spanStartLine = 0, spanStartCol = 0, spanEndLine = 0, spanEndCol = 0}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "a"}]) (CApp (CVar "Lune.Prelude.Ok") (CApp (CVar "f") (CVar "a")))]))]),CoreDecl "$dictApplicative_Result" (CRecord [("$superFunctor",CVar "$dictFunctor_Result"),("pure",CLam [PVar "a"] (CApp (CVar "Lune.Prelude.Ok") (CVar "a"))),("apply",CLam [PVar "rf",PVar "ra"] (CCase (CVar "rf") [CoreAlt (PCon "Lune.Prelude.Err" [Located {locSpan = Span {spanStartLine = 0, spanStartCol = 0, spanEndLine = 0, spanEndCol = 0}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "e"}]) (CApp (CVar "Lune.Prelude.Err") (CVar "e")),CoreAlt (PCon "Lune.Prelude.Ok" [Located {locSpan = Span {spanStartLine = 0, spanStartCol = 0, spanEndLine = 0, spanEndCol = 0}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "f"}]) (CCase (CVar "ra") [CoreAlt (PCon "Lune.Prelude.Err" [Located {locSpan = Span {spanStartLine = 0, spanStartCol = 0, spanEndLine = 0, spanEndCol = 0}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "e"}]) (CApp (CVar "Lune.Prelude.Err") (CVar "e")),CoreAlt (PCon "Lune.Prelude.Ok" [Located {locSpan = Span {spanStartLine = 0, spanStartCol = 0, spanEndLine = 0, spanEndCol = 0}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "a"}]) (CApp (CVar "Lune.Prelude.Ok") (CApp (CVar "f") (CVar "a")))])]))]),CoreDecl "$dictMonad_Result" (CRecord [("$superApplicative",CVar "$dictApplicative_Result"),("andThen",CLam [PVar "m",PVar "k"] (CCase (CVar "m") [CoreAlt (PCon "Lune.Prelude.Ok" [Located {locSpan = Span {spanStartLine = 0, spanStartCol = 0, spanEndLine = 0, spanEndCol = 0}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "a"}]) (CApp (CVar "k") (CVar "a")),CoreAlt (PCon "Lune.Prelude.Err" [Located {locSpan = Span {spanStartLine = 0, spanStartCol = 0, spanEndLine = 0, spanEndCol = 0}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "e"}]) (CApp (CVar "Lune.Prelude.Err") (CVar "e"))])),("then",CLam [PVar "ra",PVar "rb"] (CCase (CVar "ra") [CoreAlt (PCon "Lune.Prelude.Ok" [Located {locSpan = Span {spanStartLine = 0, spanStartCol = 0, spanEndLine = 0, spanEndCol = 0}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PWildcard}]) (CVar "rb"),CoreAlt (PCon "Lune.Prelude.Err" [Located {locSpan = Span {spanStartLine = 0, spanStartCol = 0, spanEndLine = 0, spanEndCol = 0}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "e"}]) (CApp (CVar "Lune.Prelude.Err") (CVar "e"))]))]),CoreDecl "$dictFunctor_STM" (CRecord [("map",CLam [PVar "f",PVar "ma"] (CApp (CApp (CVar "$primSTMBind") (CVar "ma")) (CLam [PVar "a"] (CApp (CVar "$primSTMPure") (CApp (CVar "f") (CVar "a"))))))]),CoreDecl "$dictApplicative_STM" (CRecord [("$superFunctor",CVar "$dictFunctor_STM"),("pure",CVar "$primSTMPure"),("apply",CLam [PVar "mf",PVar "ma"] (CApp (CApp (CVar "$primSTMBind") (CVar "mf")) (CLam [PVar "f"] (CApp (CApp (CVar "$primSTMBind") (CVar "ma")) (CLam [PVar "a"] (CApp (CVar "$primSTMPure") (CApp (CVar "f") (CVar "a"))))))))]),CoreDecl "$dictMonad_STM" (CRecord [("$superApplicative",CVar "$dictApplicative_STM"),("andThen",CVar "$primSTMBind"),("then",CLam [PVar "ma",PVar "mb"] (CApp (CApp (CVar "$primSTMBind") (CVar "ma")) (CLam [PWildcard] (CVar "mb"))))]),CoreDecl "$dictJson.Decode_Bool" (CRecord [("decoder",CVar "Lune.Json.Decode.bool")]),CoreDecl "$dictJson.Decode_Float" (CRecord [("decoder",CVar "Lune.Json.Decode.float")]),CoreDecl "$dictJson.Decode_Int" (CRecord [("decoder",CVar "Lune.Json.Decode.int")]),CoreDecl "$dictJson.Decode_Json" (CRecord [("decoder",CLam [PVar "j"] (CApp (CVar "Lune.Prelude.Ok") (CVar "j")))]),CoreDecl "$dictJson.Decode_String" (CRecord [("decoder",CVar "Lune.Json.Decode.string")]),CoreDecl "$dictMonoid_Template" (CRecord [("$superSemigroup",CVar "$dictSemigroup_Template"),("mconcat",CLam [PVar "xs"] (CApp (CApp (CApp (CVar "Lune.List.foldl") (CSelect (CVar "$dictSemigroup_Template") "<>")) (CSelect (CVar "$dictMonoid_Template") "mempty")) (CVar "xs"))),("mempty",CVar "Template.empty")]),CoreDecl "$dictSemigroup_Template" (CRecord [("<>",CVar "Template.append")]),CoreDecl "$dictToTemplate_Bool" (CRecord [("toTemplate",CLam [PVar "b"] (CCase (CVar "b") [CoreAlt (PCon "Lune.Prelude.True" []) (CApp (CVar "Template.text") (CString "True")),CoreAlt (PCon "Lune.Prelude.False" []) (CApp (CVar "Template.text") (CString "False"))]))]),CoreDecl "$dictToTemplate_Char" (CRecord [("toTemplate",CLam [PVar "c"] (CApp (CVar "Template.text") (CApp (CVar "Lune.String.fromChar") (CVar "c"))))]),CoreDecl "$dictToTemplate_Float" (CRecord [("toTemplate",CLam [PVar "n"] (CApp (CVar "Template.text") (CApp (CVar "prim_showFloat") (CVar "n"))))]),CoreDecl "$dictToTemplate_Int" (CRecord [("toTemplate",CLam [PVar "n"] (CApp (CVar "Template.text") (CApp (CVar "prim_showInt") (CVar "n"))))]),CoreDecl "$dictToTemplate_String" (CRecord [("toTemplate",CLam [PVar "s"] (CApp (CVar "Template.text") (CVar "s")))]),CoreDecl "$dictToTemplate_Template" (CRecord [("toTemplate",CLam [PVar "t"] (CVar "t"))]),CoreDecl "" (CInt 0),CoreDecl "" (CInt 0),CoreDecl "Lune.Prelude.unit" (CVar "Lune.Prelude.Unit"),CoreDecl "" (CInt 0),CoreDecl "" (CInt 0),CoreDecl "" (CInt 0),CoreDecl "" (CInt 0),CoreDecl "" (CInt 0),CoreDecl "" (CInt 0),CoreDecl "" (CInt 0),CoreDecl "" (CInt 0),CoreDecl "" (CInt 0),CoreDecl "" (CInt 0),CoreDecl "" (CInt 0),CoreDecl "" (CInt 0),CoreDecl "" (CInt 0),CoreDecl "Lune.Prelude.fst" (CLam [PVar "p"] (CCase (CVar "p") [CoreAlt (PCon "Lune.Prelude.Pair" [Located {locSpan = Span {spanStartLine = 76, spanStartCol = 10, spanEndLine = 76, spanEndCol = 12}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "x"},Located {locSpan = Span {spanStartLine = 76, spanStartCol = 12, spanEndLine = 76, spanEndCol = 14}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PWildcard}]) (CVar "x")])),CoreDecl "" (CInt 0),CoreDecl "Lune.Prelude.snd" (CLam [PVar "p"] (CCase (CVar "p") [CoreAlt (PCon "Lune.Prelude.Pair" [Located {locSpan = Span {spanStartLine = 81, spanStartCol = 10, spanEndLine = 81, spanEndCol = 12}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PWildcard},Located {locSpan = Span {spanStartLine = 81, spanStartCol = 12, spanEndLine = 81, spanEndCol = 14}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "y"}]) (CVar "y")])),CoreDecl "" (CInt 0),CoreDecl "" (CInt 0),CoreDecl "" (CInt 0),CoreDecl "" (CInt 0),CoreDecl "" (CInt 0),CoreDecl "" (CInt 0),CoreDecl "" (CInt 0),CoreDecl "" (CInt 0),CoreDecl "" (CInt 0),CoreDecl "" (CInt 0),CoreDecl "" (CInt 0),CoreDecl "" (CInt 0),CoreDecl "Lune.IO.pure" (CLam [PVar "a"] (CApp (CVar "prim_ioPure") (CVar "a"))),CoreDecl "" (CInt 0),CoreDecl "Lune.IO.andThen" (CLam [PVar "io",PVar "f"] (CApp (CApp (CVar "prim_ioBind") (CVar "io")) (CVar "f"))),CoreDecl "" (CInt 0),CoreDecl "Lune.IO.println" (CLam [PVar "s"] (CApp (CVar "Lune.Prelude.Task") (CApp (CApp (CVar "Lune.IO.andThen") (CApp (CVar "prim_putStrLn") (CVar "s"))) (CLam [PVar "u"] (CApp (CVar "Lune.IO.pure") (CApp (CVar "Lune.Prelude.Ok") (CVar "u"))))))),CoreDecl "" (CInt 0),CoreDecl "Lune.IO.readLine" (CApp (CVar "Lune.Prelude.Task") (CApp (CApp (CVar "Lune.IO.andThen") (CVar "prim_readLine")) (CLam [PVar "s"] (CApp (CVar "Lune.IO.pure") (CApp (CVar "Lune.Prelude.Ok") (CVar "s")))))),CoreDecl "" (CInt 0),CoreDecl "Lune.IO.readInt" (CApp (CVar "Lune.Prelude.Task") (CApp (CApp (CVar "Lune.IO.andThen") (CVar "prim_readInt")) (CLam [PVar "n"] (CApp (CVar "Lune.IO.pure") (CApp (CVar "Lune.Prelude.Ok") (CVar "n")))))),CoreDecl "" (CInt 0),CoreDecl "Lune.IO.sleepMs" (CLam [PVar "ms"] (CApp (CVar "Lune.Prelude.Task") (CApp (CApp (CVar "Lune.IO.andThen") (CApp (CVar "prim_sleepMs") (CVar "ms"))) (CLam [PVar "u"] (CApp (CVar "Lune.IO.pure") (CApp (CVar "Lune.Prelude.Ok") (CVar "u"))))))),CoreDecl "" (CInt 0),CoreDecl "Lune.IO.readFile" (CLam [PVar "path"] (CApp (CVar "Lune.Prelude.Task") (CApp (CVar "prim_readFile") (CVar "path")))),CoreDecl "" (CInt 0),CoreDecl "Lune.IO.writeFile" (CLam [PVar "path",PVar "contents"] (CApp (CVar "Lune.Prelude.Task") (CApp (CApp (CVar "prim_writeFile") (CVar "path")) (CVar "contents")))),CoreDecl "" (CInt 0),CoreDecl "" (CInt 0),CoreDecl "Lune.Fiber.spawn" (CLam [PVar "task"] (CCase (CVar "task") [CoreAlt (PCon "Lune.Prelude.Task" [Located {locSpan = Span {spanStartLine = 24, spanStartCol = 10, spanEndLine = 24, spanEndCol = 13}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "io"}]) (CApp (CVar "Lune.Prelude.Task") (CApp (CApp (CVar "Lune.IO.andThen") (CApp (CVar "prim_spawn") (CVar "io"))) (CLam [PVar "fib"] (CApp (CVar "Lune.IO.pure") (CApp (CVar "Lune.Prelude.Ok") (CVar "fib"))))))])),CoreDecl "" (CInt 0),CoreDecl "Lune.Fiber.await" (CLam [PVar "fib"] (CApp (CVar "Lune.Prelude.Task") (CApp (CVar "prim_await") (CVar "fib")))),CoreDecl "" (CInt 0),CoreDecl "Lune.Fiber.awaitAny" (CLam [PVar "a",PVar "b"] (CApp (CVar "Lune.Prelude.Task") (CApp (CApp (CVar "prim_awaitAny") (CVar "a")) (CVar "b")))),CoreDecl "" (CInt 0),CoreDecl "Lune.Fiber.yield" (CApp (CVar "Lune.Prelude.Task") (CApp (CApp (CVar "Lune.IO.andThen") (CVar "prim_yield")) (CLam [PVar "u"] (CApp (CVar "Lune.IO.pure") (CApp (CVar "Lune.Prelude.Ok") (CVar "u")))))),CoreDecl "" (CInt 0),CoreDecl "" (CInt 0),CoreDecl "Lune.Task.succeed" (CLam [PVar "a"] (CApp (CVar "Lune.Prelude.Task") (CApp (CVar "Lune.IO.pure") (CApp (CVar "Lune.Prelude.Ok") (CVar "a"))))),CoreDecl "" (CInt 0),CoreDecl "Lune.Task.fail" (CLam [PVar "e"] (CApp (CVar "Lune.Prelude.Task") (CApp (CVar "Lune.IO.pure") (CApp (CVar "Lune.Prelude.Err") (CVar "e"))))),CoreDecl "" (CInt 0),CoreDecl "Lune.Task.fromIO" (CLam [PVar "io"] (CApp (CVar "Lune.Prelude.Task") (CApp (CApp (CVar "Lune.IO.andThen") (CVar "io")) (CLam [PVar "a"] (CApp (CVar "Lune.IO.pure") (CApp (CVar "Lune.Prelude.Ok") (CVar "a"))))))),CoreDecl "" (CInt 0),CoreDecl "Lune.Task.fromResult" (CLam [PVar "r"] (CCase (CVar "r") [CoreAlt (PCon "Lune.Prelude.Ok" [Located {locSpan = Span {spanStartLine = 45, spanStartCol = 8, spanEndLine = 45, spanEndCol = 10}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "a"}]) (CApp (CVar "Lune.Task.succeed") (CVar "a")),CoreAlt (PCon "Lune.Prelude.Err" [Located {locSpan = Span {spanStartLine = 46, spanStartCol = 9, spanEndLine = 46, spanEndCol = 11}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "e"}]) (CApp (CVar "Lune.Task.fail") (CVar "e"))])),CoreDecl "" (CInt 0),CoreDecl "Lune.Task.map" (CLam [PVar "f",PVar "task"] (CCase (CVar "task") [CoreAlt (PCon "Lune.Prelude.Task" [Located {locSpan = Span {spanStartLine = 51, spanStartCol = 10, spanEndLine = 51, spanEndCol = 13}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "io"}]) (CApp (CVar "Lune.Prelude.Task") (CApp (CApp (CVar "Lune.IO.andThen") (CVar "io")) (CLam [PVar "r"] (CCase (CVar "r") [CoreAlt (PCon "Lune.Prelude.Err" [Located {locSpan = Span {spanStartLine = 55, spanStartCol = 19, spanEndLine = 55, spanEndCol = 21}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "e"}]) (CApp (CVar "Lune.IO.pure") (CApp (CVar "Lune.Prelude.Err") (CVar "e"))),CoreAlt (PCon "Lune.Prelude.Ok" [Located {locSpan = Span {spanStartLine = 56, spanStartCol = 18, spanEndLine = 56, spanEndCol = 20}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "a"}]) (CApp (CVar "Lune.IO.pure") (CApp (CVar "Lune.Prelude.Ok") (CApp (CVar "f") (CVar "a"))))]))))])),CoreDecl "" (CInt 0),CoreDecl "Lune.Task.andThen" (CLam [PVar "task",PVar "k"] (CCase (CVar "task") [CoreAlt (PCon "Lune.Prelude.Task" [Located {locSpan = Span {spanStartLine = 63, spanStartCol = 10, spanEndLine = 63, spanEndCol = 13}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "io"}]) (CApp (CVar "Lune.Prelude.Task") (CApp (CApp (CVar "Lune.IO.andThen") (CVar "io")) (CLam [PVar "r"] (CCase (CVar "r") [CoreAlt (PCon "Lune.Prelude.Err" [Located {locSpan = Span {spanStartLine = 67, spanStartCol = 19, spanEndLine = 67, spanEndCol = 21}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "e"}]) (CApp (CVar "Lune.IO.pure") (CApp (CVar "Lune.Prelude.Err") (CVar "e"))),CoreAlt (PCon "Lune.Prelude.Ok" [Located {locSpan = Span {spanStartLine = 68, spanStartCol = 18, spanEndLine = 68, spanEndCol = 20}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "a"}]) (CCase (CApp (CVar "k") (CVar "a")) [CoreAlt (PCon "Lune.Prelude.Task" [Located {locSpan = Span {spanStartLine = 70, spanStartCol = 24, spanEndLine = 70, spanEndCol = 28}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "io2"}]) (CVar "io2")])]))))])),CoreDecl "" (CInt 0),CoreDecl "Lune.Task.then" (CLam [PVar "ta",PVar "tb"] (CApp (CApp (CVar "Lune.Task.andThen") (CVar "ta")) (CLam [PWildcard] (CVar "tb")))),CoreDecl "" (CInt 0),CoreDecl "Lune.Task.mapError" (CLam [PVar "f",PVar "task"] (CCase (CVar "task") [CoreAlt (PCon "Lune.Prelude.Task" [Located {locSpan = Span {spanStartLine = 81, spanStartCol = 10, spanEndLine = 81, spanEndCol = 13}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "io"}]) (CApp (CVar "Lune.Prelude.Task") (CApp (CApp (CVar "Lune.IO.andThen") (CVar "io")) (CLam [PVar "r"] (CCase (CVar "r") [CoreAlt (PCon "Lune.Prelude.Err" [Located {locSpan = Span {spanStartLine = 85, spanStartCol = 19, spanEndLine = 85, spanEndCol = 21}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "e"}]) (CApp (CVar "Lune.IO.pure") (CApp (CVar "Lune.Prelude.Err") (CApp (CVar "f") (CVar "e")))),CoreAlt (PCon "Lune.Prelude.Ok" [Located {locSpan = Span {spanStartLine = 86, spanStartCol = 18, spanEndLine = 86, spanEndCol = 20}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "a"}]) (CApp (CVar "Lune.IO.pure") (CApp (CVar "Lune.Prelude.Ok") (CVar "a")))]))))])),CoreDecl "" (CInt 0),CoreDecl "Lune.Task.onError" (CLam [PVar "task",PVar "handler"] (CCase (CVar "task") [CoreAlt (PCon "Lune.Prelude.Task" [Located {locSpan = Span {spanStartLine = 93, spanStartCol = 10, spanEndLine = 93, spanEndCol = 13}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "io"}]) (CApp (CVar "Lune.Prelude.Task") (CApp (CApp (CVar "Lune.IO.andThen") (CVar "io")) (CLam [PVar "r"] (CCase (CVar "r") [CoreAlt (PCon "Lune.Prelude.Ok" [Located {locSpan = Span {spanStartLine = 97, spanStartCol = 18, spanEndLine = 97, spanEndCol = 20}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "a"}]) (CApp (CVar "Lune.IO.pure") (CApp (CVar "Lune.Prelude.Ok") (CVar "a"))),CoreAlt (PCon "Lune.Prelude.Err" [Located {locSpan = Span {spanStartLine = 98, spanStartCol = 19, spanEndLine = 98, spanEndCol = 21}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "e"}]) (CCase (CApp (CVar "handler") (CVar "e")) [CoreAlt (PCon "Lune.Prelude.Task" [Located {locSpan = Span {spanStartLine = 100, spanStartCol = 24, spanEndLine = 100, spanEndCol = 28}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "io2"}]) (CVar "io2")])]))))])),CoreDecl "" (CInt 0),CoreDecl "Lune.Task.attempt" (CLam [PVar "task"] (CCase (CVar "task") [CoreAlt (PCon "Lune.Prelude.Task" [Located {locSpan = Span {spanStartLine = 107, spanStartCol = 10, spanEndLine = 107, spanEndCol = 13}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "io"}]) (CVar "io")])),CoreDecl "" (CInt 0),CoreDecl "Lune.Task.result" (CLam [PVar "task"] (CApp (CApp (CVar "Lune.Task.onError") (CApp (CApp (CVar "Lune.Task.map") (CVar "Lune.Prelude.Ok")) (CVar "task"))) (CLam [PVar "e"] (CApp (CVar "Lune.Task.succeed") (CApp (CVar "Lune.Prelude.Err") (CVar "e")))))),CoreDecl "" (CInt 0),CoreDecl "Lune.Task.withTimeout" (CLam [PVar "timeoutMs",PVar "task"] (CApp (CApp (CSelect (CVar "$dictMonad_Task") "andThen") (CApp (CVar "Lune.Fiber.spawn") (CApp (CApp (CVar "Lune.Task.map") (CVar "Lune.Prelude.Ok")) (CVar "task")))) (CLam [PVar "t1"] (CApp (CApp (CSelect (CVar "$dictMonad_Task") "andThen") (CApp (CVar "Lune.Fiber.spawn") (CApp (CApp (CVar "Lune.Task.then") (CApp (CVar "Lune.IO.sleepMs") (CVar "timeoutMs"))) (CApp (CVar "Lune.Task.succeed") (CApp (CVar "Lune.Prelude.Err") (CVar "Lune.Task.Timeout")))))) (CLam [PVar "t2"] (CApp (CApp (CVar "Lune.Fiber.awaitAny") (CVar "t1")) (CVar "t2"))))))),CoreDecl "" (CInt 0),CoreDecl "Lune.Char.toInt" (CVar "prim_charToInt"),CoreDecl "" (CInt 0),CoreDecl "Lune.Char.fromInt" (CVar "prim_intToChar"),CoreDecl "" (CInt 0),CoreDecl "Lune.Char.toLower" (CLam [PVar "c"] (CCase (CApp (CApp (CVar "prim_and") (CApp (CApp (CVar "prim_geInt") (CApp (CVar "Lune.Char.toInt") (CVar "c"))) (CInt 65))) (CApp (CApp (CVar "prim_leInt") (CApp (CVar "Lune.Char.toInt") (CVar "c"))) (CInt 90))) [CoreAlt (PCon "Lune.Prelude.True" []) (CApp (CVar "Lune.Char.fromInt") (CApp (CApp (CVar "prim_addInt") (CApp (CVar "Lune.Char.toInt") (CVar "c"))) (CInt 32))),CoreAlt (PCon "Lune.Prelude.False" []) (CVar "c")])),CoreDecl "" (CInt 0),CoreDecl "Lune.Char.toUpper" (CLam [PVar "c"] (CCase (CApp (CApp (CVar "prim_and") (CApp (CApp (CVar "prim_geInt") (CApp (CVar "Lune.Char.toInt") (CVar "c"))) (CInt 97))) (CApp (CApp (CVar "prim_leInt") (CApp (CVar "Lune.Char.toInt") (CVar "c"))) (CInt 122))) [CoreAlt (PCon "Lune.Prelude.True" []) (CApp (CVar "Lune.Char.fromInt") (CApp (CApp (CVar "prim_subInt") (CApp (CVar "Lune.Char.toInt") (CVar "c"))) (CInt 32))),CoreAlt (PCon "Lune.Prelude.False" []) (CVar "c")])),CoreDecl "" (CInt 0),CoreDecl "Lune.Char.isSpace" (CLam [PVar "c"] (CCase (CApp (CApp (CVar "prim_eqInt") (CApp (CVar "Lune.Char.toInt") (CVar "c"))) (CInt 32)) [CoreAlt (PCon "Lune.Prelude.True" []) (CVar "Lune.Prelude.True"),CoreAlt (PCon "Lune.Prelude.False" []) (CCase (CApp (CApp (CVar "prim_eqInt") (CApp (CVar "Lune.Char.toInt") (CVar "c"))) (CInt 9)) [CoreAlt (PCon "Lune.Prelude.True" []) (CVar "Lune.Prelude.True"),CoreAlt (PCon "Lune.Prelude.False" []) (CCase (CApp (CApp (CVar "prim_eqInt") (CApp (CVar "Lune.Char.toInt") (CVar "c"))) (CInt 10)) [CoreAlt (PCon "Lune.Prelude.True" []) (CVar "Lune.Prelude.True"),CoreAlt (PCon "Lune.Prelude.False" []) (CCase (CApp (CApp (CVar "prim_eqInt") (CApp (CVar "Lune.Char.toInt") (CVar "c"))) (CInt 13)) [CoreAlt (PCon "Lune.Prelude.True" []) (CVar "Lune.Prelude.True"),CoreAlt (PCon "Lune.Prelude.False" []) (CVar "Lune.Prelude.False")])])])])),CoreDecl "" (CInt 0),CoreDecl "Lune.Char.isDigit" (CLam [PVar "c"] (CApp (CApp (CVar "prim_and") (CApp (CApp (CVar "prim_geInt") (CApp (CVar "Lune.Char.toInt") (CVar "c"))) (CInt 48))) (CApp (CApp (CVar "prim_leInt") (CApp (CVar "Lune.Char.toInt") (CVar "c"))) (CInt 57)))),CoreDecl "" (CInt 0),CoreDecl "Lune.Char.eq" (CLam [PVar "a",PVar "b"] (CApp (CApp (CVar "prim_eqInt") (CApp (CVar "Lune.Char.toInt") (CVar "a"))) (CApp (CVar "Lune.Char.toInt") (CVar "b")))),CoreDecl "" (CInt 0),CoreDecl "Lune.String.append" (CVar "prim_appendString"),CoreDecl "" (CInt 0),CoreDecl "Lune.String.eq" (CVar "prim_eqString"),CoreDecl "" (CInt 0),CoreDecl "Lune.String.fromInt" (CVar "prim_showInt"),CoreDecl "" (CInt 0),CoreDecl "Lune.String.fromFloat" (CVar "prim_showFloat"),CoreDecl "" (CInt 0),CoreDecl "Lune.String.toInt" (CVar "prim_parseInt"),CoreDecl "" (CInt 0),CoreDecl "Lune.String.toChars" (CVar "prim_stringToChars"),CoreDecl "" (CInt 0),CoreDecl "Lune.String.fromChars" (CVar "prim_charsToString"),CoreDecl "" (CInt 0),CoreDecl "Lune.String.fromChar" (CLam [PVar "c"] (CApp (CVar "Lune.String.fromChars") (CApp (CApp (CVar "Lune.Prelude.Cons") (CVar "c")) (CVar "Lune.Prelude.Nil")))),CoreDecl "" (CInt 0),CoreDecl "Lune.String.length" (CLam [PVar "s"] (CApp (CVar "Lune.String.listLength") (CApp (CVar "Lune.String.toChars") (CVar "s")))),CoreDecl "" (CInt 0),CoreDecl "Lune.String.isEmpty" (CLam [PVar "s"] (CCase (CApp (CVar "Lune.String.toChars") (CVar "s")) [CoreAlt (PCon "Lune.Prelude.Nil" []) (CVar "Lune.Prelude.True"),CoreAlt PWildcard (CVar "Lune.Prelude.False")])),CoreDecl "" (CInt 0),CoreDecl "Lune.String.toLower" (CLam [PVar "s"] (CApp (CVar "Lune.String.fromChars") (CApp (CApp (CVar "Lune.String.listMap") (CVar "Lune.Char.toLower")) (CApp (CVar "Lune.String.toChars") (CVar "s"))))),CoreDecl "" (CInt 0),CoreDecl "Lune.String.toUpper" (CLam [PVar "s"] (CApp (CVar "Lune.String.fromChars") (CApp (CApp (CVar "Lune.String.listMap") (CVar "Lune.Char.toUpper")) (CApp (CVar "Lune.String.toChars") (CVar "s"))))),CoreDecl "" (CInt 0),CoreDecl "Lune.String.startsWith" (CLam [PVar "prefix",PVar "s"] (CApp (CApp (CVar "Lune.String.charsStartsWith") (CApp (CVar "Lune.String.toChars") (CVar "prefix"))) (CApp (CVar "Lune.String.toChars") (CVar "s")))),CoreDecl "" (CInt 0),CoreDecl "Lune.String.endsWith" (CLam [PVar "suffix",PVar "s"] (CApp (CApp (CVar "Lune.String.charsStartsWith") (CApp (CVar "Lune.String.listReverse") (CApp (CVar "Lune.String.toChars") (CVar "suffix")))) (CApp (CVar "Lune.String.listReverse") (CApp (CVar "Lune.String.toChars") (CVar "s"))))),CoreDecl "" (CInt 0),CoreDecl "Lune.String.contains" (CLam [PVar "needle",PVar "haystack"] (CApp (CApp (CVar "Lune.String.charsContains") (CApp (CVar "Lune.String.toChars") (CVar "needle"))) (CApp (CVar "Lune.String.toChars") (CVar "haystack")))),CoreDecl "" (CInt 0),CoreDecl "Lune.String.split" (CLam [PVar "delimiter",PVar "s"] (CCase (CApp (CVar "Lune.String.isEmpty") (CVar "delimiter")) [CoreAlt (PCon "Lune.Prelude.True" []) (CApp (CApp (CVar "Lune.Prelude.Cons") (CVar "s")) (CVar "Lune.Prelude.Nil")),CoreAlt (PCon "Lune.Prelude.False" []) (CApp (CApp (CApp (CVar "Lune.String.splitHelper") (CApp (CVar "Lune.String.toChars") (CVar "delimiter"))) (CApp (CVar "Lune.String.toChars") (CVar "s"))) (CVar "Lune.Prelude.Nil"))])),CoreDecl "" (CInt 0),CoreDecl "Lune.String.join" (CLam [PVar "sep",PVar "parts"] (CCase (CVar "parts") [CoreAlt (PCon "Lune.Prelude.Nil" []) (CString ""),CoreAlt (PCon "Lune.Prelude.Cons" [Located {locSpan = Span {spanStartLine = 80, spanStartCol = 10, spanEndLine = 80, spanEndCol = 16}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "first"},Located {locSpan = Span {spanStartLine = 80, spanStartCol = 16, spanEndLine = 80, spanEndCol = 21}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "rest"}]) (CApp (CApp (CApp (CVar "Lune.String.listFoldl") (CLam [PVar "acc",PVar "x"] (CApp (CApp (CVar "Lune.String.append") (CApp (CApp (CVar "Lune.String.append") (CVar "acc")) (CVar "sep"))) (CVar "x")))) (CVar "first")) (CVar "rest"))])),CoreDecl "" (CInt 0),CoreDecl "Lune.String.trim" (CLam [PVar "s"] (CApp (CVar "Lune.String.trimLeft") (CApp (CVar "Lune.String.trimRight") (CVar "s")))),CoreDecl "" (CInt 0),CoreDecl "Lune.String.trimLeft" (CLam [PVar "s"] (CApp (CVar "Lune.String.fromChars") (CApp (CApp (CVar "Lune.String.dropWhileChars") (CVar "Lune.Char.isSpace")) (CApp (CVar "Lune.String.toChars") (CVar "s"))))),CoreDecl "" (CInt 0),CoreDecl "Lune.String.trimRight" (CLam [PVar "s"] (CApp (CVar "Lune.String.fromChars") (CApp (CVar "Lune.String.listReverse") (CApp (CApp (CVar "Lune.String.dropWhileChars") (CVar "Lune.Char.isSpace")) (CApp (CVar "Lune.String.listReverse") (CApp (CVar "Lune.String.toChars") (CVar "s"))))))),CoreDecl "" (CInt 0),CoreDecl "Lune.String.drop" (CLam [PVar "n",PVar "s"] (CApp (CVar "Lune.String.fromChars") (CApp (CApp (CVar "Lune.String.listDrop") (CVar "n")) (CApp (CVar "Lune.String.toChars") (CVar "s"))))),CoreDecl "" (CInt 0),CoreDecl "Lune.String.take" (CLam [PVar "n",PVar "s"] (CApp (CVar "Lune.String.fromChars") (CApp (CApp (CVar "Lune.String.listTake") (CVar "n")) (CApp (CVar "Lune.String.toChars") (CVar "s"))))),CoreDecl "" (CInt 0),CoreDecl "Lune.String.indexOf" (CLam [PVar "needle",PVar "haystack"] (CApp (CApp (CApp (CVar "Lune.String.indexOfHelper") (CApp (CVar "Lune.String.toChars") (CVar "needle"))) (CApp (CVar "Lune.String.toChars") (CVar "haystack"))) (CInt 0))),CoreDecl "" (CInt 0),CoreDecl "Lune.String.lines" (CLam [PVar "s"] (CApp (CApp (CVar "Lune.String.split") (CString "\n")) (CVar "s"))),CoreDecl "" (CInt 0),CoreDecl "Lune.String.unlines" (CLam [PVar "ls"] (CApp (CApp (CVar "Lune.String.join") (CString "\n")) (CVar "ls"))),CoreDecl "" (CInt 0),CoreDecl "Lune.String.words" (CLam [PVar "s"] (CApp (CApp (CApp (CVar "Lune.String.wordsFromChars") (CApp (CVar "Lune.String.toChars") (CVar "s"))) (CVar "Lune.Prelude.Nil")) (CVar "Lune.Prelude.Nil"))),CoreDecl "" (CInt 0),CoreDecl "Lune.String.wordsFromChars" (CLam [PVar "chars",PVar "currentRev",PVar "accRev"] (CCase (CVar "chars") [CoreAlt (PCon "Lune.Prelude.Nil" []) (CCase (CVar "currentRev") [CoreAlt (PCon "Lune.Prelude.Nil" []) (CApp (CVar "Lune.String.listReverse") (CVar "accRev")),CoreAlt PWildcard (CApp (CVar "Lune.String.listReverse") (CApp (CApp (CVar "Lune.Prelude.Cons") (CApp (CVar "Lune.String.fromChars") (CApp (CVar "Lune.String.listReverse") (CVar "currentRev")))) (CVar "accRev")))]),CoreAlt (PCon "Lune.Prelude.Cons" [Located {locSpan = Span {spanStartLine = 118, spanStartCol = 10, spanEndLine = 118, spanEndCol = 12}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "c"},Located {locSpan = Span {spanStartLine = 118, spanStartCol = 12, spanEndLine = 118, spanEndCol = 17}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "rest"}]) (CCase (CApp (CVar "Lune.Char.isSpace") (CVar "c")) [CoreAlt (PCon "Lune.Prelude.True" []) (CCase (CVar "currentRev") [CoreAlt (PCon "Lune.Prelude.Nil" []) (CApp (CApp (CApp (CVar "Lune.String.wordsFromChars") (CVar "rest")) (CVar "Lune.Prelude.Nil")) (CVar "accRev")),CoreAlt PWildcard (CApp (CApp (CApp (CVar "Lune.String.wordsFromChars") (CVar "rest")) (CVar "Lune.Prelude.Nil")) (CApp (CApp (CVar "Lune.Prelude.Cons") (CApp (CVar "Lune.String.fromChars") (CApp (CVar "Lune.String.listReverse") (CVar "currentRev")))) (CVar "accRev")))]),CoreAlt (PCon "Lune.Prelude.False" []) (CApp (CApp (CApp (CVar "Lune.String.wordsFromChars") (CVar "rest")) (CApp (CApp (CVar "Lune.Prelude.Cons") (CVar "c")) (CVar "currentRev"))) (CVar "accRev"))])])),CoreDecl "" (CInt 0),CoreDecl "Lune.String.sumInts" (CLam [PVar "xs"] (CApp (CApp (CApp (CVar "Lune.String.listFoldl") (CVar "Lune.String.sumIntsStep")) (CApp (CVar "Lune.Prelude.Ok") (CInt 0))) (CVar "xs"))),CoreDecl "" (CInt 0),CoreDecl "Lune.String.sumIntsStep" (CLam [PVar "acc",PVar "s"] (CCase (CVar "acc") [CoreAlt (PCon "Lune.Prelude.Err" [Located {locSpan = Span {spanStartLine = 133, spanStartCol = 9, spanEndLine = 133, spanEndCol = 13}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "msg"}]) (CApp (CVar "Lune.Prelude.Err") (CVar "msg")),CoreAlt (PCon "Lune.Prelude.Ok" [Located {locSpan = Span {spanStartLine = 134, spanStartCol = 8, spanEndLine = 134, spanEndCol = 10}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "n"}]) (CCase (CApp (CVar "Lune.String.toInt") (CVar "s")) [CoreAlt (PCon "Lune.Prelude.Err" [Located {locSpan = Span {spanStartLine = 136, spanStartCol = 13, spanEndLine = 136, spanEndCol = 17}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "msg"}]) (CApp (CVar "Lune.Prelude.Err") (CVar "msg")),CoreAlt (PCon "Lune.Prelude.Ok" [Located {locSpan = Span {spanStartLine = 137, spanStartCol = 12, spanEndLine = 137, spanEndCol = 14}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "m"}]) (CApp (CVar "Lune.Prelude.Ok") (CApp (CApp (CVar "prim_addInt") (CVar "n")) (CVar "m")))])])),CoreDecl "" (CInt 0),CoreDecl "Lune.String.charsStartsWith" (CLam [PVar "prefix",PVar "str"] (CCase (CVar "prefix") [CoreAlt (PCon "Lune.Prelude.Nil" []) (CVar "Lune.Prelude.True"),CoreAlt (PCon "Lune.Prelude.Cons" [Located {locSpan = Span {spanStartLine = 145, spanStartCol = 10, spanEndLine = 145, spanEndCol = 12}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "p"},Located {locSpan = Span {spanStartLine = 145, spanStartCol = 12, spanEndLine = 145, spanEndCol = 15}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "ps"}]) (CCase (CVar "str") [CoreAlt (PCon "Lune.Prelude.Nil" []) (CVar "Lune.Prelude.False"),CoreAlt (PCon "Lune.Prelude.Cons" [Located {locSpan = Span {spanStartLine = 148, spanStartCol = 14, spanEndLine = 148, spanEndCol = 16}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "s"},Located {locSpan = Span {spanStartLine = 148, spanStartCol = 16, spanEndLine = 148, spanEndCol = 19}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "ss"}]) (CCase (CApp (CApp (CVar "Lune.Char.eq") (CVar "p")) (CVar "s")) [CoreAlt (PCon "Lune.Prelude.True" []) (CApp (CApp (CVar "Lune.String.charsStartsWith") (CVar "ps")) (CVar "ss")),CoreAlt (PCon "Lune.Prelude.False" []) (CVar "Lune.Prelude.False")])])])),CoreDecl "" (CInt 0),CoreDecl "Lune.String.charsContains" (CLam [PVar "needle",PVar "haystack"] (CCase (CVar "needle") [CoreAlt (PCon "Lune.Prelude.Nil" []) (CVar "Lune.Prelude.True"),CoreAlt PWildcard (CCase (CVar "haystack") [CoreAlt (PCon "Lune.Prelude.Nil" []) (CVar "Lune.Prelude.False"),CoreAlt (PCon "Lune.Prelude.Cons" [Located {locSpan = Span {spanStartLine = 160, spanStartCol = 14, spanEndLine = 160, spanEndCol = 16}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PWildcard},Located {locSpan = Span {spanStartLine = 160, spanStartCol = 16, spanEndLine = 160, spanEndCol = 21}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "rest"}]) (CCase (CApp (CApp (CVar "Lune.String.charsStartsWith") (CVar "needle")) (CVar "haystack")) [CoreAlt (PCon "Lune.Prelude.True" []) (CVar "Lune.Prelude.True"),CoreAlt (PCon "Lune.Prelude.False" []) (CApp (CApp (CVar "Lune.String.charsContains") (CVar "needle")) (CVar "rest"))])])])),CoreDecl "" (CInt 0),CoreDecl "Lune.String.splitHelper" (CLam [PVar "delim",PVar "chars",PVar "acc"] (CCase (CVar "chars") [CoreAlt (PCon "Lune.Prelude.Nil" []) (CApp (CApp (CVar "Lune.Prelude.Cons") (CApp (CVar "Lune.String.fromChars") (CApp (CVar "Lune.String.listReverse") (CVar "acc")))) (CVar "Lune.Prelude.Nil")),CoreAlt (PCon "Lune.Prelude.Cons" [Located {locSpan = Span {spanStartLine = 169, spanStartCol = 10, spanEndLine = 169, spanEndCol = 12}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "c"},Located {locSpan = Span {spanStartLine = 169, spanStartCol = 12, spanEndLine = 169, spanEndCol = 17}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "rest"}]) (CCase (CApp (CApp (CVar "Lune.String.charsStartsWith") (CVar "delim")) (CVar "chars")) [CoreAlt (PCon "Lune.Prelude.True" []) (CApp (CApp (CVar "Lune.Prelude.Cons") (CApp (CVar "Lune.String.fromChars") (CApp (CVar "Lune.String.listReverse") (CVar "acc")))) (CApp (CApp (CApp (CVar "Lune.String.splitHelper") (CVar "delim")) (CApp (CApp (CVar "Lune.String.listDrop") (CApp (CVar "Lune.String.listLength") (CVar "delim"))) (CVar "chars"))) (CVar "Lune.Prelude.Nil"))),CoreAlt (PCon "Lune.Prelude.False" []) (CApp (CApp (CApp (CVar "Lune.String.splitHelper") (CVar "delim")) (CVar "rest")) (CApp (CApp (CVar "Lune.Prelude.Cons") (CVar "c")) (CVar "acc")))])])),CoreDecl "" (CInt 0),CoreDecl "Lune.String.indexOfHelper" (CLam [PVar "needle",PVar "haystack",PVar "idx"] (CCase (CVar "needle") [CoreAlt (PCon "Lune.Prelude.Nil" []) (CApp (CVar "Lune.Prelude.Just") (CVar "idx")),CoreAlt PWildcard (CCase (CVar "haystack") [CoreAlt (PCon "Lune.Prelude.Nil" []) (CVar "Lune.Prelude.Nothing"),CoreAlt (PCon "Lune.Prelude.Cons" [Located {locSpan = Span {spanStartLine = 184, spanStartCol = 14, spanEndLine = 184, spanEndCol = 16}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PWildcard},Located {locSpan = Span {spanStartLine = 184, spanStartCol = 16, spanEndLine = 184, spanEndCol = 21}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "rest"}]) (CCase (CApp (CApp (CVar "Lune.String.charsStartsWith") (CVar "needle")) (CVar "haystack")) [CoreAlt (PCon "Lune.Prelude.True" []) (CApp (CVar "Lune.Prelude.Just") (CVar "idx")),CoreAlt (PCon "Lune.Prelude.False" []) (CApp (CApp (CApp (CVar "Lune.String.indexOfHelper") (CVar "needle")) (CVar "rest")) (CApp (CApp (CVar "prim_addInt") (CVar "idx")) (CInt 1)))])])])),CoreDecl "" (CInt 0),CoreDecl "Lune.String.dropWhileChars" (CLam [PVar "pred",PVar "chars"] (CCase (CVar "chars") [CoreAlt (PCon "Lune.Prelude.Nil" []) (CVar "Lune.Prelude.Nil"),CoreAlt (PCon "Lune.Prelude.Cons" [Located {locSpan = Span {spanStartLine = 193, spanStartCol = 10, spanEndLine = 193, spanEndCol = 12}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "c"},Located {locSpan = Span {spanStartLine = 193, spanStartCol = 12, spanEndLine = 193, spanEndCol = 17}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "rest"}]) (CCase (CApp (CVar "pred") (CVar "c")) [CoreAlt (PCon "Lune.Prelude.True" []) (CApp (CApp (CVar "Lune.String.dropWhileChars") (CVar "pred")) (CVar "rest")),CoreAlt (PCon "Lune.Prelude.False" []) (CApp (CApp (CVar "Lune.Prelude.Cons") (CVar "c")) (CVar "rest"))])])),CoreDecl "" (CInt 0),CoreDecl "Lune.String.listLength" (CLam [PVar "xs"] (CCase (CVar "xs") [CoreAlt (PCon "Lune.Prelude.Nil" []) (CInt 0),CoreAlt (PCon "Lune.Prelude.Cons" [Located {locSpan = Span {spanStartLine = 202, spanStartCol = 10, spanEndLine = 202, spanEndCol = 12}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PWildcard},Located {locSpan = Span {spanStartLine = 202, spanStartCol = 12, spanEndLine = 202, spanEndCol = 17}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "rest"}]) (CApp (CApp (CVar "prim_addInt") (CInt 1)) (CApp (CVar "Lune.String.listLength") (CVar "rest")))])),CoreDecl "" (CInt 0),CoreDecl "Lune.String.listMap" (CLam [PVar "f",PVar "xs"] (CCase (CVar "xs") [CoreAlt (PCon "Lune.Prelude.Nil" []) (CVar "Lune.Prelude.Nil"),CoreAlt (PCon "Lune.Prelude.Cons" [Located {locSpan = Span {spanStartLine = 208, spanStartCol = 10, spanEndLine = 208, spanEndCol = 12}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "x"},Located {locSpan = Span {spanStartLine = 208, spanStartCol = 12, spanEndLine = 208, spanEndCol = 17}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "rest"}]) (CApp (CApp (CVar "Lune.Prelude.Cons") (CApp (CVar "f") (CVar "x"))) (CApp (CApp (CVar "Lune.String.listMap") (CVar "f")) (CVar "rest")))])),CoreDecl "" (CInt 0),CoreDecl "Lune.String.listReverse" (CLam [PVar "xs"] (CApp (CApp (CVar "Lune.String.listReverseHelper") (CVar "xs")) (CVar "Lune.Prelude.Nil"))),CoreDecl "" (CInt 0),CoreDecl "Lune.String.listReverseHelper" (CLam [PVar "xs",PVar "acc"] (CCase (CVar "xs") [CoreAlt (PCon "Lune.Prelude.Nil" []) (CVar "acc"),CoreAlt (PCon "Lune.Prelude.Cons" [Located {locSpan = Span {spanStartLine = 217, spanStartCol = 10, spanEndLine = 217, spanEndCol = 12}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "x"},Located {locSpan = Span {spanStartLine = 217, spanStartCol = 12, spanEndLine = 217, spanEndCol = 17}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "rest"}]) (CApp (CApp (CVar "Lune.String.listReverseHelper") (CVar "rest")) (CApp (CApp (CVar "Lune.Prelude.Cons") (CVar "x")) (CVar "acc")))])),CoreDecl "" (CInt 0),CoreDecl "Lune.String.listDrop" (CLam [PVar "n",PVar "xs"] (CCase (CApp (CApp (CVar "prim_leInt") (CVar "n")) (CInt 0)) [CoreAlt (PCon "Lune.Prelude.True" []) (CVar "xs"),CoreAlt (PCon "Lune.Prelude.False" []) (CCase (CVar "xs") [CoreAlt (PCon "Lune.Prelude.Nil" []) (CVar "Lune.Prelude.Nil"),CoreAlt (PCon "Lune.Prelude.Cons" [Located {locSpan = Span {spanStartLine = 226, spanStartCol = 14, spanEndLine = 226, spanEndCol = 16}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PWildcard},Located {locSpan = Span {spanStartLine = 226, spanStartCol = 16, spanEndLine = 226, spanEndCol = 21}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "rest"}]) (CApp (CApp (CVar "Lune.String.listDrop") (CApp (CApp (CVar "prim_subInt") (CVar "n")) (CInt 1))) (CVar "rest"))])])),CoreDecl "" (CInt 0),CoreDecl "Lune.String.listTake" (CLam [PVar "n",PVar "xs"] (CCase (CApp (CApp (CVar "prim_leInt") (CVar "n")) (CInt 0)) [CoreAlt (PCon "Lune.Prelude.True" []) (CVar "Lune.Prelude.Nil"),CoreAlt (PCon "Lune.Prelude.False" []) (CCase (CVar "xs") [CoreAlt (PCon "Lune.Prelude.Nil" []) (CVar "Lune.Prelude.Nil"),CoreAlt (PCon "Lune.Prelude.Cons" [Located {locSpan = Span {spanStartLine = 235, spanStartCol = 14, spanEndLine = 235, spanEndCol = 16}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "x"},Located {locSpan = Span {spanStartLine = 235, spanStartCol = 16, spanEndLine = 235, spanEndCol = 21}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "rest"}]) (CApp (CApp (CVar "Lune.Prelude.Cons") (CVar "x")) (CApp (CApp (CVar "Lune.String.listTake") (CApp (CApp (CVar "prim_subInt") (CVar "n")) (CInt 1))) (CVar "rest")))])])),CoreDecl "" (CInt 0),CoreDecl "Lune.String.listFoldl" (CLam [PVar "f",PVar "acc",PVar "xs"] (CCase (CVar "xs") [CoreAlt (PCon "Lune.Prelude.Nil" []) (CVar "acc"),CoreAlt (PCon "Lune.Prelude.Cons" [Located {locSpan = Span {spanStartLine = 241, spanStartCol = 10, spanEndLine = 241, spanEndCol = 12}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "x"},Located {locSpan = Span {spanStartLine = 241, spanStartCol = 12, spanEndLine = 241, spanEndCol = 17}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "rest"}]) (CApp (CApp (CApp (CVar "Lune.String.listFoldl") (CVar "f")) (CApp (CApp (CVar "f") (CVar "acc")) (CVar "x"))) (CVar "rest"))])),CoreDecl "" (CInt 0),CoreDecl "Lune.Int.add" (CVar "prim_addInt"),CoreDecl "" (CInt 0),CoreDecl "Lune.Int.sub" (CVar "prim_subInt"),CoreDecl "" (CInt 0),CoreDecl "Lune.Int.mul" (CVar "prim_mulInt"),CoreDecl "" (CInt 0),CoreDecl "Lune.Int.div" (CVar "prim_divInt"),CoreDecl "" (CInt 0),CoreDecl "Lune.Int.mod" (CVar "prim_modInt"),CoreDecl "" (CInt 0),CoreDecl "Lune.Int.eq" (CVar "prim_eqInt"),CoreDecl "" (CInt 0),CoreDecl "Lune.Int.gte" (CVar "prim_geInt"),CoreDecl "" (CInt 0),CoreDecl "Lune.Int.lte" (CVar "prim_leInt"),CoreDecl "" (CInt 0),CoreDecl "Lune.Int.max" (CLam [PVar "a",PVar "b"] (CCase (CApp (CApp (CVar "prim_geInt") (CVar "a")) (CVar "b")) [CoreAlt (PCon "Lune.Prelude.True" []) (CVar "a"),CoreAlt (PCon "Lune.Prelude.False" []) (CVar "b")])),CoreDecl "" (CInt 0),CoreDecl "Lune.Int.min" (CLam [PVar "a",PVar "b"] (CCase (CApp (CApp (CVar "prim_leInt") (CVar "a")) (CVar "b")) [CoreAlt (PCon "Lune.Prelude.True" []) (CVar "a"),CoreAlt (PCon "Lune.Prelude.False" []) (CVar "b")])),CoreDecl "" (CInt 0),CoreDecl "Lune.Float.add" (CVar "prim_addFloat"),CoreDecl "" (CInt 0),CoreDecl "Lune.Float.sub" (CVar "prim_subFloat"),CoreDecl "" (CInt 0),CoreDecl "Lune.Float.mul" (CVar "prim_mulFloat"),CoreDecl "" (CInt 0),CoreDecl "Lune.Float.div" (CVar "prim_divFloat"),CoreDecl "" (CInt 0),CoreDecl "Lune.Float.eq" (CVar "prim_eqFloat"),CoreDecl "" (CInt 0),CoreDecl "Lune.Float.gt" (CVar "prim_gtFloat"),CoreDecl "" (CInt 0),CoreDecl "Lune.Float.lt" (CVar "prim_ltFloat"),CoreDecl "" (CInt 0),CoreDecl "Lune.Float.gte" (CVar "prim_geFloat"),CoreDecl "" (CInt 0),CoreDecl "Lune.Float.lte" (CVar "prim_leFloat"),CoreDecl "" (CInt 0),CoreDecl "Lune.Float.fromInt" (CVar "prim_fromIntFloat"),CoreDecl "" (CInt 0),CoreDecl "Lune.Float.truncate" (CVar "prim_truncateFloat"),CoreDecl "" (CInt 0),CoreDecl "Lune.Float.percent" (CLam [PVar "part",PVar "total"] (CCase (CApp (CApp (CVar "prim_leInt") (CVar "total")) (CInt 0)) [CoreAlt (PCon "Lune.Prelude.True" []) (CFloat 0.0),CoreAlt (PCon "Lune.Prelude.False" []) (CApp (CApp (CVar "prim_mulFloat") (CFloat 100.0)) (CApp (CApp (CVar "prim_divFloat") (CApp (CVar "prim_fromIntFloat") (CApp (CApp (CVar "Lune.Float.max") (CInt 0)) (CVar "part")))) (CApp (CVar "prim_fromIntFloat") (CVar "total"))))])),CoreDecl "" (CInt 0),CoreDecl "Lune.Float.max" (CLam [PVar "a",PVar "b"] (CCase (CApp (CApp (CVar "prim_geInt") (CVar "a")) (CVar "b")) [CoreAlt (PCon "Lune.Prelude.True" []) (CVar "a"),CoreAlt (PCon "Lune.Prelude.False" []) (CVar "b")])),CoreDecl "" (CInt 0),CoreDecl "Lune.List.map" (CLam [PVar "f",PVar "xs"] (CCase (CVar "xs") [CoreAlt (PCon "Lune.Prelude.Nil" []) (CVar "Lune.Prelude.Nil"),CoreAlt (PCon "Lune.Prelude.Cons" [Located {locSpan = Span {spanStartLine = 12, spanStartCol = 10, spanEndLine = 12, spanEndCol = 12}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "x"},Located {locSpan = Span {spanStartLine = 12, spanStartCol = 12, spanEndLine = 12, spanEndCol = 15}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "xt"}]) (CApp (CApp (CVar "Lune.Prelude.Cons") (CApp (CVar "f") (CVar "x"))) (CApp (CApp (CVar "Lune.List.map") (CVar "f")) (CVar "xt")))])),CoreDecl "" (CInt 0),CoreDecl "Lune.List.foldl" (CLam [PVar "f",PVar "acc",PVar "xs"] (CCase (CVar "xs") [CoreAlt (PCon "Lune.Prelude.Nil" []) (CVar "acc"),CoreAlt (PCon "Lune.Prelude.Cons" [Located {locSpan = Span {spanStartLine = 18, spanStartCol = 10, spanEndLine = 18, spanEndCol = 12}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "x"},Located {locSpan = Span {spanStartLine = 18, spanStartCol = 12, spanEndLine = 18, spanEndCol = 15}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "xt"}]) (CApp (CApp (CApp (CVar "Lune.List.foldl") (CVar "f")) (CApp (CApp (CVar "f") (CVar "acc")) (CVar "x"))) (CVar "xt"))])),CoreDecl "" (CInt 0),CoreDecl "Lune.List.length" (CLam [PVar "xs"] (CCase (CVar "xs") [CoreAlt (PCon "Lune.Prelude.Nil" []) (CInt 0),CoreAlt (PCon "Lune.Prelude.Cons" [Located {locSpan = Span {spanStartLine = 24, spanStartCol = 10, spanEndLine = 24, spanEndCol = 12}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PWildcard},Located {locSpan = Span {spanStartLine = 24, spanStartCol = 12, spanEndLine = 24, spanEndCol = 15}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "xt"}]) (CApp (CApp (CVar "Lune.Int.add") (CInt 1)) (CApp (CVar "Lune.List.length") (CVar "xt")))])),CoreDecl "" (CInt 0),CoreDecl "Lune.List.reverse" (CLam [PVar "xs"] (CApp (CApp (CVar "Lune.List.reverseHelper") (CVar "xs")) (CVar "Lune.Prelude.Nil"))),CoreDecl "" (CInt 0),CoreDecl "Lune.List.reverseHelper" (CLam [PVar "xs",PVar "acc"] (CCase (CVar "xs") [CoreAlt (PCon "Lune.Prelude.Nil" []) (CVar "acc"),CoreAlt (PCon "Lune.Prelude.Cons" [Located {locSpan = Span {spanStartLine = 34, spanStartCol = 10, spanEndLine = 34, spanEndCol = 12}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "x"},Located {locSpan = Span {spanStartLine = 34, spanStartCol = 12, spanEndLine = 34, spanEndCol = 15}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "xt"}]) (CApp (CApp (CVar "Lune.List.reverseHelper") (CVar "xt")) (CApp (CApp (CVar "Lune.Prelude.Cons") (CVar "x")) (CVar "acc")))])),CoreDecl "" (CInt 0),CoreDecl "Lune.List.findFirst" (CLam [PVar "pred",PVar "xs"] (CCase (CVar "xs") [CoreAlt (PCon "Lune.Prelude.Nil" []) (CVar "Lune.Prelude.Nothing"),CoreAlt (PCon "Lune.Prelude.Cons" [Located {locSpan = Span {spanStartLine = 40, spanStartCol = 10, spanEndLine = 40, spanEndCol = 12}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "x"},Located {locSpan = Span {spanStartLine = 40, spanStartCol = 12, spanEndLine = 40, spanEndCol = 17}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "rest"}]) (CCase (CApp (CVar "pred") (CVar "x")) [CoreAlt (PCon "Lune.Prelude.True" []) (CApp (CVar "Lune.Prelude.Just") (CVar "x")),CoreAlt (PCon "Lune.Prelude.False" []) (CApp (CApp (CVar "Lune.List.findFirst") (CVar "pred")) (CVar "rest"))])])),CoreDecl "" (CInt 0),CoreDecl "Lune.List.get" (CLam [PVar "n",PVar "xs"] (CCase (CApp (CApp (CVar "Lune.Int.lte") (CVar "n")) (CInt 0)) [CoreAlt (PCon "Lune.Prelude.True" []) (CCase (CVar "xs") [CoreAlt (PCon "Lune.Prelude.Nil" []) (CVar "Lune.Prelude.Nothing"),CoreAlt (PCon "Lune.Prelude.Cons" [Located {locSpan = Span {spanStartLine = 51, spanStartCol = 14, spanEndLine = 51, spanEndCol = 16}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "x"},Located {locSpan = Span {spanStartLine = 51, spanStartCol = 16, spanEndLine = 51, spanEndCol = 18}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PWildcard}]) (CApp (CVar "Lune.Prelude.Just") (CVar "x"))]),CoreAlt (PCon "Lune.Prelude.False" []) (CCase (CVar "xs") [CoreAlt (PCon "Lune.Prelude.Nil" []) (CVar "Lune.Prelude.Nothing"),CoreAlt (PCon "Lune.Prelude.Cons" [Located {locSpan = Span {spanStartLine = 55, spanStartCol = 14, spanEndLine = 55, spanEndCol = 16}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PWildcard},Located {locSpan = Span {spanStartLine = 55, spanStartCol = 16, spanEndLine = 55, spanEndCol = 21}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "rest"}]) (CApp (CApp (CVar "Lune.List.get") (CApp (CApp (CVar "Lune.Int.sub") (CVar "n")) (CInt 1))) (CVar "rest"))])])),CoreDecl "" (CInt 0),CoreDecl "Lune.List.takeWhile" (CLam [PVar "pred",PVar "xs"] (CCase (CVar "xs") [CoreAlt (PCon "Lune.Prelude.Nil" []) (CVar "Lune.Prelude.Nil"),CoreAlt (PCon "Lune.Prelude.Cons" [Located {locSpan = Span {spanStartLine = 61, spanStartCol = 10, spanEndLine = 61, spanEndCol = 12}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "x"},Located {locSpan = Span {spanStartLine = 61, spanStartCol = 12, spanEndLine = 61, spanEndCol = 17}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "rest"}]) (CCase (CApp (CVar "pred") (CVar "x")) [CoreAlt (PCon "Lune.Prelude.True" []) (CApp (CApp (CVar "Lune.Prelude.Cons") (CVar "x")) (CApp (CApp (CVar "Lune.List.takeWhile") (CVar "pred")) (CVar "rest"))),CoreAlt (PCon "Lune.Prelude.False" []) (CVar "Lune.Prelude.Nil")])])),CoreDecl "" (CInt 0),CoreDecl "Lune.List.dropWhile" (CLam [PVar "pred",PVar "xs"] (CCase (CVar "xs") [CoreAlt (PCon "Lune.Prelude.Nil" []) (CVar "Lune.Prelude.Nil"),CoreAlt (PCon "Lune.Prelude.Cons" [Located {locSpan = Span {spanStartLine = 70, spanStartCol = 10, spanEndLine = 70, spanEndCol = 12}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "x"},Located {locSpan = Span {spanStartLine = 70, spanStartCol = 12, spanEndLine = 70, spanEndCol = 17}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "rest"}]) (CCase (CApp (CVar "pred") (CVar "x")) [CoreAlt (PCon "Lune.Prelude.True" []) (CApp (CApp (CVar "Lune.List.dropWhile") (CVar "pred")) (CVar "rest")),CoreAlt (PCon "Lune.Prelude.False" []) (CVar "xs")])])),CoreDecl "" (CInt 0),CoreDecl "" (CInt 0),CoreDecl "Lune.Json.parse" (CVar "prim_jsonParse"),CoreDecl "" (CInt 0),CoreDecl "Lune.Json.stringify" (CVar "prim_jsonStringify"),CoreDecl "" (CInt 0),CoreDecl "" (CInt 0),CoreDecl "" (CInt 0),CoreDecl "" (CInt 0),CoreDecl "Lune.Json.Decode.decodeValue" (CLam [PVar "decoder",PVar "json"] (CApp (CVar "decoder") (CVar "json"))),CoreDecl "" (CInt 0),CoreDecl "Lune.Json.Decode.succeed" (CLam [PVar "value"] (CLam [PWildcard] (CApp (CVar "Lune.Prelude.Ok") (CVar "value")))),CoreDecl "" (CInt 0),CoreDecl "Lune.Json.Decode.fail" (CLam [PVar "message"] (CLam [PWildcard] (CApp (CVar "Lune.Prelude.Err") (CRecord [("message",CVar "message"),("path",CVar "Lune.Prelude.Nil")])))),CoreDecl "" (CInt 0),CoreDecl "Lune.Json.Decode.bool" (CLam [PVar "json"] (CCase (CApp (CVar "prim_jsonToBool") (CVar "json")) [CoreAlt (PCon "Lune.Prelude.Ok" [Located {locSpan = Span {spanStartLine = 38, spanStartCol = 10, spanEndLine = 38, spanEndCol = 12}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "b"}]) (CApp (CVar "Lune.Prelude.Ok") (CVar "b")),CoreAlt (PCon "Lune.Prelude.Err" [Located {locSpan = Span {spanStartLine = 39, spanStartCol = 11, spanEndLine = 39, spanEndCol = 15}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "msg"}]) (CApp (CVar "Lune.Prelude.Err") (CRecord [("message",CVar "msg"),("path",CVar "Lune.Prelude.Nil")]))])),CoreDecl "" (CInt 0),CoreDecl "Lune.Json.Decode.int" (CLam [PVar "json"] (CCase (CApp (CVar "prim_jsonToInt") (CVar "json")) [CoreAlt (PCon "Lune.Prelude.Ok" [Located {locSpan = Span {spanStartLine = 45, spanStartCol = 10, spanEndLine = 45, spanEndCol = 12}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "n"}]) (CApp (CVar "Lune.Prelude.Ok") (CVar "n")),CoreAlt (PCon "Lune.Prelude.Err" [Located {locSpan = Span {spanStartLine = 46, spanStartCol = 11, spanEndLine = 46, spanEndCol = 15}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "msg"}]) (CApp (CVar "Lune.Prelude.Err") (CRecord [("message",CVar "msg"),("path",CVar "Lune.Prelude.Nil")]))])),CoreDecl "" (CInt 0),CoreDecl "Lune.Json.Decode.float" (CLam [PVar "json"] (CCase (CApp (CVar "prim_jsonToFloat") (CVar "json")) [CoreAlt (PCon "Lune.Prelude.Ok" [Located {locSpan = Span {spanStartLine = 52, spanStartCol = 10, spanEndLine = 52, spanEndCol = 12}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "f"}]) (CApp (CVar "Lune.Prelude.Ok") (CVar "f")),CoreAlt (PCon "Lune.Prelude.Err" [Located {locSpan = Span {spanStartLine = 53, spanStartCol = 11, spanEndLine = 53, spanEndCol = 15}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "msg"}]) (CApp (CVar "Lune.Prelude.Err") (CRecord [("message",CVar "msg"),("path",CVar "Lune.Prelude.Nil")]))])),CoreDecl "" (CInt 0),CoreDecl "Lune.Json.Decode.string" (CLam [PVar "json"] (CCase (CApp (CVar "prim_jsonToString") (CVar "json")) [CoreAlt (PCon "Lune.Prelude.Ok" [Located {locSpan = Span {spanStartLine = 59, spanStartCol = 10, spanEndLine = 59, spanEndCol = 12}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "s"}]) (CApp (CVar "Lune.Prelude.Ok") (CVar "s")),CoreAlt (PCon "Lune.Prelude.Err" [Located {locSpan = Span {spanStartLine = 60, spanStartCol = 11, spanEndLine = 60, spanEndCol = 15}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "msg"}]) (CApp (CVar "Lune.Prelude.Err") (CRecord [("message",CVar "msg"),("path",CVar "Lune.Prelude.Nil")]))])),CoreDecl "" (CInt 0),CoreDecl "Lune.Json.Decode.null" (CLam [PVar "defaultValue"] (CLam [PVar "json"] (CCase (CApp (CVar "prim_jsonIsNull") (CVar "json")) [CoreAlt (PCon "Lune.Prelude.True" []) (CApp (CVar "Lune.Prelude.Ok") (CVar "defaultValue")),CoreAlt (PCon "Lune.Prelude.False" []) (CApp (CVar "Lune.Prelude.Err") (CRecord [("message",CString "expected null"),("path",CVar "Lune.Prelude.Nil")]))]))),CoreDecl "" (CInt 0),CoreDecl "Lune.Json.Decode.list" (CLam [PVar "elemDecoder"] (CLam [PVar "json"] (CCase (CApp (CVar "prim_jsonToArray") (CVar "json")) [CoreAlt (PCon "Lune.Prelude.Err" [Located {locSpan = Span {spanStartLine = 73, spanStartCol = 11, spanEndLine = 73, spanEndCol = 15}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "msg"}]) (CApp (CVar "Lune.Prelude.Err") (CRecord [("message",CVar "msg"),("path",CVar "Lune.Prelude.Nil")])),CoreAlt (PCon "Lune.Prelude.Ok" [Located {locSpan = Span {spanStartLine = 74, spanStartCol = 10, spanEndLine = 74, spanEndCol = 19}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "elements"}]) (CApp (CApp (CApp (CVar "Lune.Json.Decode.decodeList") (CVar "elemDecoder")) (CInt 0)) (CVar "elements"))]))),CoreDecl "" (CInt 0),CoreDecl "Lune.Json.Decode.decodeList" (CLam [PVar "decoder",PVar "idx",PVar "elements"] (CCase (CVar "elements") [CoreAlt (PCon "Lune.Prelude.Nil" []) (CApp (CVar "Lune.Prelude.Ok") (CVar "Lune.Prelude.Nil")),CoreAlt (PCon "Lune.Prelude.Cons" [Located {locSpan = Span {spanStartLine = 80, spanStartCol = 10, spanEndLine = 80, spanEndCol = 12}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "x"},Located {locSpan = Span {spanStartLine = 80, spanStartCol = 12, spanEndLine = 80, spanEndCol = 15}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "xs"}]) (CCase (CApp (CVar "decoder") (CVar "x")) [CoreAlt (PCon "Lune.Prelude.Err" [Located {locSpan = Span {spanStartLine = 82, spanStartCol = 13, spanEndLine = 82, spanEndCol = 17}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "err"}]) (CApp (CVar "Lune.Prelude.Err") (CApp (CApp (CVar "Lune.Json.Decode.prependPath") (CApp (CVar "Lune.Json.Decode.Index") (CVar "idx"))) (CVar "err"))),CoreAlt (PCon "Lune.Prelude.Ok" [Located {locSpan = Span {spanStartLine = 83, spanStartCol = 12, spanEndLine = 83, spanEndCol = 14}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "a"}]) (CCase (CApp (CApp (CApp (CVar "Lune.Json.Decode.decodeList") (CVar "decoder")) (CApp (CApp (CVar "Lune.Int.add") (CVar "idx")) (CInt 1))) (CVar "xs")) [CoreAlt (PCon "Lune.Prelude.Err" [Located {locSpan = Span {spanStartLine = 85, spanStartCol = 17, spanEndLine = 85, spanEndCol = 21}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "err"}]) (CApp (CVar "Lune.Prelude.Err") (CVar "err")),CoreAlt (PCon "Lune.Prelude.Ok" [Located {locSpan = Span {spanStartLine = 86, spanStartCol = 16, spanEndLine = 86, spanEndCol = 21}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "rest"}]) (CApp (CVar "Lune.Prelude.Ok") (CApp (CApp (CVar "Lune.Prelude.Cons") (CVar "a")) (CVar "rest")))])])])),CoreDecl "" (CInt 0),CoreDecl "Lune.Json.Decode.maybe" (CLam [PVar "decoder"] (CLam [PVar "json"] (CCase (CApp (CVar "prim_jsonIsNull") (CVar "json")) [CoreAlt (PCon "Lune.Prelude.True" []) (CApp (CVar "Lune.Prelude.Ok") (CVar "Lune.Prelude.Nothing")),CoreAlt (PCon "Lune.Prelude.False" []) (CCase (CApp (CVar "decoder") (CVar "json")) [CoreAlt (PCon "Lune.Prelude.Ok" [Located {locSpan = Span {spanStartLine = 95, spanStartCol = 14, spanEndLine = 95, spanEndCol = 16}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "a"}]) (CApp (CVar "Lune.Prelude.Ok") (CApp (CVar "Lune.Prelude.Just") (CVar "a"))),CoreAlt (PCon "Lune.Prelude.Err" [Located {locSpan = Span {spanStartLine = 96, spanStartCol = 15, spanEndLine = 96, spanEndCol = 19}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "err"}]) (CApp (CVar "Lune.Prelude.Err") (CVar "err"))])]))),CoreDecl "" (CInt 0),CoreDecl "Lune.Json.Decode.field" (CLam [PVar "name",PVar "decoder"] (CLam [PVar "json"] (CCase (CApp (CApp (CVar "prim_jsonGetField") (CVar "name")) (CVar "json")) [CoreAlt (PCon "Lune.Prelude.Err" [Located {locSpan = Span {spanStartLine = 102, spanStartCol = 11, spanEndLine = 102, spanEndCol = 15}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "msg"}]) (CApp (CVar "Lune.Prelude.Err") (CRecord [("message",CVar "msg"),("path",CApp (CApp (CVar "Lune.Prelude.Cons") (CApp (CVar "Lune.Json.Decode.Field") (CVar "name"))) (CVar "Lune.Prelude.Nil"))])),CoreAlt (PCon "Lune.Prelude.Ok" [Located {locSpan = Span {spanStartLine = 103, spanStartCol = 10, spanEndLine = 103, spanEndCol = 20}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "fieldJson"}]) (CCase (CApp (CVar "decoder") (CVar "fieldJson")) [CoreAlt (PCon "Lune.Prelude.Err" [Located {locSpan = Span {spanStartLine = 105, spanStartCol = 15, spanEndLine = 105, spanEndCol = 19}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "err"}]) (CApp (CVar "Lune.Prelude.Err") (CApp (CApp (CVar "Lune.Json.Decode.prependPath") (CApp (CVar "Lune.Json.Decode.Field") (CVar "name"))) (CVar "err"))),CoreAlt (PCon "Lune.Prelude.Ok" [Located {locSpan = Span {spanStartLine = 106, spanStartCol = 14, spanEndLine = 106, spanEndCol = 16}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "a"}]) (CApp (CVar "Lune.Prelude.Ok") (CVar "a"))])]))),CoreDecl "" (CInt 0),CoreDecl "Lune.Json.Decode.index" (CLam [PVar "idx",PVar "decoder"] (CLam [PVar "json"] (CCase (CApp (CApp (CVar "prim_jsonGetIndex") (CVar "idx")) (CVar "json")) [CoreAlt (PCon "Lune.Prelude.Err" [Located {locSpan = Span {spanStartLine = 112, spanStartCol = 11, spanEndLine = 112, spanEndCol = 15}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "msg"}]) (CApp (CVar "Lune.Prelude.Err") (CRecord [("message",CVar "msg"),("path",CApp (CApp (CVar "Lune.Prelude.Cons") (CApp (CVar "Lune.Json.Decode.Index") (CVar "idx"))) (CVar "Lune.Prelude.Nil"))])),CoreAlt (PCon "Lune.Prelude.Ok" [Located {locSpan = Span {spanStartLine = 113, spanStartCol = 10, spanEndLine = 113, spanEndCol = 19}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "elemJson"}]) (CCase (CApp (CVar "decoder") (CVar "elemJson")) [CoreAlt (PCon "Lune.Prelude.Err" [Located {locSpan = Span {spanStartLine = 115, spanStartCol = 15, spanEndLine = 115, spanEndCol = 19}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "err"}]) (CApp (CVar "Lune.Prelude.Err") (CApp (CApp (CVar "Lune.Json.Decode.prependPath") (CApp (CVar "Lune.Json.Decode.Index") (CVar "idx"))) (CVar "err"))),CoreAlt (PCon "Lune.Prelude.Ok" [Located {locSpan = Span {spanStartLine = 116, spanStartCol = 14, spanEndLine = 116, spanEndCol = 16}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "a"}]) (CApp (CVar "Lune.Prelude.Ok") (CVar "a"))])]))),CoreDecl "" (CInt 0),CoreDecl "Lune.Json.Decode.at" (CLam [PVar "path",PVar "decoder"] (CCase (CVar "path") [CoreAlt (PCon "Lune.Prelude.Nil" []) (CVar "decoder"),CoreAlt (PCon "Lune.Prelude.Cons" [Located {locSpan = Span {spanStartLine = 122, spanStartCol = 10, spanEndLine = 122, spanEndCol = 15}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "name"},Located {locSpan = Span {spanStartLine = 122, spanStartCol = 15, spanEndLine = 122, spanEndCol = 20}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "rest"}]) (CApp (CApp (CVar "Lune.Json.Decode.field") (CVar "name")) (CApp (CApp (CVar "Lune.Json.Decode.at") (CVar "rest")) (CVar "decoder")))])),CoreDecl "" (CInt 0),CoreDecl "Lune.Json.Decode.map" (CLam [PVar "f",PVar "decoder"] (CLam [PVar "json"] (CCase (CApp (CVar "decoder") (CVar "json")) [CoreAlt (PCon "Lune.Prelude.Err" [Located {locSpan = Span {spanStartLine = 128, spanStartCol = 11, spanEndLine = 128, spanEndCol = 15}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "err"}]) (CApp (CVar "Lune.Prelude.Err") (CVar "err")),CoreAlt (PCon "Lune.Prelude.Ok" [Located {locSpan = Span {spanStartLine = 129, spanStartCol = 10, spanEndLine = 129, spanEndCol = 12}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "a"}]) (CApp (CVar "Lune.Prelude.Ok") (CApp (CVar "f") (CVar "a")))]))),CoreDecl "" (CInt 0),CoreDecl "Lune.Json.Decode.map2" (CLam [PVar "f",PVar "decoderA",PVar "decoderB"] (CLam [PVar "json"] (CCase (CApp (CVar "decoderA") (CVar "json")) [CoreAlt (PCon "Lune.Prelude.Err" [Located {locSpan = Span {spanStartLine = 135, spanStartCol = 11, spanEndLine = 135, spanEndCol = 15}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "err"}]) (CApp (CVar "Lune.Prelude.Err") (CVar "err")),CoreAlt (PCon "Lune.Prelude.Ok" [Located {locSpan = Span {spanStartLine = 136, spanStartCol = 10, spanEndLine = 136, spanEndCol = 12}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "a"}]) (CCase (CApp (CVar "decoderB") (CVar "json")) [CoreAlt (PCon "Lune.Prelude.Err" [Located {locSpan = Span {spanStartLine = 138, spanStartCol = 15, spanEndLine = 138, spanEndCol = 19}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "err"}]) (CApp (CVar "Lune.Prelude.Err") (CVar "err")),CoreAlt (PCon "Lune.Prelude.Ok" [Located {locSpan = Span {spanStartLine = 139, spanStartCol = 14, spanEndLine = 139, spanEndCol = 16}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "b"}]) (CApp (CVar "Lune.Prelude.Ok") (CApp (CApp (CVar "f") (CVar "a")) (CVar "b")))])]))),CoreDecl "" (CInt 0),CoreDecl "Lune.Json.Decode.map3" (CLam [PVar "f",PVar "da",PVar "db",PVar "dc"] (CLam [PVar "json"] (CCase (CApp (CVar "da") (CVar "json")) [CoreAlt (PCon "Lune.Prelude.Err" [Located {locSpan = Span {spanStartLine = 145, spanStartCol = 11, spanEndLine = 145, spanEndCol = 15}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "err"}]) (CApp (CVar "Lune.Prelude.Err") (CVar "err")),CoreAlt (PCon "Lune.Prelude.Ok" [Located {locSpan = Span {spanStartLine = 146, spanStartCol = 10, spanEndLine = 146, spanEndCol = 12}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "a"}]) (CCase (CApp (CVar "db") (CVar "json")) [CoreAlt (PCon "Lune.Prelude.Err" [Located {locSpan = Span {spanStartLine = 148, spanStartCol = 15, spanEndLine = 148, spanEndCol = 19}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "err"}]) (CApp (CVar "Lune.Prelude.Err") (CVar "err")),CoreAlt (PCon "Lune.Prelude.Ok" [Located {locSpan = Span {spanStartLine = 149, spanStartCol = 14, spanEndLine = 149, spanEndCol = 16}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "b"}]) (CCase (CApp (CVar "dc") (CVar "json")) [CoreAlt (PCon "Lune.Prelude.Err" [Located {locSpan = Span {spanStartLine = 151, spanStartCol = 19, spanEndLine = 151, spanEndCol = 23}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "err"}]) (CApp (CVar "Lune.Prelude.Err") (CVar "err")),CoreAlt (PCon "Lune.Prelude.Ok" [Located {locSpan = Span {spanStartLine = 152, spanStartCol = 18, spanEndLine = 152, spanEndCol = 20}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "c"}]) (CApp (CVar "Lune.Prelude.Ok") (CApp (CApp (CApp (CVar "f") (CVar "a")) (CVar "b")) (CVar "c")))])])]))),CoreDecl "" (CInt 0),CoreDecl "Lune.Json.Decode.map4" (CLam [PVar "f",PVar "da",PVar "db",PVar "dc",PVar "dd"] (CLam [PVar "json"] (CCase (CApp (CVar "da") (CVar "json")) [CoreAlt (PCon "Lune.Prelude.Err" [Located {locSpan = Span {spanStartLine = 158, spanStartCol = 11, spanEndLine = 158, spanEndCol = 15}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "err"}]) (CApp (CVar "Lune.Prelude.Err") (CVar "err")),CoreAlt (PCon "Lune.Prelude.Ok" [Located {locSpan = Span {spanStartLine = 159, spanStartCol = 10, spanEndLine = 159, spanEndCol = 12}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "a"}]) (CCase (CApp (CVar "db") (CVar "json")) [CoreAlt (PCon "Lune.Prelude.Err" [Located {locSpan = Span {spanStartLine = 161, spanStartCol = 15, spanEndLine = 161, spanEndCol = 19}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "err"}]) (CApp (CVar "Lune.Prelude.Err") (CVar "err")),CoreAlt (PCon "Lune.Prelude.Ok" [Located {locSpan = Span {spanStartLine = 162, spanStartCol = 14, spanEndLine = 162, spanEndCol = 16}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "b"}]) (CCase (CApp (CVar "dc") (CVar "json")) [CoreAlt (PCon "Lune.Prelude.Err" [Located {locSpan = Span {spanStartLine = 164, spanStartCol = 19, spanEndLine = 164, spanEndCol = 23}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "err"}]) (CApp (CVar "Lune.Prelude.Err") (CVar "err")),CoreAlt (PCon "Lune.Prelude.Ok" [Located {locSpan = Span {spanStartLine = 165, spanStartCol = 18, spanEndLine = 165, spanEndCol = 20}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "c"}]) (CCase (CApp (CVar "dd") (CVar "json")) [CoreAlt (PCon "Lune.Prelude.Err" [Located {locSpan = Span {spanStartLine = 167, spanStartCol = 23, spanEndLine = 167, spanEndCol = 27}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "err"}]) (CApp (CVar "Lune.Prelude.Err") (CVar "err")),CoreAlt (PCon "Lune.Prelude.Ok" [Located {locSpan = Span {spanStartLine = 168, spanStartCol = 22, spanEndLine = 168, spanEndCol = 24}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "d"}]) (CApp (CVar "Lune.Prelude.Ok") (CApp (CApp (CApp (CApp (CVar "f") (CVar "a")) (CVar "b")) (CVar "c")) (CVar "d")))])])])]))),CoreDecl "" (CInt 0),CoreDecl "Lune.Json.Decode.map5" (CLam [PVar "fn",PVar "da",PVar "db",PVar "dc",PVar "dd",PVar "de"] (CLam [PVar "json"] (CCase (CApp (CVar "da") (CVar "json")) [CoreAlt (PCon "Lune.Prelude.Err" [Located {locSpan = Span {spanStartLine = 174, spanStartCol = 11, spanEndLine = 174, spanEndCol = 15}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "err"}]) (CApp (CVar "Lune.Prelude.Err") (CVar "err")),CoreAlt (PCon "Lune.Prelude.Ok" [Located {locSpan = Span {spanStartLine = 175, spanStartCol = 10, spanEndLine = 175, spanEndCol = 12}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "a"}]) (CCase (CApp (CVar "db") (CVar "json")) [CoreAlt (PCon "Lune.Prelude.Err" [Located {locSpan = Span {spanStartLine = 177, spanStartCol = 15, spanEndLine = 177, spanEndCol = 19}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "err"}]) (CApp (CVar "Lune.Prelude.Err") (CVar "err")),CoreAlt (PCon "Lune.Prelude.Ok" [Located {locSpan = Span {spanStartLine = 178, spanStartCol = 14, spanEndLine = 178, spanEndCol = 16}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "b"}]) (CCase (CApp (CVar "dc") (CVar "json")) [CoreAlt (PCon "Lune.Prelude.Err" [Located {locSpan = Span {spanStartLine = 180, spanStartCol = 19, spanEndLine = 180, spanEndCol = 23}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "err"}]) (CApp (CVar "Lune.Prelude.Err") (CVar "err")),CoreAlt (PCon "Lune.Prelude.Ok" [Located {locSpan = Span {spanStartLine = 181, spanStartCol = 18, spanEndLine = 181, spanEndCol = 20}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "c"}]) (CCase (CApp (CVar "dd") (CVar "json")) [CoreAlt (PCon "Lune.Prelude.Err" [Located {locSpan = Span {spanStartLine = 183, spanStartCol = 23, spanEndLine = 183, spanEndCol = 27}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "err"}]) (CApp (CVar "Lune.Prelude.Err") (CVar "err")),CoreAlt (PCon "Lune.Prelude.Ok" [Located {locSpan = Span {spanStartLine = 184, spanStartCol = 22, spanEndLine = 184, spanEndCol = 24}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "d"}]) (CCase (CApp (CVar "de") (CVar "json")) [CoreAlt (PCon "Lune.Prelude.Err" [Located {locSpan = Span {spanStartLine = 186, spanStartCol = 27, spanEndLine = 186, spanEndCol = 31}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "err"}]) (CApp (CVar "Lune.Prelude.Err") (CVar "err")),CoreAlt (PCon "Lune.Prelude.Ok" [Located {locSpan = Span {spanStartLine = 187, spanStartCol = 26, spanEndLine = 187, spanEndCol = 28}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "e"}]) (CApp (CVar "Lune.Prelude.Ok") (CApp (CApp (CApp (CApp (CApp (CVar "fn") (CVar "a")) (CVar "b")) (CVar "c")) (CVar "d")) (CVar "e")))])])])])]))),CoreDecl "" (CInt 0),CoreDecl "Lune.Json.Decode.andThen" (CLam [PVar "continuation",PVar "decoder"] (CLam [PVar "json"] (CCase (CApp (CVar "decoder") (CVar "json")) [CoreAlt (PCon "Lune.Prelude.Err" [Located {locSpan = Span {spanStartLine = 193, spanStartCol = 11, spanEndLine = 193, spanEndCol = 15}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "err"}]) (CApp (CVar "Lune.Prelude.Err") (CVar "err")),CoreAlt (PCon "Lune.Prelude.Ok" [Located {locSpan = Span {spanStartLine = 194, spanStartCol = 10, spanEndLine = 194, spanEndCol = 12}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "a"}]) (CApp (CApp (CVar "continuation") (CVar "a")) (CVar "json"))]))),CoreDecl "" (CInt 0),CoreDecl "Lune.Json.Decode.oneOf" (CLam [PVar "decoders"] (CLam [PVar "json"] (CApp (CApp (CApp (CVar "Lune.Json.Decode.tryDecoders") (CVar "decoders")) (CRecord [("message",CString "oneOf: no decoders provided"),("path",CVar "Lune.Prelude.Nil")])) (CVar "json")))),CoreDecl "" (CInt 0),CoreDecl "Lune.Json.Decode.tryDecoders" (CLam [PVar "decoders",PVar "lastErr",PVar "json"] (CCase (CVar "decoders") [CoreAlt (PCon "Lune.Prelude.Nil" []) (CApp (CVar "Lune.Prelude.Err") (CVar "lastErr")),CoreAlt (PCon "Lune.Prelude.Cons" [Located {locSpan = Span {spanStartLine = 205, spanStartCol = 10, spanEndLine = 205, spanEndCol = 18}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "decoder"},Located {locSpan = Span {spanStartLine = 205, spanStartCol = 18, spanEndLine = 205, spanEndCol = 23}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "rest"}]) (CCase (CApp (CVar "decoder") (CVar "json")) [CoreAlt (PCon "Lune.Prelude.Ok" [Located {locSpan = Span {spanStartLine = 207, spanStartCol = 12, spanEndLine = 207, spanEndCol = 14}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "a"}]) (CApp (CVar "Lune.Prelude.Ok") (CVar "a")),CoreAlt (PCon "Lune.Prelude.Err" [Located {locSpan = Span {spanStartLine = 208, spanStartCol = 13, spanEndLine = 208, spanEndCol = 17}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "err"}]) (CApp (CApp (CApp (CVar "Lune.Json.Decode.tryDecoders") (CVar "rest")) (CVar "err")) (CVar "json"))])])),CoreDecl "" (CInt 0),CoreDecl "Lune.Json.Decode.prependPath" (CLam [PVar "item",PVar "err"] (CRecord [("message",CSelect (CVar "err") "message"),("path",CApp (CApp (CVar "Lune.Prelude.Cons") (CVar "item")) (CSelect (CVar "err") "path"))])),CoreDecl "" (CInt 0),CoreDecl "" (CInt 0),CoreDecl "Lune.Json.Encode.null" (CVar "prim_jsonNull"),CoreDecl "" (CInt 0),CoreDecl "Lune.Json.Encode.bool" (CVar "prim_jsonBool"),CoreDecl "" (CInt 0),CoreDecl "Lune.Json.Encode.int" (CVar "prim_jsonInt"),CoreDecl "" (CInt 0),CoreDecl "Lune.Json.Encode.float" (CVar "prim_jsonFloat"),CoreDecl "" (CInt 0),CoreDecl "Lune.Json.Encode.string" (CVar "prim_jsonString"),CoreDecl "" (CInt 0),CoreDecl "Lune.Json.Encode.list" (CLam [PVar "encoder",PVar "items"] (CApp (CVar "prim_jsonArray") (CApp (CApp (CVar "Lune.List.map") (CVar "encoder")) (CVar "items")))),CoreDecl "" (CInt 0),CoreDecl "Lune.Json.Encode.object" (CLam [PVar "pairs"] (CApp (CVar "prim_jsonObject") (CVar "pairs"))),CoreDecl "" (CInt 0),CoreDecl "" (CInt 0),CoreDecl "Lune.Time.now" (CApp (CVar "Lune.Prelude.Task") (CApp (CApp (CVar "Lune.IO.andThen") (CVar "prim_timeNowMicros")) (CLam [PVar "micros"] (CApp (CVar "Lune.IO.pure") (CApp (CVar "Lune.Prelude.Ok") (CApp (CVar "Lune.Time.Timestamp") (CVar "micros"))))))),CoreDecl "" (CInt 0),CoreDecl "Lune.Time.fromMicros" (CLam [PVar "micros"] (CApp (CVar "Lune.Time.Timestamp") (CVar "micros"))),CoreDecl "" (CInt 0),CoreDecl "Lune.Time.toMicros" (CLam [PVar "ts"] (CCase (CVar "ts") [CoreAlt (PCon "Lune.Time.Timestamp" [Located {locSpan = Span {spanStartLine = 65, spanStartCol = 15, spanEndLine = 65, spanEndCol = 22}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "micros"}]) (CVar "micros")])),CoreDecl "" (CInt 0),CoreDecl "Lune.Time.add" (CLam [PVar "ts",PVar "micros"] (CCase (CVar "ts") [CoreAlt (PCon "Lune.Time.Timestamp" [Located {locSpan = Span {spanStartLine = 75, spanStartCol = 15, spanEndLine = 75, spanEndCol = 17}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "t"}]) (CApp (CVar "Lune.Time.Timestamp") (CApp (CApp (CVar "Lune.Int.add") (CVar "t")) (CVar "micros")))])),CoreDecl "" (CInt 0),CoreDecl "Lune.Time.sub" (CLam [PVar "ts",PVar "micros"] (CCase (CVar "ts") [CoreAlt (PCon "Lune.Time.Timestamp" [Located {locSpan = Span {spanStartLine = 81, spanStartCol = 15, spanEndLine = 81, spanEndCol = 17}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "t"}]) (CApp (CVar "Lune.Time.Timestamp") (CApp (CApp (CVar "Lune.Int.sub") (CVar "t")) (CVar "micros")))])),CoreDecl "" (CInt 0),CoreDecl "Lune.Time.diff" (CLam [PVar "a",PVar "b"] (CCase (CVar "a") [CoreAlt (PCon "Lune.Time.Timestamp" [Located {locSpan = Span {spanStartLine = 88, spanStartCol = 15, spanEndLine = 88, spanEndCol = 18}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "ta"}]) (CCase (CVar "b") [CoreAlt (PCon "Lune.Time.Timestamp" [Located {locSpan = Span {spanStartLine = 90, spanStartCol = 19, spanEndLine = 90, spanEndCol = 22}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "tb"}]) (CApp (CApp (CVar "Lune.Int.sub") (CVar "ta")) (CVar "tb"))])])),CoreDecl "" (CInt 0),CoreDecl "Lune.Time.eq" (CLam [PVar "a",PVar "b"] (CCase (CVar "a") [CoreAlt (PCon "Lune.Time.Timestamp" [Located {locSpan = Span {spanStartLine = 100, spanStartCol = 15, spanEndLine = 100, spanEndCol = 18}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "ta"}]) (CCase (CVar "b") [CoreAlt (PCon "Lune.Time.Timestamp" [Located {locSpan = Span {spanStartLine = 102, spanStartCol = 19, spanEndLine = 102, spanEndCol = 22}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "tb"}]) (CApp (CApp (CVar "Lune.Int.eq") (CVar "ta")) (CVar "tb"))])])),CoreDecl "" (CInt 0),CoreDecl "Lune.Time.lt" (CLam [PVar "a",PVar "b"] (CApp (CVar "Lune.Time.ltHelp") (CApp (CApp (CVar "Lune.Time.diff") (CVar "a")) (CVar "b")))),CoreDecl "" (CInt 0),CoreDecl "Lune.Time.ltHelp" (CLam [PVar "d"] (CCase (CApp (CApp (CVar "Lune.Int.lte") (CVar "d")) (CInt 0)) [CoreAlt (PCon "Lune.Prelude.True" []) (CCase (CApp (CApp (CVar "Lune.Int.eq") (CVar "d")) (CInt 0)) [CoreAlt (PCon "Lune.Prelude.True" []) (CVar "Lune.Prelude.False"),CoreAlt (PCon "Lune.Prelude.False" []) (CVar "Lune.Prelude.True")]),CoreAlt (PCon "Lune.Prelude.False" []) (CVar "Lune.Prelude.False")])),CoreDecl "" (CInt 0),CoreDecl "Lune.Time.gt" (CLam [PVar "a",PVar "b"] (CApp (CApp (CVar "Lune.Time.lt") (CVar "b")) (CVar "a"))),CoreDecl "" (CInt 0),CoreDecl "Lune.Time.lte" (CLam [PVar "a",PVar "b"] (CCase (CApp (CApp (CVar "Lune.Time.lt") (CVar "a")) (CVar "b")) [CoreAlt (PCon "Lune.Prelude.True" []) (CVar "Lune.Prelude.True"),CoreAlt (PCon "Lune.Prelude.False" []) (CApp (CApp (CVar "Lune.Time.eq") (CVar "a")) (CVar "b"))])),CoreDecl "" (CInt 0),CoreDecl "Lune.Time.gte" (CLam [PVar "a",PVar "b"] (CApp (CApp (CVar "Lune.Time.lte") (CVar "b")) (CVar "a"))),CoreDecl "" (CInt 0),CoreDecl "Lune.Time.microsecond" (CInt 1),CoreDecl "" (CInt 0),CoreDecl "Lune.Time.millisecond" (CInt 1000),CoreDecl "" (CInt 0),CoreDecl "Lune.Time.second" (CInt 1000000),CoreDecl "" (CInt 0),CoreDecl "Lune.Time.minute" (CInt 60000000),CoreDecl "" (CInt 0),CoreDecl "Lune.Time.hour" (CInt 3600000000),CoreDecl "" (CInt 0),CoreDecl "Lune.Time.day" (CInt 86400000000),CoreDecl "" (CInt 0),CoreDecl "Lune.System.Linux.Proc.readFile" (CLam [PVar "path"] (CApp (CApp (CVar "Lune.Task.mapError") (CLam [PWildcard] (CApp (CApp (CVar "Lune.String.append") (CString "read:")) (CVar "path")))) (CApp (CVar "Lune.IO.readFile") (CVar "path")))),CoreDecl "" (CInt 0),CoreDecl "Lune.System.Linux.Proc.readFileOptional" (CLam [PVar "path"] (CApp (CApp (CVar "Lune.Task.map") (CVar "Lune.System.Linux.Proc.resultToMaybeString")) (CApp (CVar "Lune.Task.result") (CApp (CVar "Lune.IO.readFile") (CVar "path"))))),CoreDecl "" (CInt 0),CoreDecl "Lune.System.Linux.Proc.resultToMaybeString" (CLam [PVar "r"] (CCase (CVar "r") [CoreAlt (PCon "Lune.Prelude.Ok" [Located {locSpan = Span {spanStartLine = 42, spanStartCol = 8, spanEndLine = 42, spanEndCol = 10}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "s"}]) (CApp (CVar "Lune.Prelude.Just") (CApp (CVar "Lune.System.Linux.Proc.trimNewline") (CVar "s"))),CoreAlt (PCon "Lune.Prelude.Err" [Located {locSpan = Span {spanStartLine = 44, spanStartCol = 9, spanEndLine = 44, spanEndCol = 11}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PWildcard}]) (CVar "Lune.Prelude.Nothing")])),CoreDecl "" (CInt 0),CoreDecl "Lune.System.Linux.Proc.readIntFileOptional" (CLam [PVar "path"] (CApp (CApp (CVar "Lune.Task.map") (CLam [PVar "ms"] (CCase (CVar "ms") [CoreAlt (PCon "Lune.Prelude.Nothing" []) (CVar "Lune.Prelude.Nothing"),CoreAlt (PCon "Lune.Prelude.Just" [Located {locSpan = Span {spanStartLine = 54, spanStartCol = 14, spanEndLine = 54, spanEndCol = 16}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "s"}]) (CCase (CApp (CVar "Lune.System.Linux.Proc.parseInt") (CVar "s")) [CoreAlt (PCon "Lune.Prelude.Ok" [Located {locSpan = Span {spanStartLine = 56, spanStartCol = 16, spanEndLine = 56, spanEndCol = 18}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "n"}]) (CApp (CVar "Lune.Prelude.Just") (CVar "n")),CoreAlt (PCon "Lune.Prelude.Err" [Located {locSpan = Span {spanStartLine = 58, spanStartCol = 17, spanEndLine = 58, spanEndCol = 19}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PWildcard}]) (CVar "Lune.Prelude.Nothing")])]))) (CApp (CVar "Lune.System.Linux.Proc.readFileOptional") (CVar "path")))),CoreDecl "" (CInt 0),CoreDecl "Lune.System.Linux.Proc.trimNewline" (CLam [PVar "s"] (CCase (CApp (CApp (CVar "Lune.String.endsWith") (CString "\n")) (CVar "s")) [CoreAlt (PCon "Lune.Prelude.True" []) (CApp (CApp (CVar "Lune.String.take") (CApp (CApp (CVar "Lune.Int.sub") (CApp (CVar "Lune.String.length") (CVar "s"))) (CInt 1))) (CVar "s")),CoreAlt (PCon "Lune.Prelude.False" []) (CVar "s")])),CoreDecl "" (CInt 0),CoreDecl "Lune.System.Linux.Proc.splitOnce" (CLam [PVar "delim",PVar "s"] (CCase (CApp (CApp (CVar "Lune.String.indexOf") (CVar "delim")) (CVar "s")) [CoreAlt (PCon "Lune.Prelude.Nothing" []) (CVar "Lune.Prelude.Nothing"),CoreAlt (PCon "Lune.Prelude.Just" [Located {locSpan = Span {spanStartLine = 75, spanStartCol = 10, spanEndLine = 75, spanEndCol = 14}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "idx"}]) (CApp (CVar "Lune.Prelude.Just") (CApp (CApp (CVar "Lune.Prelude.Pair") (CApp (CApp (CVar "Lune.String.take") (CVar "idx")) (CVar "s"))) (CApp (CApp (CVar "Lune.String.drop") (CApp (CApp (CVar "Lune.Int.add") (CVar "idx")) (CApp (CVar "Lune.String.length") (CVar "delim")))) (CVar "s"))))])),CoreDecl "" (CInt 0),CoreDecl "Lune.System.Linux.Proc.parseKeyValueLine" (CLam [PVar "line"] (CCase (CApp (CApp (CVar "Lune.System.Linux.Proc.splitOnce") (CString ":")) (CVar "line")) [CoreAlt (PCon "Lune.Prelude.Nothing" []) (CVar "Lune.Prelude.Nothing"),CoreAlt (PCon "Lune.Prelude.Just" [Located {locSpan = Span {spanStartLine = 85, spanStartCol = 10, spanEndLine = 85, spanEndCol = 17}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PCon "Lune.Prelude.Pair" [Located {locSpan = Span {spanStartLine = 85, spanStartCol = 11, spanEndLine = 85, spanEndCol = 12}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "k"},Located {locSpan = Span {spanStartLine = 85, spanStartCol = 14, spanEndLine = 85, spanEndCol = 15}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "v"}]}]) (CApp (CVar "Lune.Prelude.Just") (CRecord [("key",CApp (CVar "Lune.String.trim") (CVar "k")),("value",CApp (CVar "Lune.String.trim") (CVar "v"))]))])),CoreDecl "" (CInt 0),CoreDecl "Lune.System.Linux.Proc.parseInt" (CLam [PVar "s"] (CApp (CVar "Lune.String.toInt") (CApp (CVar "Lune.String.trim") (CVar "s")))),CoreDecl "" (CInt 0),CoreDecl "Lune.System.Linux.Proc.parseHexInt" (CLam [PVar "s"] (CApp (CVar "Lune.System.Linux.Proc.parseHexFromChars") (CApp (CVar "Lune.System.Linux.Proc.normalizeHex") (CApp (CVar "Lune.String.trim") (CVar "s"))))),CoreDecl "" (CInt 0),CoreDecl "Lune.System.Linux.Proc.normalizeHex" (CLam [PVar "s"] (CCase (CApp (CApp (CVar "Lune.String.startsWith") (CString "0x")) (CApp (CVar "Lune.String.toLower") (CVar "s"))) [CoreAlt (PCon "Lune.Prelude.True" []) (CApp (CApp (CVar "Lune.String.drop") (CInt 2)) (CVar "s")),CoreAlt (PCon "Lune.Prelude.False" []) (CVar "s")])),CoreDecl "" (CInt 0),CoreDecl "Lune.System.Linux.Proc.parseHexFromChars" (CLam [PVar "s"] (CApp (CApp (CVar "Lune.System.Linux.Proc.parseHexChars") (CApp (CVar "Lune.String.toChars") (CVar "s"))) (CInt 0))),CoreDecl "" (CInt 0),CoreDecl "Lune.System.Linux.Proc.parseHexChars" (CLam [PVar "chars",PVar "acc"] (CCase (CVar "chars") [CoreAlt (PCon "Lune.Prelude.Nil" []) (CApp (CVar "Lune.Prelude.Ok") (CVar "acc")),CoreAlt (PCon "Lune.Prelude.Cons" [Located {locSpan = Span {spanStartLine = 111, spanStartCol = 10, spanEndLine = 111, spanEndCol = 12}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "c"},Located {locSpan = Span {spanStartLine = 111, spanStartCol = 12, spanEndLine = 111, spanEndCol = 17}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "rest"}]) (CCase (CApp (CVar "Lune.System.Linux.Proc.hexDigit") (CVar "c")) [CoreAlt (PCon "Lune.Prelude.Nothing" []) (CApp (CVar "Lune.Prelude.Err") (CApp (CApp (CVar "Lune.String.append") (CString "parse:invalid hex digit: ")) (CApp (CVar "Lune.String.fromChar") (CVar "c")))),CoreAlt (PCon "Lune.Prelude.Just" [Located {locSpan = Span {spanStartLine = 115, spanStartCol = 14, spanEndLine = 115, spanEndCol = 16}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "d"}]) (CApp (CApp (CVar "Lune.System.Linux.Proc.parseHexChars") (CVar "rest")) (CApp (CApp (CVar "Lune.Int.add") (CApp (CApp (CVar "Lune.Int.mul") (CVar "acc")) (CInt 16))) (CVar "d")))])])),CoreDecl "" (CInt 0),CoreDecl "Lune.System.Linux.Proc.hexDigit" (CLam [PVar "c"] (CLet "n" (CApp (CVar "Lune.Char.toInt") (CVar "c")) (CCase (CApp (CApp (CVar "Lune.Int.gte") (CVar "n")) (CInt 48)) [CoreAlt (PCon "Lune.Prelude.True" []) (CCase (CApp (CApp (CVar "Lune.Int.lte") (CVar "n")) (CInt 57)) [CoreAlt (PCon "Lune.Prelude.True" []) (CApp (CVar "Lune.Prelude.Just") (CApp (CApp (CVar "Lune.Int.sub") (CVar "n")) (CInt 48))),CoreAlt (PCon "Lune.Prelude.False" []) (CApp (CVar "Lune.System.Linux.Proc.hexAlphaDigit") (CApp (CVar "Lune.Char.toLower") (CVar "c")))]),CoreAlt (PCon "Lune.Prelude.False" []) (CApp (CVar "Lune.System.Linux.Proc.hexAlphaDigit") (CApp (CVar "Lune.Char.toLower") (CVar "c")))]))),CoreDecl "" (CInt 0),CoreDecl "Lune.System.Linux.Proc.hexAlphaDigit" (CLam [PVar "c"] (CLet "n" (CApp (CVar "Lune.Char.toInt") (CVar "c")) (CCase (CApp (CApp (CVar "Lune.Int.gte") (CVar "n")) (CInt 97)) [CoreAlt (PCon "Lune.Prelude.True" []) (CCase (CApp (CApp (CVar "Lune.Int.lte") (CVar "n")) (CInt 102)) [CoreAlt (PCon "Lune.Prelude.True" []) (CApp (CVar "Lune.Prelude.Just") (CApp (CApp (CVar "Lune.Int.add") (CInt 10)) (CApp (CApp (CVar "Lune.Int.sub") (CVar "n")) (CInt 97)))),CoreAlt (PCon "Lune.Prelude.False" []) (CVar "Lune.Prelude.Nothing")]),CoreAlt (PCon "Lune.Prelude.False" []) (CVar "Lune.Prelude.Nothing")]))),CoreDecl "" (CInt 0),CoreDecl "Lune.System.Linux.Proc.parseFloat" (CLam [PVar "s"] (CCase (CApp (CApp (CVar "Lune.System.Linux.Proc.splitOnce") (CString ".")) (CApp (CVar "Lune.String.trim") (CVar "s"))) [CoreAlt (PCon "Lune.Prelude.Nothing" []) (CCase (CApp (CVar "Lune.System.Linux.Proc.parseInt") (CVar "s")) [CoreAlt (PCon "Lune.Prelude.Ok" [Located {locSpan = Span {spanStartLine = 153, spanStartCol = 12, spanEndLine = 153, spanEndCol = 14}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "n"}]) (CApp (CVar "Lune.Prelude.Ok") (CApp (CVar "Lune.Float.fromInt") (CVar "n"))),CoreAlt (PCon "Lune.Prelude.Err" [Located {locSpan = Span {spanStartLine = 155, spanStartCol = 13, spanEndLine = 155, spanEndCol = 17}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "msg"}]) (CApp (CVar "Lune.Prelude.Err") (CApp (CApp (CVar "Lune.String.append") (CString "parse:")) (CVar "msg")))]),CoreAlt (PCon "Lune.Prelude.Just" [Located {locSpan = Span {spanStartLine = 157, spanStartCol = 10, spanEndLine = 157, spanEndCol = 17}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PCon "Lune.Prelude.Pair" [Located {locSpan = Span {spanStartLine = 157, spanStartCol = 11, spanEndLine = 157, spanEndCol = 12}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "a"},Located {locSpan = Span {spanStartLine = 157, spanStartCol = 14, spanEndLine = 157, spanEndCol = 15}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "b"}]}]) (CCase (CApp (CVar "Lune.System.Linux.Proc.parseInt") (CVar "a")) [CoreAlt (PCon "Lune.Prelude.Err" [Located {locSpan = Span {spanStartLine = 159, spanStartCol = 13, spanEndLine = 159, spanEndCol = 17}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "msg"}]) (CApp (CVar "Lune.Prelude.Err") (CApp (CApp (CVar "Lune.String.append") (CString "parse:")) (CVar "msg"))),CoreAlt (PCon "Lune.Prelude.Ok" [Located {locSpan = Span {spanStartLine = 161, spanStartCol = 12, spanEndLine = 161, spanEndCol = 20}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "intPart"}]) (CCase (CApp (CVar "Lune.System.Linux.Proc.parseInt") (CApp (CVar "Lune.System.Linux.Proc.digitsOnly") (CVar "b"))) [CoreAlt (PCon "Lune.Prelude.Err" [Located {locSpan = Span {spanStartLine = 163, spanStartCol = 17, spanEndLine = 163, spanEndCol = 19}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PWildcard}]) (CApp (CVar "Lune.Prelude.Ok") (CApp (CVar "Lune.Float.fromInt") (CVar "intPart"))),CoreAlt (PCon "Lune.Prelude.Ok" [Located {locSpan = Span {spanStartLine = 165, spanStartCol = 16, spanEndLine = 165, spanEndCol = 25}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "fracPart"}]) (CLet "scale" (CApp (CVar "Lune.System.Linux.Proc.pow10") (CApp (CVar "Lune.String.length") (CApp (CVar "Lune.System.Linux.Proc.digitsOnly") (CVar "b")))) (CLet "frac" (CApp (CApp (CVar "Lune.Float.div") (CApp (CVar "Lune.Float.fromInt") (CVar "fracPart"))) (CApp (CVar "Lune.Float.fromInt") (CVar "scale"))) (CApp (CVar "Lune.Prelude.Ok") (CApp (CApp (CVar "Lune.Float.add") (CApp (CVar "Lune.Float.fromInt") (CVar "intPart"))) (CVar "frac")))))])])])),CoreDecl "" (CInt 0),CoreDecl "Lune.System.Linux.Proc.digitsOnly" (CLam [PVar "s"] (CApp (CVar "Lune.String.fromChars") (CApp (CApp (CVar "Lune.System.Linux.Proc.takeWhileChars") (CVar "Lune.System.Linux.Proc.isDigit")) (CApp (CVar "Lune.String.toChars") (CVar "s"))))),CoreDecl "" (CInt 0),CoreDecl "Lune.System.Linux.Proc.takeWhileChars" (CLam [PVar "pred",PVar "cs"] (CCase (CVar "cs") [CoreAlt (PCon "Lune.Prelude.Nil" []) (CVar "Lune.Prelude.Nil"),CoreAlt (PCon "Lune.Prelude.Cons" [Located {locSpan = Span {spanStartLine = 180, spanStartCol = 10, spanEndLine = 180, spanEndCol = 12}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "c"},Located {locSpan = Span {spanStartLine = 180, spanStartCol = 12, spanEndLine = 180, spanEndCol = 17}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "rest"}]) (CCase (CApp (CVar "pred") (CVar "c")) [CoreAlt (PCon "Lune.Prelude.True" []) (CApp (CApp (CVar "Lune.Prelude.Cons") (CVar "c")) (CApp (CApp (CVar "Lune.System.Linux.Proc.takeWhileChars") (CVar "pred")) (CVar "rest"))),CoreAlt (PCon "Lune.Prelude.False" []) (CVar "Lune.Prelude.Nil")])])),CoreDecl "" (CInt 0),CoreDecl "Lune.System.Linux.Proc.isDigit" (CLam [PVar "c"] (CLet "n" (CApp (CVar "Lune.Char.toInt") (CVar "c")) (CCase (CApp (CApp (CVar "Lune.Int.gte") (CVar "n")) (CInt 48)) [CoreAlt (PCon "Lune.Prelude.True" []) (CApp (CApp (CVar "Lune.Int.lte") (CVar "n")) (CInt 57)),CoreAlt (PCon "Lune.Prelude.False" []) (CVar "Lune.Prelude.False")]))),CoreDecl "" (CInt 0),CoreDecl "Lune.System.Linux.Proc.pow10" (CLam [PVar "n"] (CCase (CApp (CApp (CVar "Lune.Int.lte") (CVar "n")) (CInt 0)) [CoreAlt (PCon "Lune.Prelude.True" []) (CInt 1),CoreAlt (PCon "Lune.Prelude.False" []) (CApp (CApp (CVar "Lune.Int.mul") (CInt 10)) (CApp (CVar "Lune.System.Linux.Proc.pow10") (CApp (CApp (CVar "Lune.Int.sub") (CVar "n")) (CInt 1))))])),CoreDecl "" (CInt 0),CoreDecl "Lune.System.Linux.Proc.parsePciAddress" (CLam [PVar "s"] (CCase (CApp (CApp (CVar "Lune.System.Linux.Proc.splitOnce") (CString ":")) (CApp (CVar "Lune.String.trim") (CVar "s"))) [CoreAlt (PCon "Lune.Prelude.Nothing" []) (CApp (CVar "Lune.Prelude.Err") (CString "parse:invalid PCI address")),CoreAlt (PCon "Lune.Prelude.Just" [Located {locSpan = Span {spanStartLine = 217, spanStartCol = 10, spanEndLine = 217, spanEndCol = 29}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PCon "Lune.Prelude.Pair" [Located {locSpan = Span {spanStartLine = 217, spanStartCol = 11, spanEndLine = 217, spanEndCol = 20}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "domainStr"},Located {locSpan = Span {spanStartLine = 217, spanStartCol = 22, spanEndLine = 217, spanEndCol = 27}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "rest1"}]}]) (CCase (CApp (CApp (CVar "Lune.System.Linux.Proc.splitOnce") (CString ":")) (CVar "rest1")) [CoreAlt (PCon "Lune.Prelude.Nothing" []) (CApp (CVar "Lune.Prelude.Err") (CString "parse:invalid PCI address")),CoreAlt (PCon "Lune.Prelude.Just" [Located {locSpan = Span {spanStartLine = 221, spanStartCol = 14, spanEndLine = 221, spanEndCol = 30}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PCon "Lune.Prelude.Pair" [Located {locSpan = Span {spanStartLine = 221, spanStartCol = 15, spanEndLine = 221, spanEndCol = 21}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "busStr"},Located {locSpan = Span {spanStartLine = 221, spanStartCol = 23, spanEndLine = 221, spanEndCol = 28}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "rest2"}]}]) (CCase (CApp (CApp (CVar "Lune.System.Linux.Proc.splitOnce") (CString ".")) (CVar "rest2")) [CoreAlt (PCon "Lune.Prelude.Nothing" []) (CApp (CVar "Lune.Prelude.Err") (CString "parse:invalid PCI address")),CoreAlt (PCon "Lune.Prelude.Just" [Located {locSpan = Span {spanStartLine = 225, spanStartCol = 18, spanEndLine = 225, spanEndCol = 34}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PCon "Lune.Prelude.Pair" [Located {locSpan = Span {spanStartLine = 225, spanStartCol = 19, spanEndLine = 225, spanEndCol = 25}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "devStr"},Located {locSpan = Span {spanStartLine = 225, spanStartCol = 27, spanEndLine = 225, spanEndCol = 32}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "fnStr"}]}]) (CCase (CApp (CVar "Lune.System.Linux.Proc.parseHexInt") (CVar "domainStr")) [CoreAlt (PCon "Lune.Prelude.Err" [Located {locSpan = Span {spanStartLine = 227, spanStartCol = 21, spanEndLine = 227, spanEndCol = 25}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "msg"}]) (CApp (CVar "Lune.Prelude.Err") (CVar "msg")),CoreAlt (PCon "Lune.Prelude.Ok" [Located {locSpan = Span {spanStartLine = 229, spanStartCol = 20, spanEndLine = 229, spanEndCol = 27}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "domain"}]) (CCase (CApp (CVar "Lune.System.Linux.Proc.parseHexInt") (CVar "busStr")) [CoreAlt (PCon "Lune.Prelude.Err" [Located {locSpan = Span {spanStartLine = 231, spanStartCol = 25, spanEndLine = 231, spanEndCol = 29}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "msg"}]) (CApp (CVar "Lune.Prelude.Err") (CVar "msg")),CoreAlt (PCon "Lune.Prelude.Ok" [Located {locSpan = Span {spanStartLine = 233, spanStartCol = 24, spanEndLine = 233, spanEndCol = 28}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "bus"}]) (CCase (CApp (CVar "Lune.System.Linux.Proc.parseHexInt") (CVar "devStr")) [CoreAlt (PCon "Lune.Prelude.Err" [Located {locSpan = Span {spanStartLine = 235, spanStartCol = 29, spanEndLine = 235, spanEndCol = 33}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "msg"}]) (CApp (CVar "Lune.Prelude.Err") (CVar "msg")),CoreAlt (PCon "Lune.Prelude.Ok" [Located {locSpan = Span {spanStartLine = 237, spanStartCol = 28, spanEndLine = 237, spanEndCol = 35}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "device"}]) (CCase (CApp (CVar "Lune.System.Linux.Proc.parseInt") (CVar "fnStr")) [CoreAlt (PCon "Lune.Prelude.Err" [Located {locSpan = Span {spanStartLine = 239, spanStartCol = 33, spanEndLine = 239, spanEndCol = 37}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "msg"}]) (CApp (CVar "Lune.Prelude.Err") (CApp (CApp (CVar "Lune.String.append") (CString "parse:")) (CVar "msg"))),CoreAlt (PCon "Lune.Prelude.Ok" [Located {locSpan = Span {spanStartLine = 241, spanStartCol = 32, spanEndLine = 241, spanEndCol = 35}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "fn"}]) (CApp (CVar "Lune.Prelude.Ok") (CRecord [("domain",CVar "domain"),("bus",CVar "bus"),("device",CVar "device"),("function",CVar "fn")]))])])])])])])])),CoreDecl "" (CInt 0),CoreDecl "Lune.System.Linux.Cpu.cpuInfo" (CApp (CApp (CSelect (CVar "$dictMonad_Task") "andThen") (CApp (CVar "Lune.System.Linux.Proc.readFile") (CString "/proc/cpuinfo"))) (CLam [PVar "contents"] (CApp (CVar "Lune.Task.succeed") (CApp (CVar "Lune.System.Linux.Cpu.cpuInfoFromCpuinfo") (CVar "contents"))))),CoreDecl "" (CInt 0),CoreDecl "Lune.System.Linux.Cpu.cpuInfoFromCpuinfo" (CLam [PVar "contents"] (CLet "blocks" (CApp (CVar "Lune.System.Linux.Cpu.splitBlocks") (CApp (CVar "Lune.String.lines") (CVar "contents"))) (CLet "logicalCores" (CApp (CVar "Lune.List.length") (CVar "blocks")) (CLet "kvBlocks" (CApp (CApp (CVar "Lune.List.map") (CVar "Lune.System.Linux.Cpu.parseBlock")) (CVar "blocks")) (CLet "firstBlock" (CCase (CVar "kvBlocks") [CoreAlt (PCon "Lune.Prelude.Nil" []) (CVar "Lune.Prelude.Nil"),CoreAlt (PCon "Lune.Prelude.Cons" [Located {locSpan = Span {spanStartLine = 53, spanStartCol = 14, spanEndLine = 53, spanEndCol = 16}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "b"},Located {locSpan = Span {spanStartLine = 53, spanStartCol = 16, spanEndLine = 53, spanEndCol = 18}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PWildcard}]) (CVar "b")]) (CLet "model" (CApp (CApp (CVar "Lune.System.Linux.Cpu.firstOfKeys") (CApp (CApp (CVar "Lune.Prelude.Cons") (CString "model name")) (CApp (CApp (CVar "Lune.Prelude.Cons") (CString "hardware")) (CApp (CApp (CVar "Lune.Prelude.Cons") (CString "processor")) (CVar "Lune.Prelude.Nil"))))) (CVar "firstBlock")) (CLet "vendor" (CApp (CApp (CVar "Lune.System.Linux.Cpu.firstOfKeys") (CApp (CApp (CVar "Lune.Prelude.Cons") (CString "vendor_id")) (CApp (CApp (CVar "Lune.Prelude.Cons") (CString "cpu implementer")) (CVar "Lune.Prelude.Nil")))) (CVar "firstBlock")) (CLet "flagsStr" (CApp (CApp (CVar "Lune.System.Linux.Cpu.firstOfKeys") (CApp (CApp (CVar "Lune.Prelude.Cons") (CString "flags")) (CApp (CApp (CVar "Lune.Prelude.Cons") (CString "features")) (CVar "Lune.Prelude.Nil")))) (CVar "firstBlock")) (CLet "flags" (CCase (CVar "flagsStr") [CoreAlt (PCon "Lune.Prelude.Nothing" []) (CVar "Lune.Prelude.Nil"),CoreAlt (PCon "Lune.Prelude.Just" [Located {locSpan = Span {spanStartLine = 62, spanStartCol = 14, spanEndLine = 62, spanEndCol = 16}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "s"}]) (CApp (CVar "Lune.String.words") (CVar "s"))]) (CLet "mhz" (CCase (CApp (CApp (CVar "Lune.System.Linux.Cpu.firstOfKeys") (CApp (CApp (CVar "Lune.Prelude.Cons") (CString "cpu mhz")) (CApp (CApp (CVar "Lune.Prelude.Cons") (CString "clock")) (CApp (CApp (CVar "Lune.Prelude.Cons") (CString "bogomips")) (CVar "Lune.Prelude.Nil"))))) (CApp (CVar "Lune.System.Linux.Cpu.lowerKeys") (CVar "firstBlock"))) [CoreAlt (PCon "Lune.Prelude.Nothing" []) (CCase (CApp (CApp (CVar "Lune.System.Linux.Cpu.firstOfKeys") (CApp (CApp (CVar "Lune.Prelude.Cons") (CString "cpu mhz")) (CVar "Lune.Prelude.Nil"))) (CVar "firstBlock")) [CoreAlt (PCon "Lune.Prelude.Nothing" []) (CApp (CApp (CVar "Lune.System.Linux.Cpu.mhzFromField") (CString "cpu MHz")) (CVar "firstBlock")),CoreAlt (PCon "Lune.Prelude.Just" [Located {locSpan = Span {spanStartLine = 72, spanStartCol = 18, spanEndLine = 72, spanEndCol = 20}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "s"}]) (CApp (CVar "Lune.System.Linux.Cpu.mhzFromString") (CVar "s"))]),CoreAlt (PCon "Lune.Prelude.Just" [Located {locSpan = Span {spanStartLine = 74, spanStartCol = 14, spanEndLine = 74, spanEndCol = 16}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "s"}]) (CApp (CVar "Lune.System.Linux.Cpu.mhzFromString") (CVar "s"))]) (CLet "physicalCores" (CApp (CVar "Lune.System.Linux.Cpu.physicalCoresFromBlocks") (CVar "kvBlocks")) (CRecord [("model",CVar "model"),("vendor",CVar "vendor"),("logicalCores",CVar "logicalCores"),("physicalCores",CVar "physicalCores"),("flags",CVar "flags"),("mhz",CVar "mhz")])))))))))))),CoreDecl "" (CInt 0),CoreDecl "Lune.System.Linux.Cpu.mhzFromField" (CLam [PVar "key",PVar "kvs"] (CCase (CApp (CApp (CVar "Lune.System.Linux.Cpu.findKey") (CVar "key")) (CVar "kvs")) [CoreAlt (PCon "Lune.Prelude.Nothing" []) (CVar "Lune.Prelude.Nothing"),CoreAlt (PCon "Lune.Prelude.Just" [Located {locSpan = Span {spanStartLine = 93, spanStartCol = 10, spanEndLine = 93, spanEndCol = 12}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "v"}]) (CApp (CVar "Lune.System.Linux.Cpu.mhzFromString") (CVar "v"))])),CoreDecl "" (CInt 0),CoreDecl "Lune.System.Linux.Cpu.mhzFromString" (CLam [PVar "s"] (CCase (CApp (CApp (CVar "Lune.System.Linux.Proc.splitOnce") (CString ".")) (CApp (CVar "Lune.String.trim") (CVar "s"))) [CoreAlt (PCon "Lune.Prelude.Nothing" []) (CCase (CApp (CVar "Lune.System.Linux.Proc.parseInt") (CVar "s")) [CoreAlt (PCon "Lune.Prelude.Ok" [Located {locSpan = Span {spanStartLine = 101, spanStartCol = 12, spanEndLine = 101, spanEndCol = 14}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "n"}]) (CApp (CVar "Lune.Prelude.Just") (CVar "n")),CoreAlt (PCon "Lune.Prelude.Err" [Located {locSpan = Span {spanStartLine = 103, spanStartCol = 13, spanEndLine = 103, spanEndCol = 15}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PWildcard}]) (CVar "Lune.Prelude.Nothing")]),CoreAlt (PCon "Lune.Prelude.Just" [Located {locSpan = Span {spanStartLine = 105, spanStartCol = 10, spanEndLine = 105, spanEndCol = 17}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PCon "Lune.Prelude.Pair" [Located {locSpan = Span {spanStartLine = 105, spanStartCol = 11, spanEndLine = 105, spanEndCol = 12}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "a"},Located {locSpan = Span {spanStartLine = 105, spanStartCol = 14, spanEndLine = 105, spanEndCol = 15}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PWildcard}]}]) (CCase (CApp (CVar "Lune.System.Linux.Proc.parseInt") (CVar "a")) [CoreAlt (PCon "Lune.Prelude.Ok" [Located {locSpan = Span {spanStartLine = 107, spanStartCol = 12, spanEndLine = 107, spanEndCol = 14}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "n"}]) (CApp (CVar "Lune.Prelude.Just") (CVar "n")),CoreAlt (PCon "Lune.Prelude.Err" [Located {locSpan = Span {spanStartLine = 109, spanStartCol = 13, spanEndLine = 109, spanEndCol = 15}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PWildcard}]) (CVar "Lune.Prelude.Nothing")])])),CoreDecl "" (CInt 0),CoreDecl "Lune.System.Linux.Cpu.physicalCoresFromBlocks" (CLam [PVar "kvBlocks"] (CLet "pairs" (CApp (CVar "Lune.System.Linux.Cpu.collectPhysCorePairs") (CVar "kvBlocks")) (CLet "uniqueCount" (CApp (CVar "Lune.System.Linux.Cpu.uniquePairCount") (CVar "pairs")) (CCase (CApp (CApp (CVar "Lune.Int.lte") (CVar "uniqueCount")) (CInt 0)) [CoreAlt (PCon "Lune.Prelude.True" []) (CCase (CVar "kvBlocks") [CoreAlt (PCon "Lune.Prelude.Nil" []) (CVar "Lune.Prelude.Nothing"),CoreAlt (PCon "Lune.Prelude.Cons" [Located {locSpan = Span {spanStartLine = 126, spanStartCol = 16, spanEndLine = 126, spanEndCol = 22}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "first"},Located {locSpan = Span {spanStartLine = 126, spanStartCol = 22, spanEndLine = 126, spanEndCol = 24}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PWildcard}]) (CCase (CApp (CApp (CVar "Lune.System.Linux.Cpu.findKey") (CString "cpu cores")) (CVar "first")) [CoreAlt (PCon "Lune.Prelude.Nothing" []) (CVar "Lune.Prelude.Nothing"),CoreAlt (PCon "Lune.Prelude.Just" [Located {locSpan = Span {spanStartLine = 130, spanStartCol = 20, spanEndLine = 130, spanEndCol = 22}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "s"}]) (CCase (CApp (CVar "Lune.System.Linux.Proc.parseInt") (CVar "s")) [CoreAlt (PCon "Lune.Prelude.Ok" [Located {locSpan = Span {spanStartLine = 132, spanStartCol = 22, spanEndLine = 132, spanEndCol = 24}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "n"}]) (CApp (CVar "Lune.Prelude.Just") (CVar "n")),CoreAlt (PCon "Lune.Prelude.Err" [Located {locSpan = Span {spanStartLine = 134, spanStartCol = 23, spanEndLine = 134, spanEndCol = 25}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PWildcard}]) (CVar "Lune.Prelude.Nothing")])])]),CoreAlt (PCon "Lune.Prelude.False" []) (CApp (CVar "Lune.Prelude.Just") (CVar "uniqueCount"))])))),CoreDecl "" (CInt 0),CoreDecl "Lune.System.Linux.Cpu.collectPhysCorePairs" (CLam [PVar "kvBlocks"] (CCase (CVar "kvBlocks") [CoreAlt (PCon "Lune.Prelude.Nil" []) (CVar "Lune.Prelude.Nil"),CoreAlt (PCon "Lune.Prelude.Cons" [Located {locSpan = Span {spanStartLine = 150, spanStartCol = 10, spanEndLine = 150, spanEndCol = 14}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "kvs"},Located {locSpan = Span {spanStartLine = 150, spanStartCol = 14, spanEndLine = 150, spanEndCol = 19}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "rest"}]) (CCase (CApp (CVar "Lune.System.Linux.Cpu.pairFromBlock") (CVar "kvs")) [CoreAlt (PCon "Lune.Prelude.Nothing" []) (CApp (CVar "Lune.System.Linux.Cpu.collectPhysCorePairs") (CVar "rest")),CoreAlt (PCon "Lune.Prelude.Just" [Located {locSpan = Span {spanStartLine = 154, spanStartCol = 14, spanEndLine = 154, spanEndCol = 16}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "p"}]) (CApp (CApp (CVar "Lune.Prelude.Cons") (CVar "p")) (CApp (CVar "Lune.System.Linux.Cpu.collectPhysCorePairs") (CVar "rest")))])])),CoreDecl "" (CInt 0),CoreDecl "Lune.System.Linux.Cpu.pairFromBlock" (CLam [PVar "kvs"] (CCase (CApp (CApp (CVar "Lune.System.Linux.Cpu.findKey") (CString "physical id")) (CVar "kvs")) [CoreAlt (PCon "Lune.Prelude.Nothing" []) (CVar "Lune.Prelude.Nothing"),CoreAlt (PCon "Lune.Prelude.Just" [Located {locSpan = Span {spanStartLine = 167, spanStartCol = 10, spanEndLine = 167, spanEndCol = 18}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "physStr"}]) (CCase (CApp (CApp (CVar "Lune.System.Linux.Cpu.findKey") (CString "core id")) (CVar "kvs")) [CoreAlt (PCon "Lune.Prelude.Nothing" []) (CVar "Lune.Prelude.Nothing"),CoreAlt (PCon "Lune.Prelude.Just" [Located {locSpan = Span {spanStartLine = 171, spanStartCol = 14, spanEndLine = 171, spanEndCol = 22}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "coreStr"}]) (CCase (CApp (CVar "Lune.System.Linux.Proc.parseInt") (CVar "physStr")) [CoreAlt (PCon "Lune.Prelude.Err" [Located {locSpan = Span {spanStartLine = 173, spanStartCol = 17, spanEndLine = 173, spanEndCol = 19}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PWildcard}]) (CVar "Lune.Prelude.Nothing"),CoreAlt (PCon "Lune.Prelude.Ok" [Located {locSpan = Span {spanStartLine = 175, spanStartCol = 16, spanEndLine = 175, spanEndCol = 21}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "phys"}]) (CCase (CApp (CVar "Lune.System.Linux.Proc.parseInt") (CVar "coreStr")) [CoreAlt (PCon "Lune.Prelude.Err" [Located {locSpan = Span {spanStartLine = 177, spanStartCol = 21, spanEndLine = 177, spanEndCol = 23}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PWildcard}]) (CVar "Lune.Prelude.Nothing"),CoreAlt (PCon "Lune.Prelude.Ok" [Located {locSpan = Span {spanStartLine = 179, spanStartCol = 20, spanEndLine = 179, spanEndCol = 25}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "core"}]) (CApp (CVar "Lune.Prelude.Just") (CRecord [("phys",CVar "phys"),("core",CVar "core")]))])])])])),CoreDecl "" (CInt 0),CoreDecl "Lune.System.Linux.Cpu.uniquePairCount" (CLam [PVar "pairs"] (CApp (CVar "Lune.List.length") (CApp (CApp (CVar "Lune.System.Linux.Cpu.uniquePairs") (CVar "pairs")) (CVar "Lune.Prelude.Nil")))),CoreDecl "" (CInt 0),CoreDecl "Lune.System.Linux.Cpu.uniquePairs" (CLam [PVar "remaining",PVar "seen"] (CCase (CVar "remaining") [CoreAlt (PCon "Lune.Prelude.Nil" []) (CVar "seen"),CoreAlt (PCon "Lune.Prelude.Cons" [Located {locSpan = Span {spanStartLine = 202, spanStartCol = 10, spanEndLine = 202, spanEndCol = 12}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "p"},Located {locSpan = Span {spanStartLine = 202, spanStartCol = 12, spanEndLine = 202, spanEndCol = 17}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "rest"}]) (CCase (CApp (CApp (CVar "Lune.System.Linux.Cpu.hasPair") (CVar "p")) (CVar "seen")) [CoreAlt (PCon "Lune.Prelude.True" []) (CApp (CApp (CVar "Lune.System.Linux.Cpu.uniquePairs") (CVar "rest")) (CVar "seen")),CoreAlt (PCon "Lune.Prelude.False" []) (CApp (CApp (CVar "Lune.System.Linux.Cpu.uniquePairs") (CVar "rest")) (CApp (CApp (CVar "Lune.Prelude.Cons") (CVar "p")) (CVar "seen")))])])),CoreDecl "" (CInt 0),CoreDecl "Lune.System.Linux.Cpu.hasPair" (CLam [PVar "p",PVar "ps"] (CCase (CVar "ps") [CoreAlt (PCon "Lune.Prelude.Nil" []) (CVar "Lune.Prelude.False"),CoreAlt (PCon "Lune.Prelude.Cons" [Located {locSpan = Span {spanStartLine = 218, spanStartCol = 10, spanEndLine = 218, spanEndCol = 12}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "q"},Located {locSpan = Span {spanStartLine = 218, spanStartCol = 12, spanEndLine = 218, spanEndCol = 17}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "rest"}]) (CCase (CApp (CApp (CVar "Lune.Int.eq") (CSelect (CVar "p") "phys")) (CSelect (CVar "q") "phys")) [CoreAlt (PCon "Lune.Prelude.True" []) (CCase (CApp (CApp (CVar "Lune.Int.eq") (CSelect (CVar "p") "core")) (CSelect (CVar "q") "core")) [CoreAlt (PCon "Lune.Prelude.True" []) (CVar "Lune.Prelude.True"),CoreAlt (PCon "Lune.Prelude.False" []) (CApp (CApp (CVar "Lune.System.Linux.Cpu.hasPair") (CVar "p")) (CVar "rest"))]),CoreAlt (PCon "Lune.Prelude.False" []) (CApp (CApp (CVar "Lune.System.Linux.Cpu.hasPair") (CVar "p")) (CVar "rest"))])])),CoreDecl "" (CInt 0),CoreDecl "Lune.System.Linux.Cpu.lowerKeys" (CLam [PVar "kvs"] (CApp (CApp (CVar "Lune.List.map") (CLam [PVar "kv"] (CRecord [("key",CApp (CVar "Lune.String.toLower") (CSelect (CVar "kv") "key")),("value",CSelect (CVar "kv") "value")]))) (CVar "kvs"))),CoreDecl "" (CInt 0),CoreDecl "Lune.System.Linux.Cpu.firstOfKeys" (CLam [PVar "keys",PVar "kvs"] (CCase (CVar "keys") [CoreAlt (PCon "Lune.Prelude.Nil" []) (CVar "Lune.Prelude.Nothing"),CoreAlt (PCon "Lune.Prelude.Cons" [Located {locSpan = Span {spanStartLine = 246, spanStartCol = 10, spanEndLine = 246, spanEndCol = 12}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "k"},Located {locSpan = Span {spanStartLine = 246, spanStartCol = 12, spanEndLine = 246, spanEndCol = 17}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "rest"}]) (CCase (CApp (CApp (CVar "Lune.System.Linux.Cpu.findKey") (CVar "k")) (CVar "kvs")) [CoreAlt (PCon "Lune.Prelude.Just" [Located {locSpan = Span {spanStartLine = 248, spanStartCol = 14, spanEndLine = 248, spanEndCol = 16}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "v"}]) (CApp (CVar "Lune.Prelude.Just") (CVar "v")),CoreAlt (PCon "Lune.Prelude.Nothing" []) (CApp (CApp (CVar "Lune.System.Linux.Cpu.firstOfKeys") (CVar "rest")) (CVar "kvs"))])])),CoreDecl "" (CInt 0),CoreDecl "Lune.System.Linux.Cpu.findKey" (CLam [PVar "key",PVar "kvs"] (CCase (CVar "kvs") [CoreAlt (PCon "Lune.Prelude.Nil" []) (CVar "Lune.Prelude.Nothing"),CoreAlt (PCon "Lune.Prelude.Cons" [Located {locSpan = Span {spanStartLine = 260, spanStartCol = 10, spanEndLine = 260, spanEndCol = 13}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "kv"},Located {locSpan = Span {spanStartLine = 260, spanStartCol = 13, spanEndLine = 260, spanEndCol = 18}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "rest"}]) (CCase (CApp (CApp (CVar "Lune.String.eq") (CSelect (CVar "kv") "key")) (CVar "key")) [CoreAlt (PCon "Lune.Prelude.True" []) (CApp (CVar "Lune.Prelude.Just") (CSelect (CVar "kv") "value")),CoreAlt (PCon "Lune.Prelude.False" []) (CApp (CApp (CVar "Lune.System.Linux.Cpu.findKey") (CVar "key")) (CVar "rest"))])])),CoreDecl "" (CInt 0),CoreDecl "Lune.System.Linux.Cpu.parseBlock" (CLam [PVar "lines"] (CCase (CVar "lines") [CoreAlt (PCon "Lune.Prelude.Nil" []) (CVar "Lune.Prelude.Nil"),CoreAlt (PCon "Lune.Prelude.Cons" [Located {locSpan = Span {spanStartLine = 274, spanStartCol = 10, spanEndLine = 274, spanEndCol = 12}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "l"},Located {locSpan = Span {spanStartLine = 274, spanStartCol = 12, spanEndLine = 274, spanEndCol = 17}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "rest"}]) (CCase (CApp (CVar "Lune.System.Linux.Proc.parseKeyValueLine") (CVar "l")) [CoreAlt (PCon "Lune.Prelude.Nothing" []) (CApp (CVar "Lune.System.Linux.Cpu.parseBlock") (CVar "rest")),CoreAlt (PCon "Lune.Prelude.Just" [Located {locSpan = Span {spanStartLine = 278, spanStartCol = 14, spanEndLine = 278, spanEndCol = 17}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "kv"}]) (CApp (CApp (CVar "Lune.Prelude.Cons") (CVar "kv")) (CApp (CVar "Lune.System.Linux.Cpu.parseBlock") (CVar "rest")))])])),CoreDecl "" (CInt 0),CoreDecl "Lune.System.Linux.Cpu.splitBlocks" (CLam [PVar "lines"] (CApp (CApp (CApp (CVar "Lune.System.Linux.Cpu.splitBlocksHelp") (CVar "lines")) (CVar "Lune.Prelude.Nil")) (CVar "Lune.Prelude.Nil"))),CoreDecl "" (CInt 0),CoreDecl "Lune.System.Linux.Cpu.splitBlocksHelp" (CLam [PVar "remaining",PVar "currentRev",PVar "blocksRev"] (CCase (CVar "remaining") [CoreAlt (PCon "Lune.Prelude.Nil" []) (CCase (CVar "currentRev") [CoreAlt (PCon "Lune.Prelude.Nil" []) (CApp (CVar "Lune.List.reverse") (CVar "blocksRev")),CoreAlt PWildcard (CApp (CVar "Lune.List.reverse") (CApp (CApp (CVar "Lune.Prelude.Cons") (CApp (CVar "Lune.List.reverse") (CVar "currentRev"))) (CVar "blocksRev")))]),CoreAlt (PCon "Lune.Prelude.Cons" [Located {locSpan = Span {spanStartLine = 294, spanStartCol = 10, spanEndLine = 294, spanEndCol = 15}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "line"},Located {locSpan = Span {spanStartLine = 294, spanStartCol = 15, spanEndLine = 294, spanEndCol = 20}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "rest"}]) (CCase (CApp (CVar "Lune.String.isEmpty") (CApp (CVar "Lune.String.trim") (CVar "line"))) [CoreAlt (PCon "Lune.Prelude.True" []) (CCase (CVar "currentRev") [CoreAlt (PCon "Lune.Prelude.Nil" []) (CApp (CApp (CApp (CVar "Lune.System.Linux.Cpu.splitBlocksHelp") (CVar "rest")) (CVar "Lune.Prelude.Nil")) (CVar "blocksRev")),CoreAlt PWildcard (CApp (CApp (CApp (CVar "Lune.System.Linux.Cpu.splitBlocksHelp") (CVar "rest")) (CVar "Lune.Prelude.Nil")) (CApp (CApp (CVar "Lune.Prelude.Cons") (CApp (CVar "Lune.List.reverse") (CVar "currentRev"))) (CVar "blocksRev")))]),CoreAlt (PCon "Lune.Prelude.False" []) (CApp (CApp (CApp (CVar "Lune.System.Linux.Cpu.splitBlocksHelp") (CVar "rest")) (CApp (CApp (CVar "Lune.Prelude.Cons") (CVar "line")) (CVar "currentRev"))) (CVar "blocksRev"))])])),CoreDecl "" (CInt 0),CoreDecl "Lune.System.Linux.Cpu.cpuMetrics" (CApp (CApp (CSelect (CVar "$dictMonad_Task") "andThen") (CApp (CVar "Lune.System.Linux.Proc.readFile") (CString "/proc/stat"))) (CLam [PVar "stat"] (CApp (CApp (CSelect (CVar "$dictMonad_Task") "andThen") (CApp (CVar "Lune.System.Linux.Proc.readFileOptional") (CString "/proc/loadavg"))) (CLam [PVar "load"] (CCase (CApp (CVar "Lune.System.Linux.Cpu.parseStat") (CVar "stat")) [CoreAlt (PCon "Lune.Prelude.Err" [Located {locSpan = Span {spanStartLine = 340, spanStartCol = 11, spanEndLine = 340, spanEndCol = 15}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "msg"}]) (CApp (CVar "Lune.Task.fail") (CVar "msg")),CoreAlt (PCon "Lune.Prelude.Ok" [Located {locSpan = Span {spanStartLine = 342, spanStartCol = 10, spanEndLine = 342, spanEndCol = 17}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "parsed"}]) (CApp (CVar "Lune.Task.succeed") (CRecord [("total",CSelect (CVar "parsed") "total"),("cores",CSelect (CVar "parsed") "cores"),("loadAvg1",CApp (CApp (CVar "Lune.System.Linux.Cpu.loadAvgFrom") (CVar "load")) (CInt 0)),("loadAvg5",CApp (CApp (CVar "Lune.System.Linux.Cpu.loadAvgFrom") (CVar "load")) (CInt 1)),("loadAvg15",CApp (CApp (CVar "Lune.System.Linux.Cpu.loadAvgFrom") (CVar "load")) (CInt 2))]))]))))),CoreDecl "" (CInt 0),CoreDecl "Lune.System.Linux.Cpu.loadAvgFrom" (CLam [PVar "maybeLoad",PVar "idx"] (CCase (CVar "maybeLoad") [CoreAlt (PCon "Lune.Prelude.Nothing" []) (CVar "Lune.Prelude.Nothing"),CoreAlt (PCon "Lune.Prelude.Just" [Located {locSpan = Span {spanStartLine = 356, spanStartCol = 10, spanEndLine = 356, spanEndCol = 12}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "s"}]) (CCase (CApp (CApp (CVar "Lune.List.get") (CVar "idx")) (CApp (CVar "Lune.String.words") (CVar "s"))) [CoreAlt (PCon "Lune.Prelude.Nothing" []) (CVar "Lune.Prelude.Nothing"),CoreAlt (PCon "Lune.Prelude.Just" [Located {locSpan = Span {spanStartLine = 360, spanStartCol = 14, spanEndLine = 360, spanEndCol = 20}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "token"}]) (CCase (CApp (CVar "Lune.System.Linux.Proc.parseFloat") (CVar "token")) [CoreAlt (PCon "Lune.Prelude.Ok" [Located {locSpan = Span {spanStartLine = 362, spanStartCol = 16, spanEndLine = 362, spanEndCol = 18}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "f"}]) (CApp (CVar "Lune.Prelude.Just") (CVar "f")),CoreAlt (PCon "Lune.Prelude.Err" [Located {locSpan = Span {spanStartLine = 364, spanStartCol = 17, spanEndLine = 364, spanEndCol = 19}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PWildcard}]) (CVar "Lune.Prelude.Nothing")])])])),CoreDecl "" (CInt 0),CoreDecl "Lune.System.Linux.Cpu.parseStat" (CLam [PVar "contents"] (CApp (CApp (CApp (CVar "Lune.System.Linux.Cpu.parseStatLines") (CApp (CVar "Lune.String.lines") (CVar "contents"))) (CVar "Lune.Prelude.Nothing")) (CVar "Lune.Prelude.Nil"))),CoreDecl "" (CInt 0),CoreDecl "Lune.System.Linux.Cpu.parseStatLines" (CLam [PVar "lines",PVar "maybeTotal",PVar "cores"] (CCase (CVar "lines") [CoreAlt (PCon "Lune.Prelude.Nil" []) (CCase (CVar "maybeTotal") [CoreAlt (PCon "Lune.Prelude.Nothing" []) (CApp (CVar "Lune.Prelude.Err") (CString "parse:/proc/stat: missing cpu line")),CoreAlt (PCon "Lune.Prelude.Just" [Located {locSpan = Span {spanStartLine = 445, spanStartCol = 14, spanEndLine = 445, spanEndCol = 20}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "total"}]) (CApp (CVar "Lune.Prelude.Ok") (CRecord [("total",CVar "total"),("cores",CApp (CApp (CVar "Lune.List.map") (CLam [PVar "c"] (CSelect (CVar "c") "times"))) (CApp (CVar "Lune.System.Linux.Cpu.sortCores") (CVar "cores")))]))]),CoreAlt (PCon "Lune.Prelude.Cons" [Located {locSpan = Span {spanStartLine = 450, spanStartCol = 10, spanEndLine = 450, spanEndCol = 15}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "line"},Located {locSpan = Span {spanStartLine = 450, spanStartCol = 15, spanEndLine = 450, spanEndCol = 20}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "rest"}]) (CCase (CApp (CVar "Lune.String.words") (CVar "line")) [CoreAlt (PCon "Lune.Prelude.Nil" []) (CApp (CApp (CApp (CVar "Lune.System.Linux.Cpu.parseStatLines") (CVar "rest")) (CVar "maybeTotal")) (CVar "cores")),CoreAlt (PCon "Lune.Prelude.Cons" [Located {locSpan = Span {spanStartLine = 454, spanStartCol = 14, spanEndLine = 454, spanEndCol = 20}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "label"},Located {locSpan = Span {spanStartLine = 454, spanStartCol = 20, spanEndLine = 454, spanEndCol = 25}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "nums"}]) (CCase (CApp (CApp (CVar "Lune.String.eq") (CVar "label")) (CString "cpu")) [CoreAlt (PCon "Lune.Prelude.True" []) (CCase (CApp (CVar "Lune.System.Linux.Cpu.parseCpuTimes") (CVar "nums")) [CoreAlt (PCon "Lune.Prelude.Err" [Located {locSpan = Span {spanStartLine = 458, spanStartCol = 21, spanEndLine = 458, spanEndCol = 25}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "msg"}]) (CApp (CVar "Lune.Prelude.Err") (CVar "msg")),CoreAlt (PCon "Lune.Prelude.Ok" [Located {locSpan = Span {spanStartLine = 460, spanStartCol = 20, spanEndLine = 460, spanEndCol = 22}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "t"}]) (CApp (CApp (CApp (CVar "Lune.System.Linux.Cpu.parseStatLines") (CVar "rest")) (CApp (CVar "Lune.Prelude.Just") (CVar "t"))) (CVar "cores"))]),CoreAlt (PCon "Lune.Prelude.False" []) (CCase (CApp (CApp (CVar "Lune.String.startsWith") (CString "cpu")) (CVar "label")) [CoreAlt (PCon "Lune.Prelude.True" []) (CCase (CApp (CVar "Lune.System.Linux.Proc.parseInt") (CApp (CApp (CVar "Lune.String.drop") (CInt 3)) (CVar "label"))) [CoreAlt (PCon "Lune.Prelude.Err" [Located {locSpan = Span {spanStartLine = 466, spanStartCol = 25, spanEndLine = 466, spanEndCol = 27}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PWildcard}]) (CApp (CApp (CApp (CVar "Lune.System.Linux.Cpu.parseStatLines") (CVar "rest")) (CVar "maybeTotal")) (CVar "cores")),CoreAlt (PCon "Lune.Prelude.Ok" [Located {locSpan = Span {spanStartLine = 468, spanStartCol = 24, spanEndLine = 468, spanEndCol = 28}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "idx"}]) (CCase (CApp (CVar "Lune.System.Linux.Cpu.parseCpuTimes") (CVar "nums")) [CoreAlt (PCon "Lune.Prelude.Err" [Located {locSpan = Span {spanStartLine = 470, spanStartCol = 29, spanEndLine = 470, spanEndCol = 33}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "msg"}]) (CApp (CVar "Lune.Prelude.Err") (CVar "msg")),CoreAlt (PCon "Lune.Prelude.Ok" [Located {locSpan = Span {spanStartLine = 472, spanStartCol = 28, spanEndLine = 472, spanEndCol = 30}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "t"}]) (CApp (CApp (CApp (CVar "Lune.System.Linux.Cpu.parseStatLines") (CVar "rest")) (CVar "maybeTotal")) (CApp (CApp (CVar "Lune.Prelude.Cons") (CRecord [("idx",CVar "idx"),("times",CVar "t")])) (CVar "cores")))])]),CoreAlt (PCon "Lune.Prelude.False" []) (CApp (CApp (CApp (CVar "Lune.System.Linux.Cpu.parseStatLines") (CVar "rest")) (CVar "maybeTotal")) (CVar "cores"))])])])])),CoreDecl "" (CInt 0),CoreDecl "Lune.System.Linux.Cpu.parseCpuTimes" (CLam [PVar "nums"] (CCase (CVar "nums") [CoreAlt (PCon "Lune.Prelude.Cons" [Located {locSpan = Span {spanStartLine = 495, spanStartCol = 10, spanEndLine = 495, spanEndCol = 15}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "user"},Located {locSpan = Span {spanStartLine = 495, spanStartCol = 15, spanEndLine = 495, spanEndCol = 94}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PCon "Lune.Prelude.Cons" [Located {locSpan = Span {spanStartLine = 495, spanStartCol = 20, spanEndLine = 495, spanEndCol = 25}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "nice"},Located {locSpan = Span {spanStartLine = 495, spanStartCol = 25, spanEndLine = 495, spanEndCol = 94}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PCon "Lune.Prelude.Cons" [Located {locSpan = Span {spanStartLine = 495, spanStartCol = 30, spanEndLine = 495, spanEndCol = 37}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "system"},Located {locSpan = Span {spanStartLine = 495, spanStartCol = 37, spanEndLine = 495, spanEndCol = 94}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PCon "Lune.Prelude.Cons" [Located {locSpan = Span {spanStartLine = 495, spanStartCol = 42, spanEndLine = 495, spanEndCol = 47}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "idle"},Located {locSpan = Span {spanStartLine = 495, spanStartCol = 47, spanEndLine = 495, spanEndCol = 94}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PCon "Lune.Prelude.Cons" [Located {locSpan = Span {spanStartLine = 495, spanStartCol = 52, spanEndLine = 495, spanEndCol = 59}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "iowait"},Located {locSpan = Span {spanStartLine = 495, spanStartCol = 59, spanEndLine = 495, spanEndCol = 94}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PCon "Lune.Prelude.Cons" [Located {locSpan = Span {spanStartLine = 495, spanStartCol = 64, spanEndLine = 495, spanEndCol = 68}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "irq"},Located {locSpan = Span {spanStartLine = 495, spanStartCol = 68, spanEndLine = 495, spanEndCol = 94}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PCon "Lune.Prelude.Cons" [Located {locSpan = Span {spanStartLine = 495, spanStartCol = 73, spanEndLine = 495, spanEndCol = 81}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "softirq"},Located {locSpan = Span {spanStartLine = 495, spanStartCol = 81, spanEndLine = 495, spanEndCol = 94}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PCon "Lune.Prelude.Cons" [Located {locSpan = Span {spanStartLine = 495, spanStartCol = 86, spanEndLine = 495, spanEndCol = 92}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "steal"},Located {locSpan = Span {spanStartLine = 495, spanStartCol = 92, spanEndLine = 495, spanEndCol = 94}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PWildcard}]}]}]}]}]}]}]}]) (CCase (CApp (CVar "Lune.System.Linux.Proc.parseInt") (CVar "user")) [CoreAlt (PCon "Lune.Prelude.Err" [Located {locSpan = Span {spanStartLine = 497, spanStartCol = 13, spanEndLine = 497, spanEndCol = 17}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "msg"}]) (CApp (CVar "Lune.Prelude.Err") (CApp (CApp (CVar "Lune.String.append") (CString "parse:")) (CVar "msg"))),CoreAlt (PCon "Lune.Prelude.Ok" [Located {locSpan = Span {spanStartLine = 499, spanStartCol = 12, spanEndLine = 499, spanEndCol = 14}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "u"}]) (CCase (CApp (CVar "Lune.System.Linux.Proc.parseInt") (CVar "nice")) [CoreAlt (PCon "Lune.Prelude.Err" [Located {locSpan = Span {spanStartLine = 501, spanStartCol = 17, spanEndLine = 501, spanEndCol = 21}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "msg"}]) (CApp (CVar "Lune.Prelude.Err") (CApp (CApp (CVar "Lune.String.append") (CString "parse:")) (CVar "msg"))),CoreAlt (PCon "Lune.Prelude.Ok" [Located {locSpan = Span {spanStartLine = 503, spanStartCol = 16, spanEndLine = 503, spanEndCol = 18}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "n"}]) (CCase (CApp (CVar "Lune.System.Linux.Proc.parseInt") (CVar "system")) [CoreAlt (PCon "Lune.Prelude.Err" [Located {locSpan = Span {spanStartLine = 505, spanStartCol = 21, spanEndLine = 505, spanEndCol = 25}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "msg"}]) (CApp (CVar "Lune.Prelude.Err") (CApp (CApp (CVar "Lune.String.append") (CString "parse:")) (CVar "msg"))),CoreAlt (PCon "Lune.Prelude.Ok" [Located {locSpan = Span {spanStartLine = 507, spanStartCol = 20, spanEndLine = 507, spanEndCol = 22}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "s"}]) (CCase (CApp (CVar "Lune.System.Linux.Proc.parseInt") (CVar "idle")) [CoreAlt (PCon "Lune.Prelude.Err" [Located {locSpan = Span {spanStartLine = 509, spanStartCol = 25, spanEndLine = 509, spanEndCol = 29}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "msg"}]) (CApp (CVar "Lune.Prelude.Err") (CApp (CApp (CVar "Lune.String.append") (CString "parse:")) (CVar "msg"))),CoreAlt (PCon "Lune.Prelude.Ok" [Located {locSpan = Span {spanStartLine = 511, spanStartCol = 24, spanEndLine = 511, spanEndCol = 26}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "i"}]) (CCase (CApp (CVar "Lune.System.Linux.Proc.parseInt") (CVar "iowait")) [CoreAlt (PCon "Lune.Prelude.Err" [Located {locSpan = Span {spanStartLine = 513, spanStartCol = 29, spanEndLine = 513, spanEndCol = 33}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "msg"}]) (CApp (CVar "Lune.Prelude.Err") (CApp (CApp (CVar "Lune.String.append") (CString "parse:")) (CVar "msg"))),CoreAlt (PCon "Lune.Prelude.Ok" [Located {locSpan = Span {spanStartLine = 515, spanStartCol = 28, spanEndLine = 515, spanEndCol = 31}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "iw"}]) (CCase (CApp (CVar "Lune.System.Linux.Proc.parseInt") (CVar "irq")) [CoreAlt (PCon "Lune.Prelude.Err" [Located {locSpan = Span {spanStartLine = 517, spanStartCol = 33, spanEndLine = 517, spanEndCol = 37}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "msg"}]) (CApp (CVar "Lune.Prelude.Err") (CApp (CApp (CVar "Lune.String.append") (CString "parse:")) (CVar "msg"))),CoreAlt (PCon "Lune.Prelude.Ok" [Located {locSpan = Span {spanStartLine = 519, spanStartCol = 32, spanEndLine = 519, spanEndCol = 35}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "ir"}]) (CCase (CApp (CVar "Lune.System.Linux.Proc.parseInt") (CVar "softirq")) [CoreAlt (PCon "Lune.Prelude.Err" [Located {locSpan = Span {spanStartLine = 521, spanStartCol = 37, spanEndLine = 521, spanEndCol = 41}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "msg"}]) (CApp (CVar "Lune.Prelude.Err") (CApp (CApp (CVar "Lune.String.append") (CString "parse:")) (CVar "msg"))),CoreAlt (PCon "Lune.Prelude.Ok" [Located {locSpan = Span {spanStartLine = 523, spanStartCol = 36, spanEndLine = 523, spanEndCol = 39}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "si"}]) (CCase (CApp (CVar "Lune.System.Linux.Proc.parseInt") (CVar "steal")) [CoreAlt (PCon "Lune.Prelude.Err" [Located {locSpan = Span {spanStartLine = 525, spanStartCol = 41, spanEndLine = 525, spanEndCol = 45}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "msg"}]) (CApp (CVar "Lune.Prelude.Err") (CApp (CApp (CVar "Lune.String.append") (CString "parse:")) (CVar "msg"))),CoreAlt (PCon "Lune.Prelude.Ok" [Located {locSpan = Span {spanStartLine = 527, spanStartCol = 40, spanEndLine = 527, spanEndCol = 43}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "st"}]) (CApp (CVar "Lune.Prelude.Ok") (CRecord [("user",CVar "u"),("nice",CVar "n"),("system",CVar "s"),("idle",CVar "i"),("iowait",CVar "iw"),("irq",CVar "ir"),("softirq",CVar "si"),("steal",CVar "st")]))])])])])])])])]),CoreAlt PWildcard (CApp (CVar "Lune.Prelude.Err") (CString "parse:/proc/stat: expected 8 cpu fields"))])),CoreDecl "" (CInt 0),CoreDecl "Lune.System.Linux.Cpu.sortCores" (CLam [PVar "cores"] (CApp (CApp (CApp (CVar "Lune.List.foldl") (CVar "Lune.System.Linux.Cpu.insertCore")) (CVar "Lune.Prelude.Nil")) (CVar "cores"))),CoreDecl "" (CInt 0),CoreDecl "Lune.System.Linux.Cpu.insertCore" (CLam [PVar "sorted",PVar "c"] (CCase (CVar "sorted") [CoreAlt (PCon "Lune.Prelude.Nil" []) (CApp (CApp (CVar "Lune.Prelude.Cons") (CVar "c")) (CVar "Lune.Prelude.Nil")),CoreAlt (PCon "Lune.Prelude.Cons" [Located {locSpan = Span {spanStartLine = 562, spanStartCol = 10, spanEndLine = 562, spanEndCol = 12}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "x"},Located {locSpan = Span {spanStartLine = 562, spanStartCol = 12, spanEndLine = 562, spanEndCol = 17}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "rest"}]) (CCase (CApp (CApp (CVar "Lune.Int.lte") (CSelect (CVar "c") "idx")) (CSelect (CVar "x") "idx")) [CoreAlt (PCon "Lune.Prelude.True" []) (CApp (CApp (CVar "Lune.Prelude.Cons") (CVar "c")) (CVar "sorted")),CoreAlt (PCon "Lune.Prelude.False" []) (CApp (CApp (CVar "Lune.Prelude.Cons") (CVar "x")) (CApp (CApp (CVar "Lune.System.Linux.Cpu.insertCore") (CVar "rest")) (CVar "c")))])])),CoreDecl "" (CInt 0),CoreDecl "Lune.System.Linux.Sysfs.readOptional" (CVar "Lune.System.Linux.Proc.readFileOptional"),CoreDecl "" (CInt 0),CoreDecl "Lune.System.Linux.Sysfs.readIntOptional" (CVar "Lune.System.Linux.Proc.readIntFileOptional"),CoreDecl "" (CInt 0),CoreDecl "Lune.System.Linux.Sysfs.readHexIntOptional" (CLam [PVar "path"] (CApp (CApp (CVar "Lune.Task.map") (CLam [PVar "ms"] (CCase (CVar "ms") [CoreAlt (PCon "Lune.Prelude.Nothing" []) (CVar "Lune.Prelude.Nothing"),CoreAlt (PCon "Lune.Prelude.Just" [Located {locSpan = Span {spanStartLine = 24, spanStartCol = 14, spanEndLine = 24, spanEndCol = 16}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "s"}]) (CCase (CApp (CVar "Lune.System.Linux.Proc.parseHexInt") (CVar "s")) [CoreAlt (PCon "Lune.Prelude.Ok" [Located {locSpan = Span {spanStartLine = 26, spanStartCol = 16, spanEndLine = 26, spanEndCol = 18}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "n"}]) (CApp (CVar "Lune.Prelude.Just") (CVar "n")),CoreAlt (PCon "Lune.Prelude.Err" [Located {locSpan = Span {spanStartLine = 28, spanStartCol = 17, spanEndLine = 28, spanEndCol = 19}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PWildcard}]) (CVar "Lune.Prelude.Nothing")])]))) (CApp (CVar "Lune.System.Linux.Proc.readFileOptional") (CVar "path")))),CoreDecl "" (CInt 0),CoreDecl "Lune.System.Linux.Disk.disks" (CApp (CApp (CSelect (CVar "$dictMonad_Task") "andThen") (CApp (CVar "Lune.System.Linux.Proc.readFile") (CString "/proc/diskstats"))) (CLam [PVar "contents"] (CLet "names" (CApp (CApp (CVar "Lune.System.Linux.Disk.uniqueStrings") (CApp (CVar "Lune.System.Linux.Disk.diskNamesFromDiskstats") (CVar "contents"))) (CVar "Lune.Prelude.Nil")) (CApp (CVar "Lune.System.Linux.Disk.gatherDiskInfos") (CVar "names"))))),CoreDecl "" (CInt 0),CoreDecl "Lune.System.Linux.Disk.mounts" (CApp (CApp (CSelect (CVar "$dictMonad_Task") "andThen") (CApp (CVar "Lune.System.Linux.Proc.readFile") (CString "/proc/mounts"))) (CLam [PVar "contents"] (CApp (CVar "Lune.Task.succeed") (CApp (CVar "Lune.System.Linux.Disk.parseMounts") (CVar "contents"))))),CoreDecl "" (CInt 0),CoreDecl "Lune.System.Linux.Disk.diskMetrics" (CApp (CApp (CSelect (CVar "$dictMonad_Task") "andThen") (CApp (CVar "Lune.System.Linux.Proc.readFile") (CString "/proc/diskstats"))) (CLam [PVar "contents"] (CLet "devs" (CApp (CVar "Lune.System.Linux.Disk.parseDiskstatsDevices") (CVar "contents")) (CApp (CApp (CSelect (CVar "$dictMonad_Task") "andThen") (CApp (CVar "Lune.System.Linux.Disk.keepBlockDevices") (CVar "devs"))) (CLam [PVar "filtered"] (CApp (CVar "Lune.Task.succeed") (CRecord [("devices",CVar "filtered")]))))))),CoreDecl "" (CInt 0),CoreDecl "Lune.System.Linux.Disk.gatherDiskInfos" (CLam [PVar "names"] (CCase (CVar "names") [CoreAlt (PCon "Lune.Prelude.Nil" []) (CApp (CVar "Lune.Task.succeed") (CVar "Lune.Prelude.Nil")),CoreAlt (PCon "Lune.Prelude.Cons" [Located {locSpan = Span {spanStartLine = 74, spanStartCol = 10, spanEndLine = 74, spanEndCol = 15}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "name"},Located {locSpan = Span {spanStartLine = 74, spanStartCol = 15, spanEndLine = 74, spanEndCol = 20}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "rest"}]) (CApp (CApp (CSelect (CVar "$dictMonad_Task") "andThen") (CApp (CVar "Lune.System.Linux.Sysfs.readIntOptional") (CApp (CVar "Lune.System.Linux.Disk.sysfsBlockSizePath") (CVar "name")))) (CLam [PVar "sizeSectors"] (CCase (CVar "sizeSectors") [CoreAlt (PCon "Lune.Prelude.Nothing" []) (CApp (CVar "Lune.System.Linux.Disk.gatherDiskInfos") (CVar "rest")),CoreAlt (PCon "Lune.Prelude.Just" [Located {locSpan = Span {spanStartLine = 80, spanStartCol = 16, spanEndLine = 80, spanEndCol = 24}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "sectors"}]) (CApp (CApp (CSelect (CVar "$dictMonad_Task") "andThen") (CApp (CVar "Lune.System.Linux.Sysfs.readOptional") (CApp (CVar "Lune.System.Linux.Disk.sysfsBlockModelPath") (CVar "name")))) (CLam [PVar "model"] (CLet "sizeBytes" (CApp (CVar "Lune.Prelude.Just") (CApp (CApp (CVar "Lune.Int.mul") (CVar "sectors")) (CInt 512))) (CApp (CApp (CSelect (CVar "$dictMonad_Task") "andThen") (CApp (CVar "Lune.System.Linux.Disk.gatherDiskInfos") (CVar "rest"))) (CLam [PVar "infos"] (CApp (CVar "Lune.Task.succeed") (CApp (CApp (CVar "Lune.Prelude.Cons") (CRecord [("name",CVar "name"),("model",CVar "model"),("sizeBytes",CVar "sizeBytes")])) (CVar "infos"))))))))])))])),CoreDecl "" (CInt 0),CoreDecl "Lune.System.Linux.Disk.sysfsBlockSizePath" (CLam [PVar "name"] (CApp (CApp (CVar "Lune.String.append") (CString "/sys/block/")) (CApp (CApp (CVar "Lune.String.append") (CVar "name")) (CString "/size")))),CoreDecl "" (CInt 0),CoreDecl "Lune.System.Linux.Disk.sysfsBlockModelPath" (CLam [PVar "name"] (CApp (CApp (CVar "Lune.String.append") (CString "/sys/block/")) (CApp (CApp (CVar "Lune.String.append") (CVar "name")) (CString "/device/model")))),CoreDecl "" (CInt 0),CoreDecl "Lune.System.Linux.Disk.diskNamesFromDiskstats" (CLam [PVar "contents"] (CApp (CVar "Lune.System.Linux.Disk.diskNamesFromLines") (CApp (CVar "Lune.String.lines") (CVar "contents")))),CoreDecl "" (CInt 0),CoreDecl "Lune.System.Linux.Disk.diskNamesFromLines" (CLam [PVar "lines"] (CCase (CVar "lines") [CoreAlt (PCon "Lune.Prelude.Nil" []) (CVar "Lune.Prelude.Nil"),CoreAlt (PCon "Lune.Prelude.Cons" [Located {locSpan = Span {spanStartLine = 109, spanStartCol = 10, spanEndLine = 109, spanEndCol = 15}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "line"},Located {locSpan = Span {spanStartLine = 109, spanStartCol = 15, spanEndLine = 109, spanEndCol = 20}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "rest"}]) (CCase (CApp (CApp (CVar "Lune.List.get") (CInt 2)) (CApp (CVar "Lune.String.words") (CVar "line"))) [CoreAlt (PCon "Lune.Prelude.Nothing" []) (CApp (CVar "Lune.System.Linux.Disk.diskNamesFromLines") (CVar "rest")),CoreAlt (PCon "Lune.Prelude.Just" [Located {locSpan = Span {spanStartLine = 113, spanStartCol = 14, spanEndLine = 113, spanEndCol = 19}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "name"}]) (CApp (CApp (CVar "Lune.Prelude.Cons") (CVar "name")) (CApp (CVar "Lune.System.Linux.Disk.diskNamesFromLines") (CVar "rest")))])])),CoreDecl "" (CInt 0),CoreDecl "Lune.System.Linux.Disk.uniqueStrings" (CLam [PVar "remaining",PVar "seenRev"] (CCase (CVar "remaining") [CoreAlt (PCon "Lune.Prelude.Nil" []) (CApp (CVar "Lune.List.reverse") (CVar "seenRev")),CoreAlt (PCon "Lune.Prelude.Cons" [Located {locSpan = Span {spanStartLine = 121, spanStartCol = 10, spanEndLine = 121, spanEndCol = 12}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "x"},Located {locSpan = Span {spanStartLine = 121, spanStartCol = 12, spanEndLine = 121, spanEndCol = 17}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "rest"}]) (CCase (CApp (CApp (CVar "Lune.System.Linux.Disk.hasString") (CVar "x")) (CVar "seenRev")) [CoreAlt (PCon "Lune.Prelude.True" []) (CApp (CApp (CVar "Lune.System.Linux.Disk.uniqueStrings") (CVar "rest")) (CVar "seenRev")),CoreAlt (PCon "Lune.Prelude.False" []) (CApp (CApp (CVar "Lune.System.Linux.Disk.uniqueStrings") (CVar "rest")) (CApp (CApp (CVar "Lune.Prelude.Cons") (CVar "x")) (CVar "seenRev")))])])),CoreDecl "" (CInt 0),CoreDecl "Lune.System.Linux.Disk.hasString" (CLam [PVar "s",PVar "xs"] (CCase (CVar "xs") [CoreAlt (PCon "Lune.Prelude.Nil" []) (CVar "Lune.Prelude.False"),CoreAlt (PCon "Lune.Prelude.Cons" [Located {locSpan = Span {spanStartLine = 133, spanStartCol = 10, spanEndLine = 133, spanEndCol = 12}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "x"},Located {locSpan = Span {spanStartLine = 133, spanStartCol = 12, spanEndLine = 133, spanEndCol = 17}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "rest"}]) (CCase (CApp (CApp (CVar "Lune.String.eq") (CVar "s")) (CVar "x")) [CoreAlt (PCon "Lune.Prelude.True" []) (CVar "Lune.Prelude.True"),CoreAlt (PCon "Lune.Prelude.False" []) (CApp (CApp (CVar "Lune.System.Linux.Disk.hasString") (CVar "s")) (CVar "rest"))])])),CoreDecl "" (CInt 0),CoreDecl "Lune.System.Linux.Disk.parseMounts" (CLam [PVar "contents"] (CApp (CVar "Lune.System.Linux.Disk.parseMountLines") (CApp (CVar "Lune.String.lines") (CVar "contents")))),CoreDecl "" (CInt 0),CoreDecl "Lune.System.Linux.Disk.parseMountLines" (CLam [PVar "lines"] (CCase (CVar "lines") [CoreAlt (PCon "Lune.Prelude.Nil" []) (CVar "Lune.Prelude.Nil"),CoreAlt (PCon "Lune.Prelude.Cons" [Located {locSpan = Span {spanStartLine = 160, spanStartCol = 10, spanEndLine = 160, spanEndCol = 15}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "line"},Located {locSpan = Span {spanStartLine = 160, spanStartCol = 15, spanEndLine = 160, spanEndCol = 20}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "rest"}]) (CCase (CApp (CVar "Lune.String.words") (CVar "line")) [CoreAlt (PCon "Lune.Prelude.Cons" [Located {locSpan = Span {spanStartLine = 162, spanStartCol = 14, spanEndLine = 162, spanEndCol = 18}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "dev"},Located {locSpan = Span {spanStartLine = 162, spanStartCol = 18, spanEndLine = 162, spanEndCol = 37}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PCon "Lune.Prelude.Cons" [Located {locSpan = Span {spanStartLine = 162, spanStartCol = 23, spanEndLine = 162, spanEndCol = 27}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "mnt"},Located {locSpan = Span {spanStartLine = 162, spanStartCol = 27, spanEndLine = 162, spanEndCol = 37}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PCon "Lune.Prelude.Cons" [Located {locSpan = Span {spanStartLine = 162, spanStartCol = 32, spanEndLine = 162, spanEndCol = 35}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "fs"},Located {locSpan = Span {spanStartLine = 162, spanStartCol = 35, spanEndLine = 162, spanEndCol = 37}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PWildcard}]}]}]) (CApp (CApp (CVar "Lune.Prelude.Cons") (CRecord [("device",CVar "dev"),("mountpoint",CVar "mnt"),("fsType",CVar "fs")])) (CApp (CVar "Lune.System.Linux.Disk.parseMountLines") (CVar "rest"))),CoreAlt PWildcard (CApp (CVar "Lune.System.Linux.Disk.parseMountLines") (CVar "rest"))])])),CoreDecl "" (CInt 0),CoreDecl "Lune.System.Linux.Disk.parseDiskstatsDevices" (CLam [PVar "contents"] (CApp (CVar "Lune.System.Linux.Disk.parseDiskstatsLines") (CApp (CVar "Lune.String.lines") (CVar "contents")))),CoreDecl "" (CInt 0),CoreDecl "Lune.System.Linux.Disk.parseDiskstatsLines" (CLam [PVar "lines"] (CCase (CVar "lines") [CoreAlt (PCon "Lune.Prelude.Nil" []) (CVar "Lune.Prelude.Nil"),CoreAlt (PCon "Lune.Prelude.Cons" [Located {locSpan = Span {spanStartLine = 189, spanStartCol = 10, spanEndLine = 189, spanEndCol = 15}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "line"},Located {locSpan = Span {spanStartLine = 189, spanStartCol = 15, spanEndLine = 189, spanEndCol = 20}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "rest"}]) (CCase (CApp (CVar "Lune.System.Linux.Disk.parseDiskstatsLine") (CVar "line")) [CoreAlt (PCon "Lune.Prelude.Nothing" []) (CApp (CVar "Lune.System.Linux.Disk.parseDiskstatsLines") (CVar "rest")),CoreAlt (PCon "Lune.Prelude.Just" [Located {locSpan = Span {spanStartLine = 193, spanStartCol = 14, spanEndLine = 193, spanEndCol = 16}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "d"}]) (CApp (CApp (CVar "Lune.Prelude.Cons") (CVar "d")) (CApp (CVar "Lune.System.Linux.Disk.parseDiskstatsLines") (CVar "rest")))])])),CoreDecl "" (CInt 0),CoreDecl "Lune.System.Linux.Disk.parseDiskstatsLine" (CLam [PVar "line"] (CLet "ws" (CApp (CVar "Lune.String.words") (CVar "line")) (CCase (CApp (CApp (CVar "Lune.List.get") (CInt 2)) (CVar "ws")) [CoreAlt (PCon "Lune.Prelude.Nothing" []) (CVar "Lune.Prelude.Nothing"),CoreAlt (PCon "Lune.Prelude.Just" [Located {locSpan = Span {spanStartLine = 208, spanStartCol = 12, spanEndLine = 208, spanEndCol = 17}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "name"}]) (CCase (CApp (CApp (CVar "Lune.List.get") (CInt 5)) (CVar "ws")) [CoreAlt (PCon "Lune.Prelude.Nothing" []) (CVar "Lune.Prelude.Nothing"),CoreAlt (PCon "Lune.Prelude.Just" [Located {locSpan = Span {spanStartLine = 212, spanStartCol = 16, spanEndLine = 212, spanEndCol = 31}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "sectorsReadStr"}]) (CCase (CApp (CApp (CVar "Lune.List.get") (CInt 9)) (CVar "ws")) [CoreAlt (PCon "Lune.Prelude.Nothing" []) (CVar "Lune.Prelude.Nothing"),CoreAlt (PCon "Lune.Prelude.Just" [Located {locSpan = Span {spanStartLine = 216, spanStartCol = 20, spanEndLine = 216, spanEndCol = 38}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "sectorsWrittenStr"}]) (CCase (CApp (CVar "Lune.System.Linux.Proc.parseInt") (CVar "sectorsReadStr")) [CoreAlt (PCon "Lune.Prelude.Err" [Located {locSpan = Span {spanStartLine = 218, spanStartCol = 23, spanEndLine = 218, spanEndCol = 25}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PWildcard}]) (CVar "Lune.Prelude.Nothing"),CoreAlt (PCon "Lune.Prelude.Ok" [Located {locSpan = Span {spanStartLine = 220, spanStartCol = 22, spanEndLine = 220, spanEndCol = 25}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "sr"}]) (CCase (CApp (CVar "Lune.System.Linux.Proc.parseInt") (CVar "sectorsWrittenStr")) [CoreAlt (PCon "Lune.Prelude.Err" [Located {locSpan = Span {spanStartLine = 222, spanStartCol = 27, spanEndLine = 222, spanEndCol = 29}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PWildcard}]) (CVar "Lune.Prelude.Nothing"),CoreAlt (PCon "Lune.Prelude.Ok" [Located {locSpan = Span {spanStartLine = 224, spanStartCol = 26, spanEndLine = 224, spanEndCol = 29}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "sw"}]) (CApp (CVar "Lune.Prelude.Just") (CRecord [("name",CVar "name"),("readBytes",CApp (CApp (CVar "Lune.Int.mul") (CVar "sr")) (CInt 512)),("writeBytes",CApp (CApp (CVar "Lune.Int.mul") (CVar "sw")) (CInt 512))]))])])])])]))),CoreDecl "" (CInt 0),CoreDecl "Lune.System.Linux.Disk.keepBlockDevices" (CLam [PVar "devs"] (CCase (CVar "devs") [CoreAlt (PCon "Lune.Prelude.Nil" []) (CApp (CVar "Lune.Task.succeed") (CVar "Lune.Prelude.Nil")),CoreAlt (PCon "Lune.Prelude.Cons" [Located {locSpan = Span {spanStartLine = 244, spanStartCol = 10, spanEndLine = 244, spanEndCol = 12}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "d"},Located {locSpan = Span {spanStartLine = 244, spanStartCol = 12, spanEndLine = 244, spanEndCol = 17}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "rest"}]) (CApp (CApp (CSelect (CVar "$dictMonad_Task") "andThen") (CApp (CVar "Lune.System.Linux.Sysfs.readIntOptional") (CApp (CVar "Lune.System.Linux.Disk.sysfsBlockSizePath") (CSelect (CVar "d") "name")))) (CLam [PVar "sizeMaybe"] (CApp (CApp (CSelect (CVar "$dictMonad_Task") "andThen") (CApp (CVar "Lune.System.Linux.Disk.keepBlockDevices") (CVar "rest"))) (CLam [PVar "kept"] (CCase (CVar "sizeMaybe") [CoreAlt (PCon "Lune.Prelude.Nothing" []) (CApp (CVar "Lune.Task.succeed") (CVar "kept")),CoreAlt (PCon "Lune.Prelude.Just" [Located {locSpan = Span {spanStartLine = 251, spanStartCol = 16, spanEndLine = 251, spanEndCol = 18}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PWildcard}]) (CApp (CVar "Lune.Task.succeed") (CApp (CApp (CVar "Lune.Prelude.Cons") (CVar "d")) (CVar "kept")))])))))])),CoreDecl "" (CInt 0),CoreDecl "Lune.System.Linux.GpuAmd.inventory" (CApp (CApp (CApp (CVar "Lune.System.Linux.GpuAmd.scanCardsInventory") (CInt 0)) (CVar "Lune.System.Linux.GpuAmd.maxCards")) (CVar "Lune.Prelude.Nil")),CoreDecl "" (CInt 0),CoreDecl "Lune.System.Linux.GpuAmd.metrics" (CApp (CApp (CSelect (CVar "$dictMonad_Task") "andThen") (CApp (CApp (CApp (CVar "Lune.System.Linux.GpuAmd.scanCardsMetrics") (CInt 0)) (CVar "Lune.System.Linux.GpuAmd.maxCards")) (CVar "Lune.Prelude.Nil"))) (CLam [PVar "devs"] (CApp (CVar "Lune.Task.succeed") (CRecord [("devices",CApp (CVar "Lune.List.reverse") (CVar "devs"))])))),CoreDecl "" (CInt 0),CoreDecl "Lune.System.Linux.GpuAmd.maxCards" (CInt 16),CoreDecl "" (CInt 0),CoreDecl "Lune.System.Linux.GpuAmd.amdVendorId" (CInt 4098),CoreDecl "" (CInt 0),CoreDecl "Lune.System.Linux.GpuAmd.scanCardsInventory" (CLam [PVar "idx",PVar "limit",PVar "accRev"] (CCase (CApp (CApp (CVar "Lune.Int.gte") (CVar "idx")) (CVar "limit")) [CoreAlt (PCon "Lune.Prelude.True" []) (CApp (CVar "Lune.Task.succeed") (CApp (CVar "Lune.List.reverse") (CVar "accRev"))),CoreAlt (PCon "Lune.Prelude.False" []) (CApp (CApp (CSelect (CVar "$dictMonad_Task") "andThen") (CApp (CVar "Lune.System.Linux.Sysfs.readHexIntOptional") (CApp (CVar "Lune.System.Linux.GpuAmd.vendorPath") (CVar "idx")))) (CLam [PVar "vendor"] (CCase (CVar "vendor") [CoreAlt (PCon "Lune.Prelude.Just" [Located {locSpan = Span {spanStartLine = 98, spanStartCol = 16, spanEndLine = 98, spanEndCol = 18}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "v"}]) (CCase (CApp (CApp (CVar "Lune.Int.eq") (CVar "v")) (CVar "Lune.System.Linux.GpuAmd.amdVendorId")) [CoreAlt (PCon "Lune.Prelude.True" []) (CApp (CApp (CSelect (CVar "$dictMonad_Task") "andThen") (CApp (CVar "Lune.System.Linux.GpuAmd.pciAddress") (CVar "idx"))) (CLam [PVar "pci"] (CApp (CApp (CSelect (CVar "$dictMonad_Task") "andThen") (CApp (CVar "Lune.System.Linux.Sysfs.readIntOptional") (CApp (CVar "Lune.System.Linux.GpuAmd.vramTotalPath") (CVar "idx")))) (CLam [PVar "vramTotal"] (CLet "info" (CRecord [("name",CVar "Lune.Prelude.Nothing"),("pci",CVar "pci"),("driver",CApp (CVar "Lune.Prelude.Just") (CString "amdgpu")),("vramTotalBytes",CVar "vramTotal")]) (CApp (CApp (CApp (CVar "Lune.System.Linux.GpuAmd.scanCardsInventory") (CApp (CApp (CVar "Lune.Int.add") (CVar "idx")) (CInt 1))) (CVar "limit")) (CApp (CApp (CVar "Lune.Prelude.Cons") (CVar "info")) (CVar "accRev")))))))),CoreAlt (PCon "Lune.Prelude.False" []) (CApp (CApp (CApp (CVar "Lune.System.Linux.GpuAmd.scanCardsInventory") (CApp (CApp (CVar "Lune.Int.add") (CVar "idx")) (CInt 1))) (CVar "limit")) (CVar "accRev"))]),CoreAlt (PCon "Lune.Prelude.Nothing" []) (CApp (CApp (CApp (CVar "Lune.System.Linux.GpuAmd.scanCardsInventory") (CApp (CApp (CVar "Lune.Int.add") (CVar "idx")) (CInt 1))) (CVar "limit")) (CVar "accRev"))])))])),CoreDecl "" (CInt 0),CoreDecl "Lune.System.Linux.GpuAmd.scanCardsMetrics" (CLam [PVar "idx",PVar "limit",PVar "accRev"] (CCase (CApp (CApp (CVar "Lune.Int.gte") (CVar "idx")) (CVar "limit")) [CoreAlt (PCon "Lune.Prelude.True" []) (CApp (CVar "Lune.Task.succeed") (CVar "accRev")),CoreAlt (PCon "Lune.Prelude.False" []) (CApp (CApp (CSelect (CVar "$dictMonad_Task") "andThen") (CApp (CVar "Lune.System.Linux.Sysfs.readHexIntOptional") (CApp (CVar "Lune.System.Linux.GpuAmd.vendorPath") (CVar "idx")))) (CLam [PVar "vendor"] (CCase (CVar "vendor") [CoreAlt (PCon "Lune.Prelude.Just" [Located {locSpan = Span {spanStartLine = 153, spanStartCol = 16, spanEndLine = 153, spanEndCol = 18}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "v"}]) (CCase (CApp (CApp (CVar "Lune.Int.eq") (CVar "v")) (CVar "Lune.System.Linux.GpuAmd.amdVendorId")) [CoreAlt (PCon "Lune.Prelude.True" []) (CApp (CApp (CSelect (CVar "$dictMonad_Task") "andThen") (CApp (CVar "Lune.System.Linux.GpuAmd.pciAddress") (CVar "idx"))) (CLam [PVar "pci"] (CApp (CApp (CSelect (CVar "$dictMonad_Task") "andThen") (CApp (CVar "Lune.System.Linux.Sysfs.readIntOptional") (CApp (CVar "Lune.System.Linux.GpuAmd.busyPath") (CVar "idx")))) (CLam [PVar "busySys"] (CApp (CApp (CSelect (CVar "$dictMonad_Task") "andThen") (CApp (CVar "Lune.System.Linux.GpuAmd.debugfsBusyPercent") (CVar "idx"))) (CLam [PVar "busyDebug"] (CLet "busy" (CCase (CVar "busySys") [CoreAlt (PCon "Lune.Prelude.Just" [Located {locSpan = Span {spanStartLine = 162, spanStartCol = 28, spanEndLine = 162, spanEndCol = 30}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "n"}]) (CApp (CVar "Lune.Prelude.Just") (CVar "n")),CoreAlt (PCon "Lune.Prelude.Nothing" []) (CVar "busyDebug")]) (CApp (CApp (CSelect (CVar "$dictMonad_Task") "andThen") (CApp (CApp (CApp (CApp (CVar "Lune.System.Linux.GpuAmd.probeHwmonInt") (CVar "idx")) (CString "temp1_input")) (CInt 0)) (CVar "Lune.System.Linux.GpuAmd.maxHwmon"))) (CLam [PVar "tempMilli"] (CApp (CApp (CSelect (CVar "$dictMonad_Task") "andThen") (CApp (CApp (CApp (CApp (CVar "Lune.System.Linux.GpuAmd.probeHwmonInt") (CVar "idx")) (CString "power1_average")) (CInt 0)) (CVar "Lune.System.Linux.GpuAmd.maxHwmon"))) (CLam [PVar "powerMicro"] (CApp (CApp (CSelect (CVar "$dictMonad_Task") "andThen") (CApp (CVar "Lune.System.Linux.Sysfs.readIntOptional") (CApp (CVar "Lune.System.Linux.GpuAmd.vramUsedPath") (CVar "idx")))) (CLam [PVar "vramUsed"] (CLet "tempC" (CCase (CVar "tempMilli") [CoreAlt (PCon "Lune.Prelude.Nothing" []) (CVar "Lune.Prelude.Nothing"),CoreAlt (PCon "Lune.Prelude.Just" [Located {locSpan = Span {spanStartLine = 175, spanStartCol = 28, spanEndLine = 175, spanEndCol = 30}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "n"}]) (CApp (CVar "Lune.Prelude.Just") (CApp (CApp (CVar "Lune.Float.div") (CApp (CVar "Lune.Float.fromInt") (CVar "n"))) (CApp (CVar "Lune.Float.fromInt") (CInt 1000))))]) (CLet "powerW" (CCase (CVar "powerMicro") [CoreAlt (PCon "Lune.Prelude.Nothing" []) (CVar "Lune.Prelude.Nothing"),CoreAlt (PCon "Lune.Prelude.Just" [Located {locSpan = Span {spanStartLine = 182, spanStartCol = 28, spanEndLine = 182, spanEndCol = 30}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "n"}]) (CApp (CVar "Lune.Prelude.Just") (CApp (CApp (CVar "Lune.Float.div") (CApp (CVar "Lune.Float.fromInt") (CVar "n"))) (CApp (CVar "Lune.Float.fromInt") (CInt 1000000))))]) (CLet "notes" (CApp (CApp (CApp (CApp (CApp (CApp (CVar "Lune.System.Linux.GpuAmd.notesFor") (CVar "busySys")) (CVar "busyDebug")) (CVar "tempMilli")) (CVar "powerMicro")) (CVar "vramUsed")) (CVar "idx")) (CLet "m" (CRecord [("pci",CVar "pci"),("busyPercent",CVar "busy"),("tempC",CVar "tempC"),("powerW",CVar "powerW"),("vramUsedBytes",CVar "vramUsed"),("notes",CVar "notes")]) (CApp (CApp (CApp (CVar "Lune.System.Linux.GpuAmd.scanCardsMetrics") (CApp (CApp (CVar "Lune.Int.add") (CVar "idx")) (CInt 1))) (CVar "limit")) (CApp (CApp (CVar "Lune.Prelude.Cons") (CVar "m")) (CVar "accRev")))))))))))))))))))),CoreAlt (PCon "Lune.Prelude.False" []) (CApp (CApp (CApp (CVar "Lune.System.Linux.GpuAmd.scanCardsMetrics") (CApp (CApp (CVar "Lune.Int.add") (CVar "idx")) (CInt 1))) (CVar "limit")) (CVar "accRev"))]),CoreAlt (PCon "Lune.Prelude.Nothing" []) (CApp (CApp (CApp (CVar "Lune.System.Linux.GpuAmd.scanCardsMetrics") (CApp (CApp (CVar "Lune.Int.add") (CVar "idx")) (CInt 1))) (CVar "limit")) (CVar "accRev"))])))])),CoreDecl "" (CInt 0),CoreDecl "Lune.System.Linux.GpuAmd.maxHwmon" (CInt 32),CoreDecl "" (CInt 0),CoreDecl "Lune.System.Linux.GpuAmd.notesFor" (CLam [PVar "busySys",PVar "busyDebug",PVar "tempMilli",PVar "powerMicro",PVar "vramUsed",PVar "idx"] (CLet "n0" (CCase (CVar "busySys") [CoreAlt (PCon "Lune.Prelude.Just" [Located {locSpan = Span {spanStartLine = 219, spanStartCol = 14, spanEndLine = 219, spanEndCol = 16}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PWildcard}]) (CVar "Lune.Prelude.Nil"),CoreAlt (PCon "Lune.Prelude.Nothing" []) (CCase (CVar "busyDebug") [CoreAlt (PCon "Lune.Prelude.Just" [Located {locSpan = Span {spanStartLine = 223, spanStartCol = 18, spanEndLine = 223, spanEndCol = 20}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PWildcard}]) (CVar "Lune.Prelude.Nil"),CoreAlt (PCon "Lune.Prelude.Nothing" []) (CApp (CApp (CVar "Lune.Prelude.Cons") (CApp (CApp (CVar "Lune.String.append") (CString "debugfs_unavailable:")) (CApp (CVar "Lune.System.Linux.GpuAmd.debugfsPmInfoPath") (CVar "idx")))) (CVar "Lune.Prelude.Nil"))])]) (CLet "n1" (CCase (CVar "tempMilli") [CoreAlt (PCon "Lune.Prelude.Nothing" []) (CApp (CApp (CVar "Lune.Prelude.Cons") (CString "temp_unavailable")) (CVar "n0")),CoreAlt (PCon "Lune.Prelude.Just" [Located {locSpan = Span {spanStartLine = 231, spanStartCol = 14, spanEndLine = 231, spanEndCol = 16}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PWildcard}]) (CVar "n0")]) (CLet "n2" (CCase (CVar "powerMicro") [CoreAlt (PCon "Lune.Prelude.Nothing" []) (CApp (CApp (CVar "Lune.Prelude.Cons") (CString "power_unavailable")) (CVar "n1")),CoreAlt (PCon "Lune.Prelude.Just" [Located {locSpan = Span {spanStartLine = 237, spanStartCol = 14, spanEndLine = 237, spanEndCol = 16}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PWildcard}]) (CVar "n1")]) (CLet "n3" (CCase (CVar "vramUsed") [CoreAlt (PCon "Lune.Prelude.Nothing" []) (CVar "n2"),CoreAlt (PCon "Lune.Prelude.Just" [Located {locSpan = Span {spanStartLine = 243, spanStartCol = 14, spanEndLine = 243, spanEndCol = 16}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PWildcard}]) (CVar "n2")]) (CVar "n3")))))),CoreDecl "" (CInt 0),CoreDecl "Lune.System.Linux.GpuAmd.vendorPath" (CLam [PVar "idx"] (CApp (CApp (CVar "Lune.String.append") (CString "/sys/class/drm/card")) (CApp (CApp (CVar "Lune.String.append") (CApp (CVar "Lune.String.fromInt") (CVar "idx"))) (CString "/device/vendor")))),CoreDecl "" (CInt 0),CoreDecl "Lune.System.Linux.GpuAmd.ueventPath" (CLam [PVar "idx"] (CApp (CApp (CVar "Lune.String.append") (CString "/sys/class/drm/card")) (CApp (CApp (CVar "Lune.String.append") (CApp (CVar "Lune.String.fromInt") (CVar "idx"))) (CString "/device/uevent")))),CoreDecl "" (CInt 0),CoreDecl "Lune.System.Linux.GpuAmd.busyPath" (CLam [PVar "idx"] (CApp (CApp (CVar "Lune.String.append") (CString "/sys/class/drm/card")) (CApp (CApp (CVar "Lune.String.append") (CApp (CVar "Lune.String.fromInt") (CVar "idx"))) (CString "/device/gpu_busy_percent")))),CoreDecl "" (CInt 0),CoreDecl "Lune.System.Linux.GpuAmd.vramTotalPath" (CLam [PVar "idx"] (CApp (CApp (CVar "Lune.String.append") (CString "/sys/class/drm/card")) (CApp (CApp (CVar "Lune.String.append") (CApp (CVar "Lune.String.fromInt") (CVar "idx"))) (CString "/device/mem_info_vram_total")))),CoreDecl "" (CInt 0),CoreDecl "Lune.System.Linux.GpuAmd.vramUsedPath" (CLam [PVar "idx"] (CApp (CApp (CVar "Lune.String.append") (CString "/sys/class/drm/card")) (CApp (CApp (CVar "Lune.String.append") (CApp (CVar "Lune.String.fromInt") (CVar "idx"))) (CString "/device/mem_info_vram_used")))),CoreDecl "" (CInt 0),CoreDecl "Lune.System.Linux.GpuAmd.hwmonPath" (CLam [PVar "cardIdx",PVar "hwmonIdx",PVar "file"] (CApp (CApp (CVar "Lune.String.append") (CString "/sys/class/drm/card")) (CApp (CApp (CVar "Lune.String.append") (CApp (CVar "Lune.String.fromInt") (CVar "cardIdx"))) (CApp (CApp (CVar "Lune.String.append") (CString "/device/hwmon/hwmon")) (CApp (CApp (CVar "Lune.String.append") (CApp (CVar "Lune.String.fromInt") (CVar "hwmonIdx"))) (CApp (CApp (CVar "Lune.String.append") (CString "/")) (CVar "file"))))))),CoreDecl "" (CInt 0),CoreDecl "Lune.System.Linux.GpuAmd.pciAddress" (CLam [PVar "idx"] (CApp (CApp (CSelect (CVar "$dictMonad_Task") "andThen") (CApp (CVar "Lune.System.Linux.Sysfs.readOptional") (CApp (CVar "Lune.System.Linux.GpuAmd.ueventPath") (CVar "idx")))) (CLam [PVar "uevent"] (CCase (CVar "uevent") [CoreAlt (PCon "Lune.Prelude.Nothing" []) (CApp (CVar "Lune.Task.succeed") (CVar "Lune.Prelude.Nothing")),CoreAlt (PCon "Lune.Prelude.Just" [Located {locSpan = Span {spanStartLine = 303, spanStartCol = 12, spanEndLine = 303, spanEndCol = 14}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "s"}]) (CCase (CApp (CVar "Lune.System.Linux.GpuAmd.pciSlotNameFromUevent") (CApp (CVar "Lune.String.lines") (CVar "s"))) [CoreAlt (PCon "Lune.Prelude.Nothing" []) (CApp (CVar "Lune.Task.succeed") (CVar "Lune.Prelude.Nothing")),CoreAlt (PCon "Lune.Prelude.Just" [Located {locSpan = Span {spanStartLine = 307, spanStartCol = 16, spanEndLine = 307, spanEndCol = 21}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "slot"}]) (CCase (CApp (CVar "Lune.System.Linux.Proc.parsePciAddress") (CVar "slot")) [CoreAlt (PCon "Lune.Prelude.Ok" [Located {locSpan = Span {spanStartLine = 309, spanStartCol = 18, spanEndLine = 309, spanEndCol = 22}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "pci"}]) (CApp (CVar "Lune.Task.succeed") (CApp (CVar "Lune.Prelude.Just") (CVar "pci"))),CoreAlt (PCon "Lune.Prelude.Err" [Located {locSpan = Span {spanStartLine = 311, spanStartCol = 19, spanEndLine = 311, spanEndCol = 21}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PWildcard}]) (CApp (CVar "Lune.Task.succeed") (CVar "Lune.Prelude.Nothing"))])])])))),CoreDecl "" (CInt 0),CoreDecl "Lune.System.Linux.GpuAmd.pciSlotNameFromUevent" (CLam [PVar "lines"] (CCase (CVar "lines") [CoreAlt (PCon "Lune.Prelude.Nil" []) (CVar "Lune.Prelude.Nothing"),CoreAlt (PCon "Lune.Prelude.Cons" [Located {locSpan = Span {spanStartLine = 319, spanStartCol = 10, spanEndLine = 319, spanEndCol = 15}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "line"},Located {locSpan = Span {spanStartLine = 319, spanStartCol = 15, spanEndLine = 319, spanEndCol = 20}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "rest"}]) (CCase (CApp (CApp (CVar "Lune.String.startsWith") (CString "PCI_SLOT_NAME=")) (CVar "line")) [CoreAlt (PCon "Lune.Prelude.True" []) (CApp (CVar "Lune.Prelude.Just") (CApp (CApp (CVar "Lune.String.drop") (CInt 14)) (CVar "line"))),CoreAlt (PCon "Lune.Prelude.False" []) (CApp (CVar "Lune.System.Linux.GpuAmd.pciSlotNameFromUevent") (CVar "rest"))])])),CoreDecl "" (CInt 0),CoreDecl "Lune.System.Linux.GpuAmd.probeHwmonInt" (CLam [PVar "cardIdx",PVar "file",PVar "idx",PVar "limit"] (CCase (CApp (CApp (CVar "Lune.Int.gte") (CVar "idx")) (CVar "limit")) [CoreAlt (PCon "Lune.Prelude.True" []) (CApp (CVar "Lune.Task.succeed") (CVar "Lune.Prelude.Nothing")),CoreAlt (PCon "Lune.Prelude.False" []) (CApp (CApp (CSelect (CVar "$dictMonad_Task") "andThen") (CApp (CVar "Lune.System.Linux.Sysfs.readIntOptional") (CApp (CApp (CApp (CVar "Lune.System.Linux.GpuAmd.hwmonPath") (CVar "cardIdx")) (CVar "idx")) (CVar "file")))) (CLam [PVar "v"] (CCase (CVar "v") [CoreAlt (PCon "Lune.Prelude.Just" [Located {locSpan = Span {spanStartLine = 340, spanStartCol = 16, spanEndLine = 340, spanEndCol = 18}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "n"}]) (CApp (CVar "Lune.Task.succeed") (CApp (CVar "Lune.Prelude.Just") (CVar "n"))),CoreAlt (PCon "Lune.Prelude.Nothing" []) (CApp (CApp (CApp (CApp (CVar "Lune.System.Linux.GpuAmd.probeHwmonInt") (CVar "cardIdx")) (CVar "file")) (CApp (CApp (CVar "Lune.Int.add") (CVar "idx")) (CInt 1))) (CVar "limit"))])))])),CoreDecl "" (CInt 0),CoreDecl "Lune.System.Linux.GpuAmd.debugfsBusyPercent" (CLam [PVar "idx"] (CApp (CApp (CSelect (CVar "$dictMonad_Task") "andThen") (CApp (CVar "Lune.System.Linux.Proc.readFileOptional") (CApp (CVar "Lune.System.Linux.GpuAmd.debugfsPmInfoPath") (CVar "idx")))) (CLam [PVar "pm"] (CCase (CVar "pm") [CoreAlt (PCon "Lune.Prelude.Nothing" []) (CApp (CVar "Lune.Task.succeed") (CVar "Lune.Prelude.Nothing")),CoreAlt (PCon "Lune.Prelude.Just" [Located {locSpan = Span {spanStartLine = 352, spanStartCol = 12, spanEndLine = 352, spanEndCol = 14}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "s"}]) (CApp (CVar "Lune.Task.succeed") (CApp (CVar "Lune.System.Linux.GpuAmd.parseBusyFromPmInfo") (CApp (CVar "Lune.String.lines") (CVar "s"))))])))),CoreDecl "" (CInt 0),CoreDecl "Lune.System.Linux.GpuAmd.debugfsPmInfoPath" (CLam [PVar "idx"] (CApp (CApp (CVar "Lune.String.append") (CString "/sys/kernel/debug/dri/")) (CApp (CApp (CVar "Lune.String.append") (CApp (CVar "Lune.String.fromInt") (CVar "idx"))) (CString "/amdgpu_pm_info")))),CoreDecl "" (CInt 0),CoreDecl "Lune.System.Linux.GpuAmd.parseBusyFromPmInfo" (CLam [PVar "lines"] (CCase (CVar "lines") [CoreAlt (PCon "Lune.Prelude.Nil" []) (CVar "Lune.Prelude.Nothing"),CoreAlt (PCon "Lune.Prelude.Cons" [Located {locSpan = Span {spanStartLine = 366, spanStartCol = 10, spanEndLine = 366, spanEndCol = 15}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "line"},Located {locSpan = Span {spanStartLine = 366, spanStartCol = 15, spanEndLine = 366, spanEndCol = 20}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "rest"}]) (CCase (CApp (CApp (CVar "Lune.String.contains") (CString "GPU Load")) (CVar "line")) [CoreAlt (PCon "Lune.Prelude.True" []) (CApp (CVar "Lune.System.Linux.GpuAmd.busyFromLine") (CApp (CVar "Lune.String.words") (CVar "line"))),CoreAlt (PCon "Lune.Prelude.False" []) (CApp (CVar "Lune.System.Linux.GpuAmd.parseBusyFromPmInfo") (CVar "rest"))])])),CoreDecl "" (CInt 0),CoreDecl "Lune.System.Linux.GpuAmd.busyFromLine" (CLam [PVar "ws"] (CCase (CVar "ws") [CoreAlt (PCon "Lune.Prelude.Nil" []) (CVar "Lune.Prelude.Nothing"),CoreAlt (PCon "Lune.Prelude.Cons" [Located {locSpan = Span {spanStartLine = 378, spanStartCol = 10, spanEndLine = 378, spanEndCol = 12}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "w"},Located {locSpan = Span {spanStartLine = 378, spanStartCol = 12, spanEndLine = 378, spanEndCol = 17}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "rest"}]) (CCase (CApp (CVar "Lune.System.Linux.Proc.parseInt") (CApp (CVar "Lune.System.Linux.GpuAmd.stripPercent") (CVar "w"))) [CoreAlt (PCon "Lune.Prelude.Ok" [Located {locSpan = Span {spanStartLine = 380, spanStartCol = 12, spanEndLine = 380, spanEndCol = 14}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "n"}]) (CApp (CVar "Lune.Prelude.Just") (CVar "n")),CoreAlt (PCon "Lune.Prelude.Err" [Located {locSpan = Span {spanStartLine = 382, spanStartCol = 13, spanEndLine = 382, spanEndCol = 15}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PWildcard}]) (CApp (CVar "Lune.System.Linux.GpuAmd.busyFromLine") (CVar "rest"))])])),CoreDecl "" (CInt 0),CoreDecl "Lune.System.Linux.GpuAmd.stripPercent" (CLam [PVar "s"] (CCase (CApp (CApp (CVar "Lune.String.endsWith") (CString "%")) (CVar "s")) [CoreAlt (PCon "Lune.Prelude.True" []) (CApp (CApp (CVar "Lune.String.take") (CApp (CApp (CVar "Lune.Int.sub") (CApp (CVar "Lune.String.length") (CVar "s"))) (CInt 1))) (CVar "s")),CoreAlt (PCon "Lune.Prelude.False" []) (CVar "s")])),CoreDecl "" (CInt 0),CoreDecl "Lune.System.Linux.Mem.memInfo" (CApp (CApp (CSelect (CVar "$dictMonad_Task") "andThen") (CApp (CVar "Lune.System.Linux.Proc.readFile") (CString "/proc/meminfo"))) (CLam [PVar "contents"] (CCase (CApp (CVar "Lune.System.Linux.Mem.parseEntries") (CVar "contents")) [CoreAlt (PCon "Lune.Prelude.Err" [Located {locSpan = Span {spanStartLine = 24, spanStartCol = 11, spanEndLine = 24, spanEndCol = 15}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "msg"}]) (CApp (CVar "Lune.Task.fail") (CVar "msg")),CoreAlt (PCon "Lune.Prelude.Ok" [Located {locSpan = Span {spanStartLine = 26, spanStartCol = 10, spanEndLine = 26, spanEndCol = 18}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "entries"}]) (CCase (CApp (CApp (CVar "Lune.System.Linux.Mem.findBytes") (CString "MemTotal")) (CVar "entries")) [CoreAlt (PCon "Lune.Prelude.Nothing" []) (CApp (CVar "Lune.Task.fail") (CString "parse:/proc/meminfo: missing MemTotal")),CoreAlt (PCon "Lune.Prelude.Just" [Located {locSpan = Span {spanStartLine = 30, spanStartCol = 16, spanEndLine = 30, spanEndCol = 22}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "total"}]) (CApp (CVar "Lune.Task.succeed") (CRecord [("totalBytes",CVar "total")]))])]))),CoreDecl "" (CInt 0),CoreDecl "Lune.System.Linux.Mem.memMetrics" (CApp (CApp (CSelect (CVar "$dictMonad_Task") "andThen") (CApp (CVar "Lune.System.Linux.Proc.readFile") (CString "/proc/meminfo"))) (CLam [PVar "contents"] (CCase (CApp (CVar "Lune.System.Linux.Mem.parseEntries") (CVar "contents")) [CoreAlt (PCon "Lune.Prelude.Err" [Located {locSpan = Span {spanStartLine = 49, spanStartCol = 11, spanEndLine = 49, spanEndCol = 15}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "msg"}]) (CApp (CVar "Lune.Task.fail") (CVar "msg")),CoreAlt (PCon "Lune.Prelude.Ok" [Located {locSpan = Span {spanStartLine = 51, spanStartCol = 10, spanEndLine = 51, spanEndCol = 18}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "entries"}]) (CCase (CApp (CApp (CVar "Lune.System.Linux.Mem.findBytes") (CString "MemTotal")) (CVar "entries")) [CoreAlt (PCon "Lune.Prelude.Nothing" []) (CApp (CVar "Lune.Task.fail") (CString "parse:/proc/meminfo: missing MemTotal")),CoreAlt (PCon "Lune.Prelude.Just" [Located {locSpan = Span {spanStartLine = 55, spanStartCol = 16, spanEndLine = 55, spanEndCol = 22}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "total"}]) (CApp (CVar "Lune.Task.succeed") (CRecord [("totalBytes",CVar "total"),("availableBytes",CApp (CApp (CVar "Lune.System.Linux.Mem.findBytes") (CString "MemAvailable")) (CVar "entries")),("freeBytes",CApp (CApp (CVar "Lune.System.Linux.Mem.findBytes") (CString "MemFree")) (CVar "entries")),("buffersBytes",CApp (CApp (CVar "Lune.System.Linux.Mem.findBytes") (CString "Buffers")) (CVar "entries")),("cachedBytes",CApp (CApp (CVar "Lune.System.Linux.Mem.findBytes") (CString "Cached")) (CVar "entries")),("swapTotalBytes",CApp (CApp (CVar "Lune.System.Linux.Mem.findBytes") (CString "SwapTotal")) (CVar "entries")),("swapFreeBytes",CApp (CApp (CVar "Lune.System.Linux.Mem.findBytes") (CString "SwapFree")) (CVar "entries"))]))])]))),CoreDecl "" (CInt 0),CoreDecl "" (CInt 0),CoreDecl "Lune.System.Linux.Mem.parseEntries" (CLam [PVar "contents"] (CApp (CVar "Lune.Prelude.Ok") (CApp (CVar "Lune.System.Linux.Mem.parseLines") (CApp (CVar "Lune.String.lines") (CVar "contents"))))),CoreDecl "" (CInt 0),CoreDecl "Lune.System.Linux.Mem.parseLines" (CLam [PVar "lines"] (CCase (CVar "lines") [CoreAlt (PCon "Lune.Prelude.Nil" []) (CVar "Lune.Prelude.Nil"),CoreAlt (PCon "Lune.Prelude.Cons" [Located {locSpan = Span {spanStartLine = 79, spanStartCol = 10, spanEndLine = 79, spanEndCol = 15}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "line"},Located {locSpan = Span {spanStartLine = 79, spanStartCol = 15, spanEndLine = 79, spanEndCol = 20}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "rest"}]) (CCase (CApp (CVar "Lune.System.Linux.Proc.parseKeyValueLine") (CVar "line")) [CoreAlt (PCon "Lune.Prelude.Nothing" []) (CApp (CVar "Lune.System.Linux.Mem.parseLines") (CVar "rest")),CoreAlt (PCon "Lune.Prelude.Just" [Located {locSpan = Span {spanStartLine = 83, spanStartCol = 14, spanEndLine = 83, spanEndCol = 17}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "kv"}]) (CCase (CApp (CVar "Lune.System.Linux.Mem.parseValueBytes") (CSelect (CVar "kv") "value")) [CoreAlt (PCon "Lune.Prelude.Nothing" []) (CApp (CVar "Lune.System.Linux.Mem.parseLines") (CVar "rest")),CoreAlt (PCon "Lune.Prelude.Just" [Located {locSpan = Span {spanStartLine = 87, spanStartCol = 18, spanEndLine = 87, spanEndCol = 20}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "b"}]) (CApp (CApp (CVar "Lune.Prelude.Cons") (CRecord [("key",CSelect (CVar "kv") "key"),("bytes",CVar "b")])) (CApp (CVar "Lune.System.Linux.Mem.parseLines") (CVar "rest")))])])])),CoreDecl "" (CInt 0),CoreDecl "Lune.System.Linux.Mem.parseValueBytes" (CLam [PVar "s"] (CCase (CApp (CVar "Lune.String.words") (CVar "s")) [CoreAlt (PCon "Lune.Prelude.Nil" []) (CVar "Lune.Prelude.Nothing"),CoreAlt (PCon "Lune.Prelude.Cons" [Located {locSpan = Span {spanStartLine = 95, spanStartCol = 10, spanEndLine = 95, spanEndCol = 15}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "nStr"},Located {locSpan = Span {spanStartLine = 95, spanStartCol = 15, spanEndLine = 95, spanEndCol = 20}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "rest"}]) (CCase (CApp (CVar "Lune.System.Linux.Proc.parseInt") (CVar "nStr")) [CoreAlt (PCon "Lune.Prelude.Err" [Located {locSpan = Span {spanStartLine = 97, spanStartCol = 13, spanEndLine = 97, spanEndCol = 15}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PWildcard}]) (CVar "Lune.Prelude.Nothing"),CoreAlt (PCon "Lune.Prelude.Ok" [Located {locSpan = Span {spanStartLine = 99, spanStartCol = 12, spanEndLine = 99, spanEndCol = 14}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "n"}]) (CCase (CVar "rest") [CoreAlt (PCon "Lune.Prelude.Nil" []) (CApp (CVar "Lune.Prelude.Just") (CVar "n")),CoreAlt (PCon "Lune.Prelude.Cons" [Located {locSpan = Span {spanStartLine = 103, spanStartCol = 18, spanEndLine = 103, spanEndCol = 23}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "unit"},Located {locSpan = Span {spanStartLine = 103, spanStartCol = 23, spanEndLine = 103, spanEndCol = 25}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PWildcard}]) (CCase (CApp (CApp (CVar "Lune.String.eq") (CVar "unit")) (CString "kB")) [CoreAlt (PCon "Lune.Prelude.True" []) (CApp (CVar "Lune.Prelude.Just") (CApp (CApp (CVar "Lune.Int.mul") (CVar "n")) (CInt 1024))),CoreAlt (PCon "Lune.Prelude.False" []) (CApp (CVar "Lune.Prelude.Just") (CVar "n"))])])])])),CoreDecl "" (CInt 0),CoreDecl "Lune.System.Linux.Mem.findBytes" (CLam [PVar "key",PVar "entries"] (CCase (CVar "entries") [CoreAlt (PCon "Lune.Prelude.Nil" []) (CVar "Lune.Prelude.Nothing"),CoreAlt (PCon "Lune.Prelude.Cons" [Located {locSpan = Span {spanStartLine = 115, spanStartCol = 10, spanEndLine = 115, spanEndCol = 12}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "e"},Located {locSpan = Span {spanStartLine = 115, spanStartCol = 12, spanEndLine = 115, spanEndCol = 17}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "rest"}]) (CCase (CApp (CApp (CVar "Lune.String.eq") (CSelect (CVar "e") "key")) (CVar "key")) [CoreAlt (PCon "Lune.Prelude.True" []) (CApp (CVar "Lune.Prelude.Just") (CSelect (CVar "e") "bytes")),CoreAlt (PCon "Lune.Prelude.False" []) (CApp (CApp (CVar "Lune.System.Linux.Mem.findBytes") (CVar "key")) (CVar "rest"))])])),CoreDecl "" (CInt 0),CoreDecl "Lune.System.Linux.Net.interfaces" (CApp (CApp (CSelect (CVar "$dictMonad_Task") "andThen") (CApp (CVar "Lune.System.Linux.Proc.readFile") (CString "/proc/net/dev"))) (CLam [PVar "contents"] (CLet "names" (CApp (CApp (CVar "Lune.System.Linux.Net.uniqueStrings") (CApp (CVar "Lune.System.Linux.Net.parseInterfaceNames") (CVar "contents"))) (CVar "Lune.Prelude.Nil")) (CApp (CVar "Lune.System.Linux.Net.gatherInterfaces") (CVar "names"))))),CoreDecl "" (CInt 0),CoreDecl "Lune.System.Linux.Net.netMetrics" (CApp (CApp (CSelect (CVar "$dictMonad_Task") "andThen") (CApp (CVar "Lune.System.Linux.Proc.readFile") (CString "/proc/net/dev"))) (CLam [PVar "contents"] (CApp (CVar "Lune.Task.succeed") (CRecord [("interfaces",CApp (CVar "Lune.System.Linux.Net.parseInterfaceCounters") (CVar "contents"))])))),CoreDecl "" (CInt 0),CoreDecl "Lune.System.Linux.Net.gatherInterfaces" (CLam [PVar "names"] (CCase (CVar "names") [CoreAlt (PCon "Lune.Prelude.Nil" []) (CApp (CVar "Lune.Task.succeed") (CVar "Lune.Prelude.Nil")),CoreAlt (PCon "Lune.Prelude.Cons" [Located {locSpan = Span {spanStartLine = 57, spanStartCol = 10, spanEndLine = 57, spanEndCol = 15}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "name"},Located {locSpan = Span {spanStartLine = 57, spanStartCol = 15, spanEndLine = 57, spanEndCol = 20}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "rest"}]) (CApp (CApp (CSelect (CVar "$dictMonad_Task") "andThen") (CApp (CVar "Lune.System.Linux.Sysfs.readOptional") (CApp (CVar "Lune.System.Linux.Net.sysfsAddressPath") (CVar "name")))) (CLam [PVar "mac"] (CApp (CApp (CSelect (CVar "$dictMonad_Task") "andThen") (CApp (CVar "Lune.System.Linux.Sysfs.readIntOptional") (CApp (CVar "Lune.System.Linux.Net.sysfsMtuPath") (CVar "name")))) (CLam [PVar "mtu"] (CApp (CApp (CSelect (CVar "$dictMonad_Task") "andThen") (CApp (CVar "Lune.System.Linux.Net.gatherInterfaces") (CVar "rest"))) (CLam [PVar "xs"] (CApp (CVar "Lune.Task.succeed") (CApp (CApp (CVar "Lune.Prelude.Cons") (CRecord [("name",CVar "name"),("mac",CVar "mac"),("mtu",CVar "mtu")])) (CVar "xs")))))))))])),CoreDecl "" (CInt 0),CoreDecl "Lune.System.Linux.Net.sysfsAddressPath" (CLam [PVar "name"] (CApp (CApp (CVar "Lune.String.append") (CString "/sys/class/net/")) (CApp (CApp (CVar "Lune.String.append") (CVar "name")) (CString "/address")))),CoreDecl "" (CInt 0),CoreDecl "Lune.System.Linux.Net.sysfsMtuPath" (CLam [PVar "name"] (CApp (CApp (CVar "Lune.String.append") (CString "/sys/class/net/")) (CApp (CApp (CVar "Lune.String.append") (CVar "name")) (CString "/mtu")))),CoreDecl "" (CInt 0),CoreDecl "Lune.System.Linux.Net.parseInterfaceNames" (CLam [PVar "contents"] (CApp (CVar "Lune.System.Linux.Net.parseNamesFromLines") (CApp (CVar "Lune.String.lines") (CVar "contents")))),CoreDecl "" (CInt 0),CoreDecl "Lune.System.Linux.Net.parseNamesFromLines" (CLam [PVar "lines"] (CCase (CVar "lines") [CoreAlt (PCon "Lune.Prelude.Nil" []) (CVar "Lune.Prelude.Nil"),CoreAlt (PCon "Lune.Prelude.Cons" [Located {locSpan = Span {spanStartLine = 79, spanStartCol = 10, spanEndLine = 79, spanEndCol = 15}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "line"},Located {locSpan = Span {spanStartLine = 79, spanStartCol = 15, spanEndLine = 79, spanEndCol = 20}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "rest"}]) (CCase (CApp (CApp (CVar "Lune.System.Linux.Proc.splitOnce") (CString ":")) (CVar "line")) [CoreAlt (PCon "Lune.Prelude.Nothing" []) (CApp (CVar "Lune.System.Linux.Net.parseNamesFromLines") (CVar "rest")),CoreAlt (PCon "Lune.Prelude.Just" [Located {locSpan = Span {spanStartLine = 83, spanStartCol = 14, spanEndLine = 83, spanEndCol = 24}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PCon "Lune.Prelude.Pair" [Located {locSpan = Span {spanStartLine = 83, spanStartCol = 15, spanEndLine = 83, spanEndCol = 19}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "left"},Located {locSpan = Span {spanStartLine = 83, spanStartCol = 21, spanEndLine = 83, spanEndCol = 22}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PWildcard}]}]) (CLet "name" (CApp (CVar "Lune.String.trim") (CVar "left")) (CCase (CApp (CVar "Lune.String.isEmpty") (CVar "name")) [CoreAlt (PCon "Lune.Prelude.True" []) (CApp (CVar "Lune.System.Linux.Net.parseNamesFromLines") (CVar "rest")),CoreAlt (PCon "Lune.Prelude.False" []) (CApp (CApp (CVar "Lune.Prelude.Cons") (CVar "name")) (CApp (CVar "Lune.System.Linux.Net.parseNamesFromLines") (CVar "rest")))]))])])),CoreDecl "" (CInt 0),CoreDecl "Lune.System.Linux.Net.parseInterfaceCounters" (CLam [PVar "contents"] (CApp (CVar "Lune.System.Linux.Net.parseCountersFromLines") (CApp (CVar "Lune.String.lines") (CVar "contents")))),CoreDecl "" (CInt 0),CoreDecl "Lune.System.Linux.Net.parseCountersFromLines" (CLam [PVar "lines"] (CCase (CVar "lines") [CoreAlt (PCon "Lune.Prelude.Nil" []) (CVar "Lune.Prelude.Nil"),CoreAlt (PCon "Lune.Prelude.Cons" [Located {locSpan = Span {spanStartLine = 109, spanStartCol = 10, spanEndLine = 109, spanEndCol = 15}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "line"},Located {locSpan = Span {spanStartLine = 109, spanStartCol = 15, spanEndLine = 109, spanEndCol = 20}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "rest"}]) (CCase (CApp (CVar "Lune.System.Linux.Net.parseCountersLine") (CVar "line")) [CoreAlt (PCon "Lune.Prelude.Nothing" []) (CApp (CVar "Lune.System.Linux.Net.parseCountersFromLines") (CVar "rest")),CoreAlt (PCon "Lune.Prelude.Just" [Located {locSpan = Span {spanStartLine = 113, spanStartCol = 14, spanEndLine = 113, spanEndCol = 16}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "c"}]) (CApp (CApp (CVar "Lune.Prelude.Cons") (CVar "c")) (CApp (CVar "Lune.System.Linux.Net.parseCountersFromLines") (CVar "rest")))])])),CoreDecl "" (CInt 0),CoreDecl "Lune.System.Linux.Net.parseCountersLine" (CLam [PVar "line"] (CCase (CApp (CApp (CVar "Lune.System.Linux.Proc.splitOnce") (CString ":")) (CVar "line")) [CoreAlt (PCon "Lune.Prelude.Nothing" []) (CVar "Lune.Prelude.Nothing"),CoreAlt (PCon "Lune.Prelude.Just" [Located {locSpan = Span {spanStartLine = 125, spanStartCol = 10, spanEndLine = 125, spanEndCol = 24}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PCon "Lune.Prelude.Pair" [Located {locSpan = Span {spanStartLine = 125, spanStartCol = 11, spanEndLine = 125, spanEndCol = 15}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "left"},Located {locSpan = Span {spanStartLine = 125, spanStartCol = 17, spanEndLine = 125, spanEndCol = 22}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "right"}]}]) (CLet "name" (CApp (CVar "Lune.String.trim") (CVar "left")) (CLet "ws" (CApp (CVar "Lune.String.words") (CVar "right")) (CCase (CApp (CApp (CVar "Lune.List.get") (CInt 0)) (CVar "ws")) [CoreAlt (PCon "Lune.Prelude.Nothing" []) (CVar "Lune.Prelude.Nothing"),CoreAlt (PCon "Lune.Prelude.Just" [Located {locSpan = Span {spanStartLine = 133, spanStartCol = 16, spanEndLine = 133, spanEndCol = 22}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "rxStr"}]) (CCase (CApp (CApp (CVar "Lune.List.get") (CInt 8)) (CVar "ws")) [CoreAlt (PCon "Lune.Prelude.Nothing" []) (CVar "Lune.Prelude.Nothing"),CoreAlt (PCon "Lune.Prelude.Just" [Located {locSpan = Span {spanStartLine = 137, spanStartCol = 20, spanEndLine = 137, spanEndCol = 26}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "txStr"}]) (CCase (CApp (CVar "Lune.System.Linux.Proc.parseInt") (CVar "rxStr")) [CoreAlt (PCon "Lune.Prelude.Err" [Located {locSpan = Span {spanStartLine = 139, spanStartCol = 23, spanEndLine = 139, spanEndCol = 25}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PWildcard}]) (CVar "Lune.Prelude.Nothing"),CoreAlt (PCon "Lune.Prelude.Ok" [Located {locSpan = Span {spanStartLine = 141, spanStartCol = 22, spanEndLine = 141, spanEndCol = 25}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "rx"}]) (CCase (CApp (CVar "Lune.System.Linux.Proc.parseInt") (CVar "txStr")) [CoreAlt (PCon "Lune.Prelude.Err" [Located {locSpan = Span {spanStartLine = 143, spanStartCol = 27, spanEndLine = 143, spanEndCol = 29}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PWildcard}]) (CVar "Lune.Prelude.Nothing"),CoreAlt (PCon "Lune.Prelude.Ok" [Located {locSpan = Span {spanStartLine = 145, spanStartCol = 26, spanEndLine = 145, spanEndCol = 29}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "tx"}]) (CApp (CVar "Lune.Prelude.Just") (CRecord [("name",CVar "name"),("rxBytes",CVar "rx"),("txBytes",CVar "tx")]))])])])])))])),CoreDecl "" (CInt 0),CoreDecl "Lune.System.Linux.Net.uniqueStrings" (CLam [PVar "remaining",PVar "seenRev"] (CCase (CVar "remaining") [CoreAlt (PCon "Lune.Prelude.Nil" []) (CApp (CVar "Lune.List.reverse") (CVar "seenRev")),CoreAlt (PCon "Lune.Prelude.Cons" [Located {locSpan = Span {spanStartLine = 154, spanStartCol = 10, spanEndLine = 154, spanEndCol = 12}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "x"},Located {locSpan = Span {spanStartLine = 154, spanStartCol = 12, spanEndLine = 154, spanEndCol = 17}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "rest"}]) (CCase (CApp (CApp (CVar "Lune.System.Linux.Net.hasString") (CVar "x")) (CVar "seenRev")) [CoreAlt (PCon "Lune.Prelude.True" []) (CApp (CApp (CVar "Lune.System.Linux.Net.uniqueStrings") (CVar "rest")) (CVar "seenRev")),CoreAlt (PCon "Lune.Prelude.False" []) (CApp (CApp (CVar "Lune.System.Linux.Net.uniqueStrings") (CVar "rest")) (CApp (CApp (CVar "Lune.Prelude.Cons") (CVar "x")) (CVar "seenRev")))])])),CoreDecl "" (CInt 0),CoreDecl "Lune.System.Linux.Net.hasString" (CLam [PVar "s",PVar "xs"] (CCase (CVar "xs") [CoreAlt (PCon "Lune.Prelude.Nil" []) (CVar "Lune.Prelude.False"),CoreAlt (PCon "Lune.Prelude.Cons" [Located {locSpan = Span {spanStartLine = 166, spanStartCol = 10, spanEndLine = 166, spanEndCol = 12}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "x"},Located {locSpan = Span {spanStartLine = 166, spanStartCol = 12, spanEndLine = 166, spanEndCol = 17}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "rest"}]) (CCase (CApp (CApp (CVar "Lune.String.eq") (CVar "s")) (CVar "x")) [CoreAlt (PCon "Lune.Prelude.True" []) (CVar "Lune.Prelude.True"),CoreAlt (PCon "Lune.Prelude.False" []) (CApp (CApp (CVar "Lune.System.Linux.Net.hasString") (CVar "s")) (CVar "rest"))])])),CoreDecl "" (CInt 0),CoreDecl "Lune.System.Linux.Process.processMetrics" (CApp (CApp (CSelect (CVar "$dictMonad_Task") "andThen") (CVar "Lune.System.Linux.Process.pidUpperBound")) (CLam [PVar "upper"] (CLet "maxPid" (CApp (CApp (CVar "Lune.Int.min") (CVar "upper")) (CVar "Lune.System.Linux.Process.pidScanMax")) (CApp (CApp (CSelect (CVar "$dictMonad_Task") "andThen") (CApp (CApp (CApp (CApp (CVar "Lune.System.Linux.Process.scanPidsTopByRss") (CInt 1)) (CVar "maxPid")) (CInt 25)) (CVar "Lune.Prelude.Nil"))) (CLam [PVar "top"] (CLet "notes" (CApp (CApp (CVar "Lune.Prelude.Cons") (CApp (CApp (CVar "Lune.String.append") (CString "scanned_pids=1..")) (CApp (CVar "Lune.String.fromInt") (CVar "maxPid")))) (CVar "Lune.Prelude.Nil")) (CApp (CVar "Lune.Task.succeed") (CRecord [("processes",CVar "top"),("notes",CVar "notes")])))))))),CoreDecl "" (CInt 0),CoreDecl "Lune.System.Linux.Process.pidScanMax" (CInt 8192),CoreDecl "" (CInt 0),CoreDecl "Lune.System.Linux.Process.pidUpperBound" (CApp (CApp (CSelect (CVar "$dictMonad_Task") "andThen") (CApp (CVar "Lune.System.Linux.Proc.readFileOptional") (CString "/proc/loadavg"))) (CLam [PVar "load"] (CCase (CVar "load") [CoreAlt (PCon "Lune.Prelude.Nothing" []) (CApp (CVar "Lune.Task.succeed") (CInt 32768)),CoreAlt (PCon "Lune.Prelude.Just" [Located {locSpan = Span {spanStartLine = 50, spanStartCol = 12, spanEndLine = 50, spanEndCol = 14}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "s"}]) (CCase (CApp (CVar "Lune.System.Linux.Process.lastWord") (CApp (CVar "Lune.String.words") (CVar "s"))) [CoreAlt (PCon "Lune.Prelude.Nothing" []) (CApp (CVar "Lune.Task.succeed") (CInt 32768)),CoreAlt (PCon "Lune.Prelude.Just" [Located {locSpan = Span {spanStartLine = 54, spanStartCol = 16, spanEndLine = 54, spanEndCol = 18}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "w"}]) (CCase (CApp (CVar "Lune.System.Linux.Proc.parseInt") (CVar "w")) [CoreAlt (PCon "Lune.Prelude.Ok" [Located {locSpan = Span {spanStartLine = 56, spanStartCol = 18, spanEndLine = 56, spanEndCol = 20}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "n"}]) (CCase (CApp (CApp (CVar "Lune.Int.lte") (CVar "n")) (CInt 0)) [CoreAlt (PCon "Lune.Prelude.True" []) (CApp (CVar "Lune.Task.succeed") (CInt 32768)),CoreAlt (PCon "Lune.Prelude.False" []) (CApp (CVar "Lune.Task.succeed") (CVar "n"))]),CoreAlt (PCon "Lune.Prelude.Err" [Located {locSpan = Span {spanStartLine = 62, spanStartCol = 19, spanEndLine = 62, spanEndCol = 21}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PWildcard}]) (CApp (CVar "Lune.Task.succeed") (CInt 32768))])])]))),CoreDecl "" (CInt 0),CoreDecl "Lune.System.Linux.Process.lastWord" (CLam [PVar "ws"] (CCase (CVar "ws") [CoreAlt (PCon "Lune.Prelude.Nil" []) (CVar "Lune.Prelude.Nothing"),CoreAlt (PCon "Lune.Prelude.Cons" [Located {locSpan = Span {spanStartLine = 70, spanStartCol = 10, spanEndLine = 70, spanEndCol = 12}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "w"},Located {locSpan = Span {spanStartLine = 70, spanStartCol = 12, spanEndLine = 70, spanEndCol = 17}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "rest"}]) (CCase (CVar "rest") [CoreAlt (PCon "Lune.Prelude.Nil" []) (CApp (CVar "Lune.Prelude.Just") (CVar "w")),CoreAlt PWildcard (CApp (CVar "Lune.System.Linux.Process.lastWord") (CVar "rest"))])])),CoreDecl "" (CInt 0),CoreDecl "Lune.System.Linux.Process.scanPidsTopByRss" (CLam [PVar "pid",PVar "maxPid",PVar "limit",PVar "top"] (CCase (CApp (CApp (CVar "Lune.Int.gte") (CVar "pid")) (CVar "maxPid")) [CoreAlt (PCon "Lune.Prelude.True" []) (CCase (CApp (CApp (CVar "Lune.Int.eq") (CVar "pid")) (CVar "maxPid")) [CoreAlt (PCon "Lune.Prelude.True" []) (CApp (CApp (CSelect (CVar "$dictMonad_Task") "andThen") (CApp (CApp (CApp (CVar "Lune.System.Linux.Process.scanOne") (CVar "pid")) (CVar "limit")) (CVar "top"))) (CLam [PVar "top2"] (CApp (CVar "Lune.Task.succeed") (CVar "top2")))),CoreAlt (PCon "Lune.Prelude.False" []) (CApp (CVar "Lune.Task.succeed") (CVar "top"))]),CoreAlt (PCon "Lune.Prelude.False" []) (CApp (CApp (CSelect (CVar "$dictMonad_Task") "andThen") (CApp (CApp (CApp (CVar "Lune.System.Linux.Process.scanOne") (CVar "pid")) (CVar "limit")) (CVar "top"))) (CLam [PVar "top2"] (CApp (CApp (CApp (CApp (CVar "Lune.System.Linux.Process.scanPidsTopByRss") (CApp (CApp (CVar "Lune.Int.add") (CVar "pid")) (CInt 1))) (CVar "maxPid")) (CVar "limit")) (CVar "top2"))))])),CoreDecl "" (CInt 0),CoreDecl "Lune.System.Linux.Process.scanOne" (CLam [PVar "pid",PVar "limit",PVar "top"] (CApp (CApp (CSelect (CVar "$dictMonad_Task") "andThen") (CApp (CVar "Lune.System.Linux.Proc.readFileOptional") (CApp (CVar "Lune.System.Linux.Process.procStatPath") (CVar "pid")))) (CLam [PVar "stat"] (CCase (CVar "stat") [CoreAlt (PCon "Lune.Prelude.Nothing" []) (CApp (CVar "Lune.Task.succeed") (CVar "top")),CoreAlt (PCon "Lune.Prelude.Just" [Located {locSpan = Span {spanStartLine = 137, spanStartCol = 12, spanEndLine = 137, spanEndCol = 17}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "line"}]) (CCase (CApp (CApp (CVar "Lune.System.Linux.Process.parseProcStat") (CVar "pid")) (CVar "line")) [CoreAlt (PCon "Lune.Prelude.Nothing" []) (CApp (CVar "Lune.Task.succeed") (CVar "top")),CoreAlt (PCon "Lune.Prelude.Just" [Located {locSpan = Span {spanStartLine = 141, spanStartCol = 16, spanEndLine = 141, spanEndCol = 18}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "p"}]) (CApp (CVar "Lune.Task.succeed") (CApp (CApp (CVar "Lune.System.Linux.Process.take") (CVar "limit")) (CApp (CApp (CVar "Lune.System.Linux.Process.insertByRss") (CVar "p")) (CVar "top"))))])])))),CoreDecl "" (CInt 0),CoreDecl "Lune.System.Linux.Process.procStatPath" (CLam [PVar "pid"] (CApp (CApp (CVar "Lune.String.append") (CString "/proc/")) (CApp (CApp (CVar "Lune.String.append") (CApp (CVar "Lune.String.fromInt") (CVar "pid"))) (CString "/stat")))),CoreDecl "" (CInt 0),CoreDecl "Lune.System.Linux.Process.parseProcStat" (CLam [PVar "pid",PVar "line"] (CCase (CApp (CApp (CVar "Lune.System.Linux.Proc.splitOnce") (CString "(")) (CVar "line")) [CoreAlt (PCon "Lune.Prelude.Nothing" []) (CVar "Lune.Prelude.Nothing"),CoreAlt (PCon "Lune.Prelude.Just" [Located {locSpan = Span {spanStartLine = 161, spanStartCol = 10, spanEndLine = 161, spanEndCol = 27}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PCon "Lune.Prelude.Pair" [Located {locSpan = Span {spanStartLine = 161, spanStartCol = 11, spanEndLine = 161, spanEndCol = 12}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PWildcard},Located {locSpan = Span {spanStartLine = 161, spanStartCol = 14, spanEndLine = 161, spanEndCol = 25}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "afterLParen"}]}]) (CCase (CApp (CApp (CVar "Lune.System.Linux.Proc.splitOnce") (CString ")")) (CVar "afterLParen")) [CoreAlt (PCon "Lune.Prelude.Nothing" []) (CVar "Lune.Prelude.Nothing"),CoreAlt (PCon "Lune.Prelude.Just" [Located {locSpan = Span {spanStartLine = 165, spanStartCol = 14, spanEndLine = 165, spanEndCol = 34}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PCon "Lune.Prelude.Pair" [Located {locSpan = Span {spanStartLine = 165, spanStartCol = 15, spanEndLine = 165, spanEndCol = 19}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "comm"},Located {locSpan = Span {spanStartLine = 165, spanStartCol = 21, spanEndLine = 165, spanEndCol = 32}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "afterRParen"}]}]) (CLet "rest" (CApp (CVar "Lune.String.trim") (CVar "afterRParen")) (CLet "ws" (CApp (CVar "Lune.String.words") (CVar "rest")) (CCase (CApp (CApp (CVar "Lune.List.get") (CInt 11)) (CVar "ws")) [CoreAlt (PCon "Lune.Prelude.Nothing" []) (CVar "Lune.Prelude.Nothing"),CoreAlt (PCon "Lune.Prelude.Just" [Located {locSpan = Span {spanStartLine = 173, spanStartCol = 20, spanEndLine = 173, spanEndCol = 29}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "utimeStr"}]) (CCase (CApp (CApp (CVar "Lune.List.get") (CInt 12)) (CVar "ws")) [CoreAlt (PCon "Lune.Prelude.Nothing" []) (CVar "Lune.Prelude.Nothing"),CoreAlt (PCon "Lune.Prelude.Just" [Located {locSpan = Span {spanStartLine = 177, spanStartCol = 24, spanEndLine = 177, spanEndCol = 33}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "stimeStr"}]) (CCase (CApp (CApp (CVar "Lune.List.get") (CInt 21)) (CVar "ws")) [CoreAlt (PCon "Lune.Prelude.Nothing" []) (CVar "Lune.Prelude.Nothing"),CoreAlt (PCon "Lune.Prelude.Just" [Located {locSpan = Span {spanStartLine = 181, spanStartCol = 28, spanEndLine = 181, spanEndCol = 35}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "rssStr"}]) (CCase (CApp (CVar "Lune.System.Linux.Proc.parseInt") (CVar "utimeStr")) [CoreAlt (PCon "Lune.Prelude.Err" [Located {locSpan = Span {spanStartLine = 183, spanStartCol = 31, spanEndLine = 183, spanEndCol = 33}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PWildcard}]) (CVar "Lune.Prelude.Nothing"),CoreAlt (PCon "Lune.Prelude.Ok" [Located {locSpan = Span {spanStartLine = 185, spanStartCol = 30, spanEndLine = 185, spanEndCol = 33}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "ut"}]) (CCase (CApp (CVar "Lune.System.Linux.Proc.parseInt") (CVar "stimeStr")) [CoreAlt (PCon "Lune.Prelude.Err" [Located {locSpan = Span {spanStartLine = 187, spanStartCol = 35, spanEndLine = 187, spanEndCol = 37}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PWildcard}]) (CVar "Lune.Prelude.Nothing"),CoreAlt (PCon "Lune.Prelude.Ok" [Located {locSpan = Span {spanStartLine = 189, spanStartCol = 34, spanEndLine = 189, spanEndCol = 37}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "st"}]) (CCase (CApp (CVar "Lune.System.Linux.Proc.parseInt") (CVar "rssStr")) [CoreAlt (PCon "Lune.Prelude.Err" [Located {locSpan = Span {spanStartLine = 191, spanStartCol = 39, spanEndLine = 191, spanEndCol = 41}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PWildcard}]) (CApp (CVar "Lune.Prelude.Just") (CRecord [("pid",CVar "pid"),("comm",CVar "comm"),("utime",CVar "ut"),("stime",CVar "st"),("rssBytes",CVar "Lune.Prelude.Nothing")])),CoreAlt (PCon "Lune.Prelude.Ok" [Located {locSpan = Span {spanStartLine = 199, spanStartCol = 38, spanEndLine = 199, spanEndCol = 47}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "rssPages"}]) (CApp (CVar "Lune.Prelude.Just") (CRecord [("pid",CVar "pid"),("comm",CVar "comm"),("utime",CVar "ut"),("stime",CVar "st"),("rssBytes",CApp (CVar "Lune.Prelude.Just") (CApp (CApp (CVar "Lune.Int.mul") (CVar "rssPages")) (CVar "Lune.System.Linux.Process.pageSizeBytes")))]))])])])])])])))])])),CoreDecl "" (CInt 0),CoreDecl "Lune.System.Linux.Process.pageSizeBytes" (CInt 4096),CoreDecl "" (CInt 0),CoreDecl "Lune.System.Linux.Process.insertByRss" (CLam [PVar "p",PVar "ps"] (CCase (CVar "ps") [CoreAlt (PCon "Lune.Prelude.Nil" []) (CApp (CApp (CVar "Lune.Prelude.Cons") (CVar "p")) (CVar "Lune.Prelude.Nil")),CoreAlt (PCon "Lune.Prelude.Cons" [Located {locSpan = Span {spanStartLine = 237, spanStartCol = 10, spanEndLine = 237, spanEndCol = 12}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "q"},Located {locSpan = Span {spanStartLine = 237, spanStartCol = 12, spanEndLine = 237, spanEndCol = 17}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "rest"}]) (CCase (CApp (CApp (CVar "Lune.Int.gte") (CApp (CVar "Lune.System.Linux.Process.rssOrZero") (CSelect (CVar "p") "rssBytes"))) (CApp (CVar "Lune.System.Linux.Process.rssOrZero") (CSelect (CVar "q") "rssBytes"))) [CoreAlt (PCon "Lune.Prelude.True" []) (CApp (CApp (CVar "Lune.Prelude.Cons") (CVar "p")) (CVar "ps")),CoreAlt (PCon "Lune.Prelude.False" []) (CApp (CApp (CVar "Lune.Prelude.Cons") (CVar "q")) (CApp (CApp (CVar "Lune.System.Linux.Process.insertByRss") (CVar "p")) (CVar "rest")))])])),CoreDecl "" (CInt 0),CoreDecl "Lune.System.Linux.Process.rssOrZero" (CLam [PVar "m"] (CCase (CVar "m") [CoreAlt (PCon "Lune.Prelude.Nothing" []) (CInt 0),CoreAlt (PCon "Lune.Prelude.Just" [Located {locSpan = Span {spanStartLine = 249, spanStartCol = 10, spanEndLine = 249, spanEndCol = 12}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "n"}]) (CVar "n")])),CoreDecl "" (CInt 0),CoreDecl "Lune.System.Linux.Process.take" (CLam [PVar "n",PVar "xs"] (CCase (CApp (CApp (CVar "Lune.Int.lte") (CVar "n")) (CInt 0)) [CoreAlt (PCon "Lune.Prelude.True" []) (CVar "Lune.Prelude.Nil"),CoreAlt (PCon "Lune.Prelude.False" []) (CCase (CVar "xs") [CoreAlt (PCon "Lune.Prelude.Nil" []) (CVar "Lune.Prelude.Nil"),CoreAlt (PCon "Lune.Prelude.Cons" [Located {locSpan = Span {spanStartLine = 261, spanStartCol = 14, spanEndLine = 261, spanEndCol = 16}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "x"},Located {locSpan = Span {spanStartLine = 261, spanStartCol = 16, spanEndLine = 261, spanEndCol = 21}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "rest"}]) (CApp (CApp (CVar "Lune.Prelude.Cons") (CVar "x")) (CApp (CApp (CVar "Lune.System.Linux.Process.take") (CApp (CApp (CVar "Lune.Int.sub") (CVar "n")) (CInt 1))) (CVar "rest")))])])),CoreDecl "" (CInt 0),CoreDecl "" (CInt 0),CoreDecl "" (CInt 0),CoreDecl "" (CInt 0),CoreDecl "" (CInt 0),CoreDecl "Lune.System.errorToString" (CLam [PVar "err"] (CCase (CVar "err") [CoreAlt (PCon "Lune.System.NotImplemented" [Located {locSpan = Span {spanStartLine = 107, spanStartCol = 20, spanEndLine = 107, spanEndCol = 23}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "os"}]) (CApp (CApp (CVar "Lune.String.append") (CString "NotImplemented(")) (CApp (CApp (CVar "Lune.String.append") (CApp (CVar "Lune.System.osToString") (CVar "os"))) (CString ")"))),CoreAlt (PCon "Lune.System.ReadError" [Located {locSpan = Span {spanStartLine = 109, spanStartCol = 15, spanEndLine = 109, spanEndCol = 19}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "msg"}]) (CApp (CApp (CVar "Lune.String.append") (CString "ReadError(")) (CApp (CApp (CVar "Lune.String.append") (CVar "msg")) (CString ")"))),CoreAlt (PCon "Lune.System.ParseError" [Located {locSpan = Span {spanStartLine = 111, spanStartCol = 16, spanEndLine = 111, spanEndCol = 20}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "msg"}]) (CApp (CApp (CVar "Lune.String.append") (CString "ParseError(")) (CApp (CApp (CVar "Lune.String.append") (CVar "msg")) (CString ")"))),CoreAlt (PCon "Lune.System.PermissionDenied" [Located {locSpan = Span {spanStartLine = 113, spanStartCol = 22, spanEndLine = 113, spanEndCol = 26}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "msg"}]) (CApp (CApp (CVar "Lune.String.append") (CString "PermissionDenied(")) (CApp (CApp (CVar "Lune.String.append") (CVar "msg")) (CString ")")))])),CoreDecl "" (CInt 0),CoreDecl "Lune.System.osToString" (CLam [PVar "os"] (CCase (CVar "os") [CoreAlt (PCon "Lune.System.Linux" []) (CString "linux"),CoreAlt (PCon "Lune.System.Darwin" []) (CString "darwin"),CoreAlt (PCon "Lune.System.Windows" []) (CString "windows")])),CoreDecl "" (CInt 0),CoreDecl "Lune.System.archToString" (CLam [PVar "arch"] (CCase (CVar "arch") [CoreAlt (PCon "Lune.System.X86_64" []) (CString "x86_64"),CoreAlt (PCon "Lune.System.AArch64" []) (CString "aarch64"),CoreAlt (PCon "Lune.System.RiscV64" []) (CString "riscv64"),CoreAlt (PCon "Lune.System.UnknownArch" [Located {locSpan = Span {spanStartLine = 135, spanStartCol = 17, spanEndLine = 135, spanEndCol = 19}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "s"}]) (CApp (CApp (CVar "Lune.String.append") (CString "unknown(")) (CApp (CApp (CVar "Lune.String.append") (CVar "s")) (CString ")")))])),CoreDecl "" (CInt 0),CoreDecl "" (CInt 0),CoreDecl "" (CInt 0),CoreDecl "" (CInt 0),CoreDecl "" (CInt 0),CoreDecl "" (CInt 0),CoreDecl "" (CInt 0),CoreDecl "" (CInt 0),CoreDecl "" (CInt 0),CoreDecl "" (CInt 0),CoreDecl "" (CInt 0),CoreDecl "" (CInt 0),CoreDecl "" (CInt 0),CoreDecl "" (CInt 0),CoreDecl "" (CInt 0),CoreDecl "" (CInt 0),CoreDecl "" (CInt 0),CoreDecl "" (CInt 0),CoreDecl "" (CInt 0),CoreDecl "" (CInt 0),CoreDecl "" (CInt 0),CoreDecl "" (CInt 0),CoreDecl "" (CInt 0),CoreDecl "" (CInt 0),CoreDecl "" (CInt 0),CoreDecl "" (CInt 0),CoreDecl "" (CInt 0),CoreDecl "Lune.System.platform" (CApp (CApp (CSelect (CVar "$dictMonad_Task") "andThen") (CVar "Lune.System.detectOS")) (CLam [PVar "os"] (CApp (CApp (CSelect (CVar "$dictMonad_Task") "andThen") (CCase (CVar "os") [CoreAlt (PCon "Lune.System.Linux" []) (CVar "Lune.System.linuxArch"),CoreAlt (PCon "Lune.System.Darwin" []) (CApp (CVar "Lune.Task.succeed") (CApp (CVar "Lune.System.UnknownArch") (CString "darwin"))),CoreAlt (PCon "Lune.System.Windows" []) (CApp (CVar "Lune.Task.succeed") (CApp (CVar "Lune.System.UnknownArch") (CString "windows")))])) (CLam [PVar "arch"] (CApp (CVar "Lune.Task.succeed") (CRecord [("os",CVar "os"),("arch",CVar "arch")])))))),CoreDecl "" (CInt 0),CoreDecl "Lune.System.linuxArch" (CApp (CApp (CSelect (CVar "$dictMonad_Task") "andThen") (CApp (CApp (CVar "Lune.Task.mapError") (CLam [PWildcard] (CApp (CVar "Lune.System.ReadError") (CString "/proc/cpuinfo")))) (CApp (CVar "Lune.IO.readFile") (CString "/proc/cpuinfo")))) (CLam [PVar "contents"] (CApp (CVar "Lune.Task.succeed") (CApp (CVar "Lune.System.archFromCpuinfo") (CVar "contents"))))),CoreDecl "" (CInt 0),CoreDecl "Lune.System.archFromCpuinfo" (CLam [PVar "contents"] (CLet "lower" (CApp (CVar "Lune.String.toLower") (CVar "contents")) (CCase (CApp (CApp (CVar "Lune.String.contains") (CString "riscv")) (CVar "lower")) [CoreAlt (PCon "Lune.Prelude.True" []) (CVar "Lune.System.RiscV64"),CoreAlt (PCon "Lune.Prelude.False" []) (CCase (CApp (CApp (CVar "Lune.String.contains") (CString "aarch64")) (CVar "lower")) [CoreAlt (PCon "Lune.Prelude.True" []) (CVar "Lune.System.AArch64"),CoreAlt (PCon "Lune.Prelude.False" []) (CCase (CApp (CApp (CVar "Lune.String.contains") (CString "x86_64")) (CVar "lower")) [CoreAlt (PCon "Lune.Prelude.True" []) (CVar "Lune.System.X86_64"),CoreAlt (PCon "Lune.Prelude.False" []) (CCase (CApp (CApp (CVar "Lune.String.contains") (CString " lm ")) (CApp (CApp (CVar "Lune.String.append") (CString " ")) (CApp (CApp (CVar "Lune.String.append") (CVar "lower")) (CString " ")))) [CoreAlt (PCon "Lune.Prelude.True" []) (CVar "Lune.System.X86_64"),CoreAlt (PCon "Lune.Prelude.False" []) (CApp (CVar "Lune.System.UnknownArch") (CString "unknown"))])])])]))),CoreDecl "" (CInt 0),CoreDecl "Lune.System.detectOS" (CApp (CApp (CSelect (CVar "$dictMonad_Task") "andThen") (CApp (CVar "Lune.System.canReadFile") (CString "/proc/cpuinfo"))) (CLam [PVar "isLinux"] (CCase (CVar "isLinux") [CoreAlt (PCon "Lune.Prelude.True" []) (CApp (CVar "Lune.Task.succeed") (CVar "Lune.System.Linux")),CoreAlt (PCon "Lune.Prelude.False" []) (CApp (CApp (CSelect (CVar "$dictMonad_Task") "andThen") (CApp (CVar "Lune.System.canReadFile") (CString "/System/Library/CoreServices/SystemVersion.plist"))) (CLam [PVar "isDarwin"] (CCase (CVar "isDarwin") [CoreAlt (PCon "Lune.Prelude.True" []) (CApp (CVar "Lune.Task.succeed") (CVar "Lune.System.Darwin")),CoreAlt (PCon "Lune.Prelude.False" []) (CApp (CApp (CSelect (CVar "$dictMonad_Task") "andThen") (CApp (CVar "Lune.System.canReadFile") (CString "C:\\\\Windows\\\\System32\\\\drivers\\\\etc\\\\hosts"))) (CLam [PVar "isWindows"] (CCase (CVar "isWindows") [CoreAlt (PCon "Lune.Prelude.True" []) (CApp (CVar "Lune.Task.succeed") (CVar "Lune.System.Windows")),CoreAlt (PCon "Lune.Prelude.False" []) (CApp (CVar "Lune.Task.succeed") (CVar "Lune.System.Linux"))])))])))]))),CoreDecl "" (CInt 0),CoreDecl "Lune.System.canReadFile" (CLam [PVar "path"] (CApp (CApp (CVar "Lune.Task.map") (CVar "Lune.System.resultOk")) (CApp (CVar "Lune.Task.result") (CApp (CVar "Lune.IO.readFile") (CVar "path"))))),CoreDecl "" (CInt 0),CoreDecl "Lune.System.resultOk" (CLam [PVar "r"] (CCase (CVar "r") [CoreAlt (PCon "Lune.Prelude.Ok" [Located {locSpan = Span {spanStartLine = 436, spanStartCol = 8, spanEndLine = 436, spanEndCol = 10}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PWildcard}]) (CVar "Lune.Prelude.True"),CoreAlt (PCon "Lune.Prelude.Err" [Located {locSpan = Span {spanStartLine = 438, spanStartCol = 9, spanEndLine = 438, spanEndCol = 11}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PWildcard}]) (CVar "Lune.Prelude.False")])),CoreDecl "" (CInt 0),CoreDecl "Lune.System.inventory" (CApp (CApp (CSelect (CVar "$dictMonad_Task") "andThen") (CVar "Lune.System.platform")) (CLam [PVar "p"] (CCase (CSelect (CVar "p") "os") [CoreAlt (PCon "Lune.System.Linux" []) (CApp (CApp (CSelect (CVar "$dictMonad_Task") "andThen") (CApp (CApp (CVar "Lune.Task.mapError") (CVar "Lune.System.mapLinuxError")) (CVar "Lune.System.Linux.Cpu.cpuInfo"))) (CLam [PVar "cpu"] (CApp (CApp (CSelect (CVar "$dictMonad_Task") "andThen") (CApp (CApp (CVar "Lune.Task.mapError") (CVar "Lune.System.mapLinuxError")) (CVar "Lune.System.Linux.Mem.memInfo"))) (CLam [PVar "mem"] (CApp (CApp (CSelect (CVar "$dictMonad_Task") "andThen") (CApp (CApp (CVar "Lune.Task.mapError") (CVar "Lune.System.mapLinuxError")) (CVar "Lune.System.Linux.Disk.disks"))) (CLam [PVar "disks"] (CApp (CApp (CSelect (CVar "$dictMonad_Task") "andThen") (CApp (CApp (CVar "Lune.Task.mapError") (CVar "Lune.System.mapLinuxError")) (CVar "Lune.System.Linux.Disk.mounts"))) (CLam [PVar "mounts"] (CApp (CApp (CSelect (CVar "$dictMonad_Task") "andThen") (CApp (CApp (CVar "Lune.Task.mapError") (CVar "Lune.System.mapLinuxError")) (CVar "Lune.System.Linux.Net.interfaces"))) (CLam [PVar "netIfs"] (CApp (CApp (CSelect (CVar "$dictMonad_Task") "andThen") (CApp (CApp (CVar "Lune.Task.mapError") (CVar "Lune.System.mapLinuxError")) (CVar "Lune.System.Linux.GpuAmd.inventory"))) (CLam [PVar "amdGpus"] (CLet "gpus" (CApp (CApp (CVar "Lune.List.map") (CLam [PVar "g"] (CRecord [("vendor",CVar "Lune.System.Amd"),("name",CSelect (CVar "g") "name"),("pci",CSelect (CVar "g") "pci"),("driver",CSelect (CVar "g") "driver"),("vramTotalBytes",CSelect (CVar "g") "vramTotalBytes")]))) (CVar "amdGpus")) (CApp (CVar "Lune.Task.succeed") (CRecord [("platform",CVar "p"),("cpu",CVar "cpu"),("memory",CVar "mem"),("disks",CVar "disks"),("mounts",CVar "mounts"),("net",CVar "netIfs"),("gpus",CVar "gpus")]))))))))))))))),CoreAlt (PCon "Lune.System.Darwin" []) (CApp (CVar "Lune.Task.fail") (CApp (CVar "Lune.System.NotImplemented") (CVar "Lune.System.Darwin"))),CoreAlt (PCon "Lune.System.Windows" []) (CApp (CVar "Lune.Task.fail") (CApp (CVar "Lune.System.NotImplemented") (CVar "Lune.System.Windows")))]))),CoreDecl "" (CInt 0),CoreDecl "Lune.System.sample" (CApp (CApp (CSelect (CVar "$dictMonad_Task") "andThen") (CVar "Lune.System.platform")) (CLam [PVar "p"] (CCase (CSelect (CVar "p") "os") [CoreAlt (PCon "Lune.System.Linux" []) (CApp (CApp (CSelect (CVar "$dictMonad_Task") "andThen") (CVar "Lune.System.nowMs")) (CLam [PVar "atMs"] (CApp (CApp (CSelect (CVar "$dictMonad_Task") "andThen") (CApp (CApp (CVar "Lune.Task.mapError") (CVar "Lune.System.mapLinuxError")) (CVar "Lune.System.Linux.Cpu.cpuMetrics"))) (CLam [PVar "cpu"] (CApp (CApp (CSelect (CVar "$dictMonad_Task") "andThen") (CApp (CApp (CVar "Lune.Task.mapError") (CVar "Lune.System.mapLinuxError")) (CVar "Lune.System.Linux.Mem.memMetrics"))) (CLam [PVar "mem"] (CApp (CApp (CSelect (CVar "$dictMonad_Task") "andThen") (CApp (CApp (CVar "Lune.Task.mapError") (CVar "Lune.System.mapLinuxError")) (CVar "Lune.System.Linux.Disk.diskMetrics"))) (CLam [PVar "disk"] (CApp (CApp (CSelect (CVar "$dictMonad_Task") "andThen") (CApp (CApp (CVar "Lune.Task.mapError") (CVar "Lune.System.mapLinuxError")) (CVar "Lune.System.Linux.Net.netMetrics"))) (CLam [PVar "net"] (CApp (CApp (CSelect (CVar "$dictMonad_Task") "andThen") (CApp (CApp (CVar "Lune.Task.mapError") (CVar "Lune.System.mapLinuxError")) (CVar "Lune.System.Linux.GpuAmd.metrics"))) (CLam [PVar "gpu"] (CApp (CApp (CSelect (CVar "$dictMonad_Task") "andThen") (CApp (CApp (CVar "Lune.Task.mapError") (CVar "Lune.System.mapLinuxError")) (CVar "Lune.System.Linux.Process.processMetrics"))) (CLam [PVar "procs"] (CApp (CVar "Lune.Task.succeed") (CRecord [("atMs",CVar "atMs"),("cpu",CVar "cpu"),("mem",CVar "mem"),("disk",CVar "disk"),("net",CVar "net"),("gpu",CVar "gpu"),("procs",CVar "procs")])))))))))))))))),CoreAlt (PCon "Lune.System.Darwin" []) (CApp (CVar "Lune.Task.fail") (CApp (CVar "Lune.System.NotImplemented") (CVar "Lune.System.Darwin"))),CoreAlt (PCon "Lune.System.Windows" []) (CApp (CVar "Lune.Task.fail") (CApp (CVar "Lune.System.NotImplemented") (CVar "Lune.System.Windows")))]))),CoreDecl "" (CInt 0),CoreDecl "Lune.System.nowMs" (CApp (CApp (CSelect (CVar "$dictMonad_Task") "andThen") (CVar "Lune.Time.now")) (CLam [PVar "t"] (CApp (CVar "Lune.Task.succeed") (CApp (CApp (CVar "Lune.Int.div") (CApp (CVar "Lune.Time.toMicros") (CVar "t"))) (CInt 1000))))),CoreDecl "" (CInt 0),CoreDecl "Lune.System.mapLinuxError" (CLam [PVar "msg"] (CCase (CApp (CApp (CVar "Lune.String.startsWith") (CString "parse:")) (CVar "msg")) [CoreAlt (PCon "Lune.Prelude.True" []) (CApp (CVar "Lune.System.ParseError") (CVar "msg")),CoreAlt (PCon "Lune.Prelude.False" []) (CApp (CVar "Lune.System.ReadError") (CVar "msg"))])),CoreDecl "" (CInt 0),CoreDecl "Lune.System.diff" (CLam [PVar "a",PVar "b"] (CLet "dtMs0" (CApp (CApp (CVar "Lune.Int.sub") (CSelect (CVar "b") "atMs")) (CSelect (CVar "a") "atMs")) (CLet "dtMs" (CCase (CApp (CApp (CVar "Lune.Int.lte") (CVar "dtMs0")) (CInt 0)) [CoreAlt (PCon "Lune.Prelude.True" []) (CInt 0),CoreAlt (PCon "Lune.Prelude.False" []) (CVar "dtMs0")]) (CLet "cpuDiff" (CApp (CApp (CVar "Lune.System.cpuDiffBetween") (CSelect (CVar "a") "cpu")) (CSelect (CVar "b") "cpu")) (CLet "diskDiff" (CApp (CApp (CApp (CVar "Lune.System.diskDiffBetween") (CVar "dtMs")) (CSelect (CVar "a") "disk")) (CSelect (CVar "b") "disk")) (CLet "netDiff" (CApp (CApp (CApp (CVar "Lune.System.netDiffBetween") (CVar "dtMs")) (CSelect (CVar "a") "net")) (CSelect (CVar "b") "net")) (CLet "gpuDiff" (CRecord [("devices",CSelect (CSelect (CVar "b") "gpu") "devices")]) (CLet "procsDiff" (CApp (CApp (CVar "Lune.System.processDiffBetween") (CSelect (CVar "a") "procs")) (CSelect (CVar "b") "procs")) (CRecord [("dtMs",CVar "dtMs"),("cpu",CVar "cpuDiff"),("disk",CVar "diskDiff"),("net",CVar "netDiff"),("gpu",CVar "gpuDiff"),("procs",CVar "procsDiff")]))))))))),CoreDecl "" (CInt 0),CoreDecl "Lune.System.cpuDiffBetween" (CLam [PVar "a",PVar "b"] (CRecord [("usagePercent",CApp (CApp (CVar "Lune.System.cpuUsagePercent") (CSelect (CVar "a") "total")) (CSelect (CVar "b") "total")),("perCoreUsagePercent",CApp (CApp (CApp (CVar "Lune.System.listZipWith") (CVar "Lune.System.cpuUsagePercent")) (CSelect (CVar "a") "cores")) (CSelect (CVar "b") "cores")),("loadAvg1",CSelect (CVar "b") "loadAvg1"),("loadAvg5",CSelect (CVar "b") "loadAvg5"),("loadAvg15",CSelect (CVar "b") "loadAvg15")])),CoreDecl "" (CInt 0),CoreDecl "Lune.System.cpuUsagePercent" (CLam [PVar "a",PVar "b"] (CLet "idleA" (CApp (CApp (CVar "Lune.Int.add") (CSelect (CVar "a") "idle")) (CSelect (CVar "a") "iowait")) (CLet "idleB" (CApp (CApp (CVar "Lune.Int.add") (CSelect (CVar "b") "idle")) (CSelect (CVar "b") "iowait")) (CLet "nonIdleA" (CApp (CApp (CVar "Lune.Int.add") (CSelect (CVar "a") "steal")) (CApp (CApp (CVar "Lune.Int.add") (CSelect (CVar "a") "softirq")) (CApp (CApp (CVar "Lune.Int.add") (CSelect (CVar "a") "irq")) (CApp (CApp (CVar "Lune.Int.add") (CSelect (CVar "a") "system")) (CApp (CApp (CVar "Lune.Int.add") (CSelect (CVar "a") "nice")) (CSelect (CVar "a") "user")))))) (CLet "nonIdleB" (CApp (CApp (CVar "Lune.Int.add") (CSelect (CVar "b") "steal")) (CApp (CApp (CVar "Lune.Int.add") (CSelect (CVar "b") "softirq")) (CApp (CApp (CVar "Lune.Int.add") (CSelect (CVar "b") "irq")) (CApp (CApp (CVar "Lune.Int.add") (CSelect (CVar "b") "system")) (CApp (CApp (CVar "Lune.Int.add") (CSelect (CVar "b") "nice")) (CSelect (CVar "b") "user")))))) (CLet "totalA" (CApp (CApp (CVar "Lune.Int.add") (CVar "idleA")) (CVar "nonIdleA")) (CLet "totalB" (CApp (CApp (CVar "Lune.Int.add") (CVar "idleB")) (CVar "nonIdleB")) (CLet "totalD" (CApp (CApp (CVar "Lune.Int.sub") (CVar "totalB")) (CVar "totalA")) (CLet "idleD" (CApp (CApp (CVar "Lune.Int.sub") (CVar "idleB")) (CVar "idleA")) (CCase (CApp (CApp (CVar "Lune.Int.lte") (CVar "totalD")) (CInt 0)) [CoreAlt (PCon "Lune.Prelude.True" []) (CInt 0),CoreAlt (PCon "Lune.Prelude.False" []) (CApp (CApp (CVar "Lune.Int.div") (CApp (CApp (CVar "Lune.Int.mul") (CApp (CApp (CVar "Lune.Int.sub") (CVar "totalD")) (CVar "idleD"))) (CInt 100))) (CVar "totalD"))])))))))))),CoreDecl "" (CInt 0),CoreDecl "Lune.System.diskDiffBetween" (CLam [PVar "dtMs",PVar "a",PVar "b"] (CLet "perDev" (CApp (CApp (CApp (CVar "Lune.System.listZipByNameDisk") (CVar "dtMs")) (CSelect (CVar "a") "devices")) (CSelect (CVar "b") "devices")) (CLet "totals" (CApp (CApp (CApp (CVar "Lune.List.foldl") (CLam [PVar "acc",PVar "d"] (CRecord [("read",CApp (CApp (CVar "Lune.Int.add") (CSelect (CVar "acc") "read")) (CSelect (CVar "d") "readBytesPerSec")),("write",CApp (CApp (CVar "Lune.Int.add") (CSelect (CVar "acc") "write")) (CSelect (CVar "d") "writeBytesPerSec"))]))) (CRecord [("read",CInt 0),("write",CInt 0)])) (CVar "perDev")) (CRecord [("readBytesPerSec",CSelect (CVar "totals") "read"),("writeBytesPerSec",CSelect (CVar "totals") "write"),("devices",CVar "perDev")])))),CoreDecl "" (CInt 0),CoreDecl "Lune.System.netDiffBetween" (CLam [PVar "dtMs",PVar "a",PVar "b"] (CLet "perIf" (CApp (CApp (CApp (CVar "Lune.System.listZipByNameNet") (CVar "dtMs")) (CSelect (CVar "a") "interfaces")) (CSelect (CVar "b") "interfaces")) (CLet "totals" (CApp (CApp (CApp (CVar "Lune.List.foldl") (CLam [PVar "acc",PVar "d"] (CRecord [("rx",CApp (CApp (CVar "Lune.Int.add") (CSelect (CVar "acc") "rx")) (CSelect (CVar "d") "rxBytesPerSec")),("tx",CApp (CApp (CVar "Lune.Int.add") (CSelect (CVar "acc") "tx")) (CSelect (CVar "d") "txBytesPerSec"))]))) (CRecord [("rx",CInt 0),("tx",CInt 0)])) (CVar "perIf")) (CRecord [("rxBytesPerSec",CSelect (CVar "totals") "rx"),("txBytesPerSec",CSelect (CVar "totals") "tx"),("interfaces",CVar "perIf")])))),CoreDecl "" (CInt 0),CoreDecl "Lune.System.processDiffBetween" (CLam [PVar "a",PVar "b"] (CLet "deltas" (CApp (CApp (CVar "Lune.System.processDeltas") (CSelect (CVar "a") "processes")) (CSelect (CVar "b") "processes")) (CLet "top" (CApp (CApp (CVar "Lune.System.takeTopByCpuDelta") (CInt 25)) (CVar "deltas")) (CRecord [("top",CVar "top"),("notes",CApp (CApp (CVar "Lune.System.listAppend") (CSelect (CVar "a") "notes")) (CSelect (CVar "b") "notes"))])))),CoreDecl "" (CInt 0),CoreDecl "Lune.System.processDeltas" (CLam [PVar "a",PVar "b"] (CCase (CVar "b") [CoreAlt (PCon "Lune.Prelude.Nil" []) (CVar "Lune.Prelude.Nil"),CoreAlt (PCon "Lune.Prelude.Cons" [Located {locSpan = Span {spanStartLine = 660, spanStartCol = 10, spanEndLine = 660, spanEndCol = 12}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "p"},Located {locSpan = Span {spanStartLine = 660, spanStartCol = 12, spanEndLine = 660, spanEndCol = 17}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "rest"}]) (CCase (CApp (CApp (CVar "Lune.System.findProcessByPid") (CSelect (CVar "p") "pid")) (CVar "a")) [CoreAlt (PCon "Lune.Prelude.Nothing" []) (CApp (CApp (CVar "Lune.Prelude.Cons") (CRecord [("pid",CSelect (CVar "p") "pid"),("comm",CSelect (CVar "p") "comm"),("cpuTimeDelta",CApp (CApp (CVar "Lune.Int.add") (CSelect (CVar "p") "utime")) (CSelect (CVar "p") "stime")),("rssBytes",CSelect (CVar "p") "rssBytes")])) (CApp (CApp (CVar "Lune.System.processDeltas") (CVar "a")) (CVar "rest"))),CoreAlt (PCon "Lune.Prelude.Just" [Located {locSpan = Span {spanStartLine = 670, spanStartCol = 14, spanEndLine = 670, spanEndCol = 19}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "prev"}]) (CLet "prevCpu" (CApp (CApp (CVar "Lune.Int.add") (CSelect (CVar "prev") "utime")) (CSelect (CVar "prev") "stime")) (CLet "nextCpu" (CApp (CApp (CVar "Lune.Int.add") (CSelect (CVar "p") "utime")) (CSelect (CVar "p") "stime")) (CApp (CApp (CVar "Lune.Prelude.Cons") (CRecord [("pid",CSelect (CVar "p") "pid"),("comm",CSelect (CVar "p") "comm"),("cpuTimeDelta",CApp (CApp (CVar "Lune.Int.sub") (CVar "nextCpu")) (CVar "prevCpu")),("rssBytes",CSelect (CVar "p") "rssBytes")])) (CApp (CApp (CVar "Lune.System.processDeltas") (CVar "a")) (CVar "rest")))))])])),CoreDecl "" (CInt 0),CoreDecl "Lune.System.findProcessByPid" (CLam [PVar "pid",PVar "ps"] (CCase (CVar "ps") [CoreAlt (PCon "Lune.Prelude.Nil" []) (CVar "Lune.Prelude.Nothing"),CoreAlt (PCon "Lune.Prelude.Cons" [Located {locSpan = Span {spanStartLine = 688, spanStartCol = 10, spanEndLine = 688, spanEndCol = 12}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "p"},Located {locSpan = Span {spanStartLine = 688, spanStartCol = 12, spanEndLine = 688, spanEndCol = 17}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "rest"}]) (CCase (CApp (CApp (CVar "Lune.Int.eq") (CSelect (CVar "p") "pid")) (CVar "pid")) [CoreAlt (PCon "Lune.Prelude.True" []) (CApp (CVar "Lune.Prelude.Just") (CVar "p")),CoreAlt (PCon "Lune.Prelude.False" []) (CApp (CApp (CVar "Lune.System.findProcessByPid") (CVar "pid")) (CVar "rest"))])])),CoreDecl "" (CInt 0),CoreDecl "Lune.System.takeTopByCpuDelta" (CLam [PVar "n",PVar "ds"] (CApp (CApp (CVar "Lune.System.take") (CVar "n")) (CApp (CVar "Lune.System.sortByCpuDeltaDesc") (CVar "ds")))),CoreDecl "" (CInt 0),CoreDecl "Lune.System.sortByCpuDeltaDesc" (CLam [PVar "ds"] (CApp (CApp (CApp (CVar "Lune.List.foldl") (CVar "Lune.System.insertByCpuDelta")) (CVar "Lune.Prelude.Nil")) (CVar "ds"))),CoreDecl "" (CInt 0),CoreDecl "Lune.System.insertByCpuDelta" (CLam [PVar "sorted",PVar "d"] (CCase (CVar "sorted") [CoreAlt (PCon "Lune.Prelude.Nil" []) (CApp (CApp (CVar "Lune.Prelude.Cons") (CVar "d")) (CVar "Lune.Prelude.Nil")),CoreAlt (PCon "Lune.Prelude.Cons" [Located {locSpan = Span {spanStartLine = 706, spanStartCol = 10, spanEndLine = 706, spanEndCol = 12}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "x"},Located {locSpan = Span {spanStartLine = 706, spanStartCol = 12, spanEndLine = 706, spanEndCol = 17}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "rest"}]) (CCase (CApp (CApp (CVar "Lune.Int.gte") (CSelect (CVar "d") "cpuTimeDelta")) (CSelect (CVar "x") "cpuTimeDelta")) [CoreAlt (PCon "Lune.Prelude.True" []) (CApp (CApp (CVar "Lune.Prelude.Cons") (CVar "d")) (CVar "sorted")),CoreAlt (PCon "Lune.Prelude.False" []) (CApp (CApp (CVar "Lune.Prelude.Cons") (CVar "x")) (CApp (CApp (CVar "Lune.System.insertByCpuDelta") (CVar "rest")) (CVar "d")))])])),CoreDecl "" (CInt 0),CoreDecl "Lune.System.take" (CLam [PVar "n",PVar "xs"] (CCase (CApp (CApp (CVar "Lune.Int.lte") (CVar "n")) (CInt 0)) [CoreAlt (PCon "Lune.Prelude.True" []) (CVar "Lune.Prelude.Nil"),CoreAlt (PCon "Lune.Prelude.False" []) (CCase (CVar "xs") [CoreAlt (PCon "Lune.Prelude.Nil" []) (CVar "Lune.Prelude.Nil"),CoreAlt (PCon "Lune.Prelude.Cons" [Located {locSpan = Span {spanStartLine = 722, spanStartCol = 14, spanEndLine = 722, spanEndCol = 16}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "x"},Located {locSpan = Span {spanStartLine = 722, spanStartCol = 16, spanEndLine = 722, spanEndCol = 21}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "rest"}]) (CApp (CApp (CVar "Lune.Prelude.Cons") (CVar "x")) (CApp (CApp (CVar "Lune.System.take") (CApp (CApp (CVar "Lune.Int.sub") (CVar "n")) (CInt 1))) (CVar "rest")))])])),CoreDecl "" (CInt 0),CoreDecl "Lune.System.bytesPerSec" (CLam [PVar "dtMs",PVar "delta"] (CCase (CApp (CApp (CVar "Lune.Int.lte") (CVar "dtMs")) (CInt 0)) [CoreAlt (PCon "Lune.Prelude.True" []) (CInt 0),CoreAlt (PCon "Lune.Prelude.False" []) (CApp (CApp (CVar "Lune.Int.div") (CApp (CApp (CVar "Lune.Int.mul") (CVar "delta")) (CInt 1000))) (CVar "dtMs"))])),CoreDecl "" (CInt 0),CoreDecl "Lune.System.listZipByNameDisk" (CLam [PVar "dtMs",PVar "a",PVar "b"] (CCase (CVar "b") [CoreAlt (PCon "Lune.Prelude.Nil" []) (CVar "Lune.Prelude.Nil"),CoreAlt (PCon "Lune.Prelude.Cons" [Located {locSpan = Span {spanStartLine = 751, spanStartCol = 10, spanEndLine = 751, spanEndCol = 12}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "d"},Located {locSpan = Span {spanStartLine = 751, spanStartCol = 12, spanEndLine = 751, spanEndCol = 17}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "rest"}]) (CCase (CApp (CApp (CVar "Lune.System.findDiskByName") (CSelect (CVar "d") "name")) (CVar "a")) [CoreAlt (PCon "Lune.Prelude.Nothing" []) (CApp (CApp (CVar "Lune.Prelude.Cons") (CRecord [("name",CSelect (CVar "d") "name"),("readBytesPerSec",CInt 0),("writeBytesPerSec",CInt 0)])) (CApp (CApp (CApp (CVar "Lune.System.listZipByNameDisk") (CVar "dtMs")) (CVar "a")) (CVar "rest"))),CoreAlt (PCon "Lune.Prelude.Just" [Located {locSpan = Span {spanStartLine = 757, spanStartCol = 14, spanEndLine = 757, spanEndCol = 19}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "prev"}]) (CApp (CApp (CVar "Lune.Prelude.Cons") (CRecord [("name",CSelect (CVar "d") "name"),("readBytesPerSec",CApp (CApp (CVar "Lune.System.bytesPerSec") (CVar "dtMs")) (CApp (CApp (CVar "Lune.Int.sub") (CSelect (CVar "d") "readBytes")) (CSelect (CVar "prev") "readBytes"))),("writeBytesPerSec",CApp (CApp (CVar "Lune.System.bytesPerSec") (CVar "dtMs")) (CApp (CApp (CVar "Lune.Int.sub") (CSelect (CVar "d") "writeBytes")) (CSelect (CVar "prev") "writeBytes")))])) (CApp (CApp (CApp (CVar "Lune.System.listZipByNameDisk") (CVar "dtMs")) (CVar "a")) (CVar "rest")))])])),CoreDecl "" (CInt 0),CoreDecl "Lune.System.findDiskByName" (CLam [PVar "name",PVar "ds"] (CCase (CVar "ds") [CoreAlt (PCon "Lune.Prelude.Nil" []) (CVar "Lune.Prelude.Nothing"),CoreAlt (PCon "Lune.Prelude.Cons" [Located {locSpan = Span {spanStartLine = 781, spanStartCol = 10, spanEndLine = 781, spanEndCol = 12}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "d"},Located {locSpan = Span {spanStartLine = 781, spanStartCol = 12, spanEndLine = 781, spanEndCol = 17}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "rest"}]) (CCase (CApp (CApp (CVar "Lune.String.eq") (CSelect (CVar "d") "name")) (CVar "name")) [CoreAlt (PCon "Lune.Prelude.True" []) (CApp (CVar "Lune.Prelude.Just") (CVar "d")),CoreAlt (PCon "Lune.Prelude.False" []) (CApp (CApp (CVar "Lune.System.findDiskByName") (CVar "name")) (CVar "rest"))])])),CoreDecl "" (CInt 0),CoreDecl "Lune.System.listZipByNameNet" (CLam [PVar "dtMs",PVar "a",PVar "b"] (CCase (CVar "b") [CoreAlt (PCon "Lune.Prelude.Nil" []) (CVar "Lune.Prelude.Nil"),CoreAlt (PCon "Lune.Prelude.Cons" [Located {locSpan = Span {spanStartLine = 806, spanStartCol = 10, spanEndLine = 806, spanEndCol = 12}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "i"},Located {locSpan = Span {spanStartLine = 806, spanStartCol = 12, spanEndLine = 806, spanEndCol = 17}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "rest"}]) (CCase (CApp (CApp (CVar "Lune.System.findIfByName") (CSelect (CVar "i") "name")) (CVar "a")) [CoreAlt (PCon "Lune.Prelude.Nothing" []) (CApp (CApp (CVar "Lune.Prelude.Cons") (CRecord [("name",CSelect (CVar "i") "name"),("rxBytesPerSec",CInt 0),("txBytesPerSec",CInt 0)])) (CApp (CApp (CApp (CVar "Lune.System.listZipByNameNet") (CVar "dtMs")) (CVar "a")) (CVar "rest"))),CoreAlt (PCon "Lune.Prelude.Just" [Located {locSpan = Span {spanStartLine = 812, spanStartCol = 14, spanEndLine = 812, spanEndCol = 19}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "prev"}]) (CApp (CApp (CVar "Lune.Prelude.Cons") (CRecord [("name",CSelect (CVar "i") "name"),("rxBytesPerSec",CApp (CApp (CVar "Lune.System.bytesPerSec") (CVar "dtMs")) (CApp (CApp (CVar "Lune.Int.sub") (CSelect (CVar "i") "rxBytes")) (CSelect (CVar "prev") "rxBytes"))),("txBytesPerSec",CApp (CApp (CVar "Lune.System.bytesPerSec") (CVar "dtMs")) (CApp (CApp (CVar "Lune.Int.sub") (CSelect (CVar "i") "txBytes")) (CSelect (CVar "prev") "txBytes")))])) (CApp (CApp (CApp (CVar "Lune.System.listZipByNameNet") (CVar "dtMs")) (CVar "a")) (CVar "rest")))])])),CoreDecl "" (CInt 0),CoreDecl "Lune.System.findIfByName" (CLam [PVar "name",PVar "ifs"] (CCase (CVar "ifs") [CoreAlt (PCon "Lune.Prelude.Nil" []) (CVar "Lune.Prelude.Nothing"),CoreAlt (PCon "Lune.Prelude.Cons" [Located {locSpan = Span {spanStartLine = 834, spanStartCol = 10, spanEndLine = 834, spanEndCol = 12}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "i"},Located {locSpan = Span {spanStartLine = 834, spanStartCol = 12, spanEndLine = 834, spanEndCol = 17}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "rest"}]) (CCase (CApp (CApp (CVar "Lune.String.eq") (CSelect (CVar "i") "name")) (CVar "name")) [CoreAlt (PCon "Lune.Prelude.True" []) (CApp (CVar "Lune.Prelude.Just") (CVar "i")),CoreAlt (PCon "Lune.Prelude.False" []) (CApp (CApp (CVar "Lune.System.findIfByName") (CVar "name")) (CVar "rest"))])])),CoreDecl "" (CInt 0),CoreDecl "Lune.System.listZipWith" (CLam [PVar "f",PVar "xs",PVar "ys"] (CCase (CVar "xs") [CoreAlt (PCon "Lune.Prelude.Nil" []) (CVar "Lune.Prelude.Nil"),CoreAlt (PCon "Lune.Prelude.Cons" [Located {locSpan = Span {spanStartLine = 846, spanStartCol = 10, spanEndLine = 846, spanEndCol = 12}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "x"},Located {locSpan = Span {spanStartLine = 846, spanStartCol = 12, spanEndLine = 846, spanEndCol = 15}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "xt"}]) (CCase (CVar "ys") [CoreAlt (PCon "Lune.Prelude.Nil" []) (CVar "Lune.Prelude.Nil"),CoreAlt (PCon "Lune.Prelude.Cons" [Located {locSpan = Span {spanStartLine = 850, spanStartCol = 14, spanEndLine = 850, spanEndCol = 16}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "y"},Located {locSpan = Span {spanStartLine = 850, spanStartCol = 16, spanEndLine = 850, spanEndCol = 19}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "yt"}]) (CApp (CApp (CVar "Lune.Prelude.Cons") (CApp (CApp (CVar "f") (CVar "x")) (CVar "y"))) (CApp (CApp (CApp (CVar "Lune.System.listZipWith") (CVar "f")) (CVar "xt")) (CVar "yt")))])])),CoreDecl "" (CInt 0),CoreDecl "Lune.System.listAppend" (CLam [PVar "xs",PVar "ys"] (CCase (CVar "xs") [CoreAlt (PCon "Lune.Prelude.Nil" []) (CVar "ys"),CoreAlt (PCon "Lune.Prelude.Cons" [Located {locSpan = Span {spanStartLine = 858, spanStartCol = 10, spanEndLine = 858, spanEndCol = 12}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "x"},Located {locSpan = Span {spanStartLine = 858, spanStartCol = 12, spanEndLine = 858, spanEndCol = 17}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "rest"}]) (CApp (CApp (CVar "Lune.Prelude.Cons") (CVar "x")) (CApp (CApp (CVar "Lune.System.listAppend") (CVar "rest")) (CVar "ys")))])),CoreDecl "" (CInt 0),CoreDecl "" (CInt 0),CoreDecl "Template.empty" (CVar "prim_templateEmpty"),CoreDecl "" (CInt 0),CoreDecl "Template.text" (CVar "prim_templateText"),CoreDecl "" (CInt 0),CoreDecl "Template.line" (CVar "prim_templateLine"),CoreDecl "" (CInt 0),CoreDecl "Template.lines" (CVar "prim_templateLines"),CoreDecl "" (CInt 0),CoreDecl "Template.block" (CVar "prim_templateBlock"),CoreDecl "" (CInt 0),CoreDecl "Template.append" (CVar "prim_templateAppend"),CoreDecl "" (CInt 0),CoreDecl "Template.join" (CVar "prim_templateJoin"),CoreDecl "" (CInt 0),CoreDecl "Template.vcat" (CVar "prim_templateVcat"),CoreDecl "" (CInt 0),CoreDecl "Template.hcat" (CVar "prim_templateHcat"),CoreDecl "" (CInt 0),CoreDecl "Template.indent" (CVar "prim_templateIndent"),CoreDecl "" (CInt 0),CoreDecl "Template.ensureNL" (CVar "prim_templateEnsureNL"),CoreDecl "" (CInt 0),CoreDecl "Template.render" (CVar "prim_templateRender"),CoreDecl "" (CInt 0),CoreDecl "" (CInt 0),CoreDecl "" (CInt 0),CoreDecl "" (CInt 0),CoreDecl "" (CInt 0),CoreDecl "" (CInt 0),CoreDecl "" (CInt 0),CoreDecl "" (CInt 0),CoreDecl "" (CInt 0),CoreDecl "" (CInt 0),CoreDecl "" (CInt 0),CoreDecl "" (CInt 0),CoreDecl "" (CInt 0),CoreDecl "Lune.Bytes.empty" (CVar "prim_bytesEmpty"),CoreDecl "" (CInt 0),CoreDecl "Lune.Bytes.fromList" (CVar "prim_bytesFromList"),CoreDecl "" (CInt 0),CoreDecl "Lune.Bytes.toList" (CVar "prim_bytesToList"),CoreDecl "" (CInt 0),CoreDecl "Lune.Bytes.fromString" (CVar "prim_bytesFromString"),CoreDecl "" (CInt 0),CoreDecl "Lune.Bytes.toString" (CVar "prim_bytesToString"),CoreDecl "" (CInt 0),CoreDecl "Lune.Bytes.length" (CVar "prim_bytesLength"),CoreDecl "" (CInt 0),CoreDecl "Lune.Bytes.concat" (CVar "prim_bytesConcat"),CoreDecl "" (CInt 0),CoreDecl "Lune.Bytes.slice" (CVar "prim_bytesSlice"),CoreDecl "" (CInt 0),CoreDecl "Lune.Bytes.packInt32BE" (CVar "prim_bytesPackInt32BE"),CoreDecl "" (CInt 0),CoreDecl "Lune.Bytes.unpackInt32BE" (CVar "prim_bytesUnpackInt32BE"),CoreDecl "" (CInt 0),CoreDecl "Lune.Bytes.packInt16BE" (CVar "prim_bytesPackInt16BE"),CoreDecl "" (CInt 0),CoreDecl "Lune.Bytes.unpackInt16BE" (CVar "prim_bytesUnpackInt16BE"),CoreDecl "" (CInt 0),CoreDecl "" (CInt 0),CoreDecl "" (CInt 0),CoreDecl "Lune.Net.Socket.listen" (CLam [PVar "port"] (CApp (CVar "Lune.Prelude.Task") (CApp (CVar "prim_tcpListen") (CVar "port")))),CoreDecl "" (CInt 0),CoreDecl "Lune.Net.Socket.accept" (CLam [PVar "sock"] (CApp (CVar "Lune.Prelude.Task") (CApp (CVar "prim_tcpAccept") (CVar "sock")))),CoreDecl "" (CInt 0),CoreDecl "Lune.Net.Socket.connect" (CLam [PVar "host",PVar "port"] (CApp (CVar "Lune.Prelude.Task") (CApp (CApp (CVar "prim_tcpConnect") (CVar "host")) (CVar "port")))),CoreDecl "" (CInt 0),CoreDecl "Lune.Net.Socket.recv" (CLam [PVar "conn"] (CApp (CVar "Lune.Prelude.Task") (CApp (CVar "prim_connRecv") (CVar "conn")))),CoreDecl "" (CInt 0),CoreDecl "Lune.Net.Socket.send" (CLam [PVar "conn",PVar "msg"] (CApp (CVar "Lune.Prelude.Task") (CApp (CApp (CVar "prim_connSend") (CVar "conn")) (CVar "msg")))),CoreDecl "" (CInt 0),CoreDecl "Lune.Net.Socket.recvBytes" (CLam [PVar "conn",PVar "n"] (CApp (CVar "Lune.Prelude.Task") (CApp (CApp (CVar "prim_connRecvBytes") (CVar "conn")) (CVar "n")))),CoreDecl "" (CInt 0),CoreDecl "Lune.Net.Socket.sendBytes" (CLam [PVar "conn",PVar "bytes"] (CApp (CVar "Lune.Prelude.Task") (CApp (CApp (CVar "prim_connSendBytes") (CVar "conn")) (CVar "bytes")))),CoreDecl "" (CInt 0),CoreDecl "Lune.Net.Socket.closeConn" (CLam [PVar "conn"] (CApp (CVar "Lune.Prelude.Task") (CApp (CVar "prim_connClose") (CVar "conn")))),CoreDecl "" (CInt 0),CoreDecl "Lune.Net.Socket.closeSocket" (CLam [PVar "sock"] (CApp (CVar "Lune.Prelude.Task") (CApp (CVar "prim_socketClose") (CVar "sock")))),CoreDecl "" (CInt 0),CoreDecl "" (CInt 0),CoreDecl "Nova.Core.dictEmpty" (CVar "Lune.Prelude.Nil"),CoreDecl "" (CInt 0),CoreDecl "Nova.Core.dictFromList" (CLam [PVar "pairs"] (CVar "pairs")),CoreDecl "" (CInt 0),CoreDecl "Nova.Core.dictGet" (CLam [PVar "eq",PVar "key",PVar "dict"] (CCase (CVar "dict") [CoreAlt (PCon "Lune.Prelude.Nil" []) (CVar "Lune.Prelude.Nothing"),CoreAlt (PCon "Lune.Prelude.Cons" [Located {locSpan = Span {spanStartLine = 74, spanStartCol = 10, spanEndLine = 74, spanEndCol = 16}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "entry"},Located {locSpan = Span {spanStartLine = 74, spanStartCol = 16, spanEndLine = 74, spanEndCol = 21}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "rest"}]) (CCase (CApp (CApp (CVar "eq") (CVar "key")) (CSelect (CVar "entry") "key")) [CoreAlt (PCon "Lune.Prelude.True" []) (CApp (CVar "Lune.Prelude.Just") (CSelect (CVar "entry") "value")),CoreAlt (PCon "Lune.Prelude.False" []) (CApp (CApp (CApp (CVar "Nova.Core.dictGet") (CVar "eq")) (CVar "key")) (CVar "rest"))])])),CoreDecl "" (CInt 0),CoreDecl "Nova.Core.dictInsert" (CLam [PVar "eq",PVar "key",PVar "value",PVar "dict"] (CCase (CVar "dict") [CoreAlt (PCon "Lune.Prelude.Nil" []) (CApp (CApp (CVar "Lune.Prelude.Cons") (CRecord [("key",CVar "key"),("value",CVar "value")])) (CVar "Lune.Prelude.Nil")),CoreAlt (PCon "Lune.Prelude.Cons" [Located {locSpan = Span {spanStartLine = 86, spanStartCol = 10, spanEndLine = 86, spanEndCol = 16}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "entry"},Located {locSpan = Span {spanStartLine = 86, spanStartCol = 16, spanEndLine = 86, spanEndCol = 21}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "rest"}]) (CCase (CApp (CApp (CVar "eq") (CVar "key")) (CSelect (CVar "entry") "key")) [CoreAlt (PCon "Lune.Prelude.True" []) (CApp (CApp (CVar "Lune.Prelude.Cons") (CRecord [("key",CVar "key"),("value",CVar "value")])) (CVar "rest")),CoreAlt (PCon "Lune.Prelude.False" []) (CApp (CApp (CVar "Lune.Prelude.Cons") (CVar "entry")) (CApp (CApp (CApp (CApp (CVar "Nova.Core.dictInsert") (CVar "eq")) (CVar "key")) (CVar "value")) (CVar "rest")))])])),CoreDecl "" (CInt 0),CoreDecl "" (CInt 0),CoreDecl "Nova.Core.setEmpty" (CVar "Lune.Prelude.Nil"),CoreDecl "" (CInt 0),CoreDecl "Nova.Core.setFromList" (CLam [PVar "eq",PVar "xs"] (CApp (CApp (CApp (CVar "Nova.Core.setFromListGo") (CVar "eq")) (CVar "xs")) (CVar "Lune.Prelude.Nil"))),CoreDecl "" (CInt 0),CoreDecl "Nova.Core.setFromListGo" (CLam [PVar "eq",PVar "xs",PVar "acc"] (CCase (CVar "xs") [CoreAlt (PCon "Lune.Prelude.Nil" []) (CVar "acc"),CoreAlt (PCon "Lune.Prelude.Cons" [Located {locSpan = Span {spanStartLine = 107, spanStartCol = 10, spanEndLine = 107, spanEndCol = 12}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "x"},Located {locSpan = Span {spanStartLine = 107, spanStartCol = 12, spanEndLine = 107, spanEndCol = 17}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "rest"}]) (CCase (CApp (CApp (CApp (CVar "Nova.Core.setMember") (CVar "eq")) (CVar "x")) (CVar "acc")) [CoreAlt (PCon "Lune.Prelude.True" []) (CApp (CApp (CApp (CVar "Nova.Core.setFromListGo") (CVar "eq")) (CVar "rest")) (CVar "acc")),CoreAlt (PCon "Lune.Prelude.False" []) (CApp (CApp (CApp (CVar "Nova.Core.setFromListGo") (CVar "eq")) (CVar "rest")) (CApp (CApp (CApp (CVar "Nova.Core.setInsert") (CVar "eq")) (CVar "x")) (CVar "acc")))])])),CoreDecl "" (CInt 0),CoreDecl "Nova.Core.setMember" (CLam [PVar "eq",PVar "x",PVar "xs"] (CCase (CVar "xs") [CoreAlt (PCon "Lune.Prelude.Nil" []) (CVar "Lune.Prelude.False"),CoreAlt (PCon "Lune.Prelude.Cons" [Located {locSpan = Span {spanStartLine = 119, spanStartCol = 10, spanEndLine = 119, spanEndCol = 12}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "y"},Located {locSpan = Span {spanStartLine = 119, spanStartCol = 12, spanEndLine = 119, spanEndCol = 17}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "rest"}]) (CCase (CApp (CApp (CVar "eq") (CVar "x")) (CVar "y")) [CoreAlt (PCon "Lune.Prelude.True" []) (CVar "Lune.Prelude.True"),CoreAlt (PCon "Lune.Prelude.False" []) (CApp (CApp (CApp (CVar "Nova.Core.setMember") (CVar "eq")) (CVar "x")) (CVar "rest"))])])),CoreDecl "" (CInt 0),CoreDecl "Nova.Core.setInsert" (CLam [PVar "eq",PVar "x",PVar "xs"] (CCase (CApp (CApp (CApp (CVar "Nova.Core.setMember") (CVar "eq")) (CVar "x")) (CVar "xs")) [CoreAlt (PCon "Lune.Prelude.True" []) (CVar "xs"),CoreAlt (PCon "Lune.Prelude.False" []) (CApp (CApp (CVar "Lune.Prelude.Cons") (CVar "x")) (CVar "xs"))])),CoreDecl "" (CInt 0),CoreDecl "" (CInt 0),CoreDecl "Nova.Core.providerId" (CLam [PVar "p"] (CCase (CVar "p") [CoreAlt (PCon "Nova.Core.Provider" [Located {locSpan = Span {spanStartLine = 144, spanStartCol = 14, spanEndLine = 144, spanEndCol = 16}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "s"}]) (CVar "s")])),CoreDecl "" (CInt 0),CoreDecl "Nova.Core.eqProvider" (CLam [PVar "a",PVar "b"] (CApp (CApp (CVar "Lune.String.eq") (CApp (CVar "Nova.Core.providerId") (CVar "a"))) (CApp (CVar "Nova.Core.providerId") (CVar "b")))),CoreDecl "" (CInt 0),CoreDecl "Nova.Core.openrouter" (CApp (CVar "Nova.Core.Provider") (CString "openrouter")),CoreDecl "" (CInt 0),CoreDecl "Nova.Core.ollama" (CApp (CVar "Nova.Core.Provider") (CString "ollama")),CoreDecl "" (CInt 0),CoreDecl "" (CInt 0),CoreDecl "" (CInt 0),CoreDecl "" (CInt 0),CoreDecl "" (CInt 0),CoreDecl "" (CInt 0),CoreDecl "" (CInt 0),CoreDecl "Nova.Core.defaultProviderConfig" (CApp (CVar "Nova.Core.dictFromList") (CApp (CApp (CVar "Lune.Prelude.Cons") (CRecord [("key",CVar "Nova.Core.openrouter"),("value",CRecord [("baseUrl",CString "https://openrouter.ai/api/v1"),("apiKey",CVar "Lune.Prelude.Nothing"),("appName",CVar "Lune.Prelude.Nothing")])])) (CApp (CApp (CVar "Lune.Prelude.Cons") (CRecord [("key",CVar "Nova.Core.ollama"),("value",CRecord [("baseUrl",CString "http://localhost:11434"),("apiKey",CVar "Lune.Prelude.Nothing"),("appName",CVar "Lune.Prelude.Nothing")])])) (CVar "Lune.Prelude.Nil")))),CoreDecl "" (CInt 0),CoreDecl "" (CInt 0),CoreDecl "Nova.Core.eqCapability" (CLam [PVar "a",PVar "b"] (CCase (CVar "a") [CoreAlt (PCon "Nova.Core.SupportsTools" []) (CCase (CVar "b") [CoreAlt (PCon "Nova.Core.SupportsTools" []) (CVar "Lune.Prelude.True"),CoreAlt PWildcard (CVar "Lune.Prelude.False")]),CoreAlt (PCon "Nova.Core.SupportsStreaming" []) (CCase (CVar "b") [CoreAlt (PCon "Nova.Core.SupportsStreaming" []) (CVar "Lune.Prelude.True"),CoreAlt PWildcard (CVar "Lune.Prelude.False")]),CoreAlt (PCon "Nova.Core.SupportsJsonMode" []) (CCase (CVar "b") [CoreAlt (PCon "Nova.Core.SupportsJsonMode" []) (CVar "Lune.Prelude.True"),CoreAlt PWildcard (CVar "Lune.Prelude.False")])])),CoreDecl "" (CInt 0),CoreDecl "" (CInt 0),CoreDecl "" (CInt 0),CoreDecl "Nova.Core.defaultProviderRegistry" (CApp (CVar "Nova.Core.dictFromList") (CApp (CApp (CVar "Lune.Prelude.Cons") (CRecord [("key",CVar "Nova.Core.openrouter"),("value",CVar "Nova.Core.openrouterImpl")])) (CApp (CApp (CVar "Lune.Prelude.Cons") (CRecord [("key",CVar "Nova.Core.ollama"),("value",CVar "Nova.Core.ollamaImpl")])) (CVar "Lune.Prelude.Nil")))),CoreDecl "" (CInt 0),CoreDecl "Nova.Core.callProvider" (CLam [PVar "registry",PVar "cfg",PVar "provider",PVar "model",PVar "prompt"] (CCase (CApp (CApp (CApp (CVar "Nova.Core.dictGet") (CVar "Nova.Core.eqProvider")) (CVar "provider")) (CVar "registry")) [CoreAlt (PCon "Lune.Prelude.Nothing" []) (CApp (CVar "Lune.IO.pure") (CApp (CVar "Lune.Prelude.Err") (CApp (CVar "Nova.Core.ProviderError") (CApp (CApp (CVar "Lune.String.append") (CString "Unknown provider: ")) (CApp (CVar "Nova.Core.providerId") (CVar "provider")))))),CoreAlt (PCon "Lune.Prelude.Just" [Located {locSpan = Span {spanStartLine = 270, spanStartCol = 10, spanEndLine = 270, spanEndCol = 15}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "impl"}]) (CApp (CApp (CApp (CSelect (CVar "impl") "call") (CVar "cfg")) (CVar "model")) (CVar "prompt"))])),CoreDecl "" (CInt 0),CoreDecl "Nova.Core.getSettings" (CLam [PVar "provider",PVar "cfg"] (CCase (CApp (CApp (CApp (CVar "Nova.Core.dictGet") (CVar "Nova.Core.eqProvider")) (CVar "provider")) (CVar "cfg")) [CoreAlt (PCon "Lune.Prelude.Just" [Located {locSpan = Span {spanStartLine = 280, spanStartCol = 10, spanEndLine = 280, spanEndCol = 12}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "s"}]) (CVar "s"),CoreAlt (PCon "Lune.Prelude.Nothing" []) (CRecord [("baseUrl",CString ""),("apiKey",CVar "Lune.Prelude.Nothing"),("appName",CVar "Lune.Prelude.Nothing")])])),CoreDecl "" (CInt 0),CoreDecl "Nova.Core.openrouterImpl" (CRecord [("id",CVar "Nova.Core.openrouter"),("call",CVar "Nova.Core.callOpenRouter"),("capabilities",CApp (CApp (CVar "Nova.Core.setFromList") (CVar "Nova.Core.eqCapability")) (CApp (CApp (CVar "Lune.Prelude.Cons") (CVar "Nova.Core.SupportsJsonMode")) (CVar "Lune.Prelude.Nil")))]),CoreDecl "" (CInt 0),CoreDecl "Nova.Core.ollamaImpl" (CRecord [("id",CVar "Nova.Core.ollama"),("call",CVar "Nova.Core.callOllama"),("capabilities",CVar "Nova.Core.setEmpty")]),CoreDecl "" (CInt 0),CoreDecl "Nova.Core.callOpenRouter" (CLam [PVar "cfg",PWildcard,PWildcard] (CLet "settings" (CApp (CApp (CVar "Nova.Core.getSettings") (CVar "Nova.Core.openrouter")) (CVar "cfg")) (CCase (CSelect (CVar "settings") "apiKey") [CoreAlt (PCon "Lune.Prelude.Nothing" []) (CApp (CVar "Lune.IO.pure") (CApp (CVar "Lune.Prelude.Err") (CVar "Nova.Core.Unauthorized"))),CoreAlt (PCon "Lune.Prelude.Just" [Located {locSpan = Span {spanStartLine = 305, spanStartCol = 12, spanEndLine = 305, spanEndCol = 14}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PWildcard}]) (CApp (CVar "Lune.IO.pure") (CApp (CVar "Lune.Prelude.Err") (CApp (CVar "Nova.Core.ProviderError") (CString "OpenRouter: HTTP client not implemented (v2)."))))]))),CoreDecl "" (CInt 0),CoreDecl "Nova.Core.callOllama" (CLam [PVar "cfg",PVar "modelId",PVar "prompt"] (CLet "settings" (CApp (CApp (CVar "Nova.Core.getSettings") (CVar "Nova.Core.ollama")) (CVar "cfg")) (CCase (CApp (CApp (CVar "Lune.String.startsWith") (CString "mock://")) (CSelect (CVar "settings") "baseUrl")) [CoreAlt (PCon "Lune.Prelude.True" []) (CApp (CVar "Lune.IO.pure") (CApp (CApp (CVar "Nova.Core.mockOllama") (CVar "modelId")) (CVar "prompt"))),CoreAlt (PCon "Lune.Prelude.False" []) (CApp (CApp (CApp (CVar "Nova.Core.callOllamaHttp") (CVar "settings")) (CVar "modelId")) (CVar "prompt"))]))),CoreDecl "" (CInt 0),CoreDecl "Nova.Core.callOllamaHttp" (CLam [PVar "settings",PVar "modelId",PVar "prompt"] (CLet "hostPort" (CApp (CVar "Nova.Core.parseHostPort") (CSelect (CVar "settings") "baseUrl")) (CLet "requestBody" (CApp (CVar "Lune.Json.Encode.object") (CApp (CApp (CVar "Lune.Prelude.Cons") (CRecord [("key",CString "model"),("value",CApp (CVar "Lune.Json.Encode.string") (CVar "modelId"))])) (CApp (CApp (CVar "Lune.Prelude.Cons") (CRecord [("key",CString "prompt"),("value",CApp (CVar "Lune.Json.Encode.string") (CVar "prompt"))])) (CApp (CApp (CVar "Lune.Prelude.Cons") (CRecord [("key",CString "stream"),("value",CApp (CVar "Lune.Json.Encode.bool") (CVar "Lune.Prelude.False"))])) (CVar "Lune.Prelude.Nil"))))) (CLet "bodyStr" (CApp (CVar "Lune.Json.stringify") (CVar "requestBody")) (CLet "httpRequest" (CApp (CApp (CApp (CVar "Nova.Core.buildHttpPost") (CSelect (CVar "hostPort") "host")) (CString "/api/generate")) (CVar "bodyStr")) (CApp (CApp (CVar "Lune.IO.andThen") (CApp (CApp (CVar "prim_tcpConnect") (CSelect (CVar "hostPort") "host")) (CSelect (CVar "hostPort") "port"))) (CLam [PVar "connResult"] (CCase (CVar "connResult") [CoreAlt (PCon "Lune.Prelude.Err" [Located {locSpan = Span {spanStartLine = 338, spanStartCol = 15, spanEndLine = 338, spanEndCol = 17}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PWildcard}]) (CApp (CVar "Lune.IO.pure") (CApp (CVar "Lune.Prelude.Err") (CApp (CVar "Nova.Core.NetworkError") (CApp (CApp (CVar "Lune.String.append") (CString "Failed to connect to Ollama at ")) (CSelect (CVar "settings") "baseUrl"))))),CoreAlt (PCon "Lune.Prelude.Ok" [Located {locSpan = Span {spanStartLine = 345, spanStartCol = 14, spanEndLine = 345, spanEndCol = 19}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "conn"}]) (CApp (CApp (CVar "Lune.IO.andThen") (CApp (CApp (CVar "prim_connSend") (CVar "conn")) (CVar "httpRequest"))) (CLam [PVar "sendResult"] (CCase (CVar "sendResult") [CoreAlt (PCon "Lune.Prelude.Err" [Located {locSpan = Span {spanStartLine = 350, spanStartCol = 23, spanEndLine = 350, spanEndCol = 25}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PWildcard}]) (CApp (CApp (CVar "Lune.IO.andThen") (CApp (CVar "prim_connClose") (CVar "conn"))) (CLam [PWildcard] (CApp (CVar "Lune.IO.pure") (CApp (CVar "Lune.Prelude.Err") (CApp (CVar "Nova.Core.NetworkError") (CString "Failed to send request")))))),CoreAlt (PCon "Lune.Prelude.Ok" [Located {locSpan = Span {spanStartLine = 355, spanStartCol = 22, spanEndLine = 355, spanEndCol = 24}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PWildcard}]) (CApp (CApp (CVar "Lune.IO.andThen") (CApp (CApp (CVar "Nova.Core.recvHttpResponse") (CVar "conn")) (CString ""))) (CLam [PVar "responseStr"] (CApp (CApp (CVar "Lune.IO.andThen") (CApp (CVar "prim_connClose") (CVar "conn"))) (CLam [PWildcard] (CApp (CVar "Lune.IO.pure") (CApp (CVar "Nova.Core.parseOllamaResponse") (CVar "responseStr")))))))])))])))))))),CoreDecl "" (CInt 0),CoreDecl "Nova.Core.parseHostPort" (CLam [PVar "url"] (CLet "stripped" (CCase (CApp (CApp (CVar "Lune.String.startsWith") (CString "http://")) (CVar "url")) [CoreAlt (PCon "Lune.Prelude.True" []) (CApp (CApp (CVar "Lune.String.drop") (CInt 7)) (CVar "url")),CoreAlt (PCon "Lune.Prelude.False" []) (CCase (CApp (CApp (CVar "Lune.String.startsWith") (CString "https://")) (CVar "url")) [CoreAlt (PCon "Lune.Prelude.True" []) (CApp (CApp (CVar "Lune.String.drop") (CInt 8)) (CVar "url")),CoreAlt (PCon "Lune.Prelude.False" []) (CVar "url")])]) (CLet "hostAndPort" (CCase (CApp (CApp (CVar "Lune.String.indexOf") (CString "/")) (CVar "stripped")) [CoreAlt (PCon "Lune.Prelude.Just" [Located {locSpan = Span {spanStartLine = 380, spanStartCol = 14, spanEndLine = 380, spanEndCol = 18}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "idx"}]) (CApp (CApp (CVar "Lune.String.take") (CVar "idx")) (CVar "stripped")),CoreAlt (PCon "Lune.Prelude.Nothing" []) (CVar "stripped")]) (CCase (CApp (CApp (CVar "Lune.String.indexOf") (CString ":")) (CVar "hostAndPort")) [CoreAlt (PCon "Lune.Prelude.Nothing" []) (CRecord [("host",CVar "hostAndPort"),("port",CInt 11434)]),CoreAlt (PCon "Lune.Prelude.Just" [Located {locSpan = Span {spanStartLine = 388, spanStartCol = 12, spanEndLine = 388, spanEndCol = 16}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "idx"}]) (CLet "host" (CApp (CApp (CVar "Lune.String.take") (CVar "idx")) (CVar "hostAndPort")) (CLet "portStr" (CApp (CApp (CVar "Lune.String.drop") (CApp (CApp (CVar "Lune.Int.add") (CVar "idx")) (CInt 1))) (CVar "hostAndPort")) (CCase (CApp (CVar "Lune.String.toInt") (CVar "portStr")) [CoreAlt (PCon "Lune.Prelude.Ok" [Located {locSpan = Span {spanStartLine = 394, spanStartCol = 16, spanEndLine = 394, spanEndCol = 18}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "p"}]) (CRecord [("host",CVar "host"),("port",CVar "p")]),CoreAlt (PCon "Lune.Prelude.Err" [Located {locSpan = Span {spanStartLine = 396, spanStartCol = 17, spanEndLine = 396, spanEndCol = 19}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PWildcard}]) (CRecord [("host",CVar "host"),("port",CInt 11434)])])))])))),CoreDecl "" (CInt 0),CoreDecl "Nova.Core.buildHttpPost" (CLam [PVar "host",PVar "path",PVar "body"] (CLet "contentLength" (CApp (CVar "Lune.String.length") (CVar "body")) (CApp (CApp (CVar "Lune.String.join") (CString "\r\n")) (CApp (CApp (CVar "Lune.Prelude.Cons") (CApp (CApp (CVar "Lune.String.append") (CString "POST ")) (CApp (CApp (CVar "Lune.String.append") (CVar "path")) (CString " HTTP/1.1")))) (CApp (CApp (CVar "Lune.Prelude.Cons") (CApp (CApp (CVar "Lune.String.append") (CString "Host: ")) (CVar "host"))) (CApp (CApp (CVar "Lune.Prelude.Cons") (CString "Content-Type: application/json")) (CApp (CApp (CVar "Lune.Prelude.Cons") (CApp (CApp (CVar "Lune.String.append") (CString "Content-Length: ")) (CApp (CVar "Lune.String.fromInt") (CVar "contentLength")))) (CApp (CApp (CVar "Lune.Prelude.Cons") (CString "Connection: close")) (CApp (CApp (CVar "Lune.Prelude.Cons") (CString "")) (CApp (CApp (CVar "Lune.Prelude.Cons") (CVar "body")) (CVar "Lune.Prelude.Nil"))))))))))),CoreDecl "" (CInt 0),CoreDecl "Nova.Core.recvHttpResponse" (CLam [PVar "conn",PVar "acc"] (CApp (CApp (CVar "Lune.IO.andThen") (CApp (CVar "prim_connRecv") (CVar "conn"))) (CLam [PVar "result"] (CCase (CVar "result") [CoreAlt (PCon "Lune.Prelude.Err" [Located {locSpan = Span {spanStartLine = 423, spanStartCol = 13, spanEndLine = 423, spanEndCol = 15}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PWildcard}]) (CApp (CVar "Lune.IO.pure") (CVar "acc")),CoreAlt (PCon "Lune.Prelude.Ok" [Located {locSpan = Span {spanStartLine = 425, spanStartCol = 12, spanEndLine = 425, spanEndCol = 18}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "chunk"}]) (CCase (CApp (CVar "Lune.String.isEmpty") (CVar "chunk")) [CoreAlt (PCon "Lune.Prelude.True" []) (CApp (CVar "Lune.IO.pure") (CVar "acc")),CoreAlt (PCon "Lune.Prelude.False" []) (CApp (CApp (CVar "Nova.Core.recvHttpResponse") (CVar "conn")) (CApp (CApp (CVar "Lune.String.append") (CVar "acc")) (CVar "chunk")))])])))),CoreDecl "" (CInt 0),CoreDecl "Nova.Core.parseOllamaResponse" (CLam [PVar "raw"] (CLet "body" (CCase (CApp (CApp (CVar "Lune.String.indexOf") (CString "\r\n\r\n")) (CVar "raw")) [CoreAlt (PCon "Lune.Prelude.Just" [Located {locSpan = Span {spanStartLine = 438, spanStartCol = 14, spanEndLine = 438, spanEndCol = 18}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "idx"}]) (CApp (CApp (CVar "Lune.String.drop") (CApp (CApp (CVar "Lune.Int.add") (CVar "idx")) (CInt 4))) (CVar "raw")),CoreAlt (PCon "Lune.Prelude.Nothing" []) (CCase (CApp (CApp (CVar "Lune.String.indexOf") (CString "\n\n")) (CVar "raw")) [CoreAlt (PCon "Lune.Prelude.Just" [Located {locSpan = Span {spanStartLine = 442, spanStartCol = 18, spanEndLine = 442, spanEndCol = 22}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "idx"}]) (CApp (CApp (CVar "Lune.String.drop") (CApp (CApp (CVar "Lune.Int.add") (CVar "idx")) (CInt 2))) (CVar "raw")),CoreAlt (PCon "Lune.Prelude.Nothing" []) (CVar "raw")])]) (CCase (CApp (CVar "Lune.Json.parse") (CVar "body")) [CoreAlt (PCon "Lune.Prelude.Err" [Located {locSpan = Span {spanStartLine = 448, spanStartCol = 11, spanEndLine = 448, spanEndCol = 15}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "msg"}]) (CApp (CVar "Lune.Prelude.Err") (CApp (CVar "Nova.Core.DecodeError") (CApp (CApp (CVar "Lune.String.append") (CString "Failed to parse Ollama response: ")) (CVar "msg")))),CoreAlt (PCon "Lune.Prelude.Ok" [Located {locSpan = Span {spanStartLine = 450, spanStartCol = 10, spanEndLine = 450, spanEndCol = 15}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "json"}]) (CCase (CApp (CApp (CVar "Lune.Json.Decode.decodeValue") (CApp (CApp (CVar "Lune.Json.Decode.field") (CString "response")) (CVar "Lune.Json.Decode.string"))) (CVar "json")) [CoreAlt (PCon "Lune.Prelude.Err" [Located {locSpan = Span {spanStartLine = 452, spanStartCol = 15, spanEndLine = 452, spanEndCol = 25}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "decodeErr"}]) (CApp (CVar "Lune.Prelude.Err") (CApp (CVar "Nova.Core.DecodeError") (CApp (CApp (CVar "Lune.String.append") (CString "Missing 'response' field: ")) (CSelect (CVar "decodeErr") "message")))),CoreAlt (PCon "Lune.Prelude.Ok" [Located {locSpan = Span {spanStartLine = 456, spanStartCol = 14, spanEndLine = 456, spanEndCol = 27}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "responseText"}]) (CApp (CVar "Lune.Prelude.Ok") (CRecord [("text",CVar "responseText"),("usage",CVar "Lune.Prelude.Nothing")]))])]))),CoreDecl "" (CInt 0),CoreDecl "Nova.Core.mockOllama" (CLam [PVar "modelId",PVar "prompt"] (CCase (CApp (CApp (CVar "Lune.String.eq") (CVar "modelId")) (CString "mock-tool-wrapper")) [CoreAlt (PCon "Lune.Prelude.True" []) (CLet "pre" (CApp (CApp (CVar "Nova.Core.countOccurrences") (CString "You must output exactly one JSON value and nothing else.")) (CVar "prompt")) (CLet "post" (CApp (CApp (CVar "Nova.Core.countOccurrences") (CString "Output ONLY JSON now.")) (CVar "prompt")) (CApp (CVar "Lune.Prelude.Ok") (CRecord [("text",CApp (CApp (CVar "Lune.String.append") (CApp (CApp (CVar "Lune.String.append") (CString "[")) (CApp (CVar "Lune.String.fromInt") (CVar "pre")))) (CApp (CApp (CVar "Lune.String.append") (CApp (CApp (CVar "Lune.String.append") (CString ",")) (CApp (CVar "Lune.String.fromInt") (CVar "post")))) (CString "]"))),("usage",CVar "Lune.Prelude.Nothing")])))),CoreAlt (PCon "Lune.Prelude.False" []) (CCase (CApp (CApp (CVar "Lune.String.eq") (CVar "modelId")) (CString "mock-pure")) [CoreAlt (PCon "Lune.Prelude.True" []) (CApp (CVar "Lune.Prelude.Ok") (CRecord [("text",CString "{\"n\":1}"),("usage",CVar "Lune.Prelude.Nothing")])),CoreAlt (PCon "Lune.Prelude.False" []) (CCase (CApp (CApp (CVar "Lune.String.eq") (CVar "modelId")) (CString "mock-prose-prefix")) [CoreAlt (PCon "Lune.Prelude.True" []) (CApp (CVar "Lune.Prelude.Ok") (CRecord [("text",CString "Sure.\n{\"n\":1}"),("usage",CVar "Lune.Prelude.Nothing")])),CoreAlt (PCon "Lune.Prelude.False" []) (CCase (CApp (CApp (CVar "Lune.String.eq") (CVar "modelId")) (CString "mock-prose-suffix")) [CoreAlt (PCon "Lune.Prelude.True" []) (CApp (CVar "Lune.Prelude.Ok") (CRecord [("text",CString "{\"n\":1}\nThanks!"),("usage",CVar "Lune.Prelude.Nothing")])),CoreAlt (PCon "Lune.Prelude.False" []) (CCase (CApp (CApp (CVar "Lune.String.eq") (CVar "modelId")) (CString "mock-invalid")) [CoreAlt (PCon "Lune.Prelude.True" []) (CApp (CVar "Lune.Prelude.Ok") (CRecord [("text",CString "Ok: {not json}"),("usage",CVar "Lune.Prelude.Nothing")])),CoreAlt (PCon "Lune.Prelude.False" []) (CCase (CApp (CApp (CVar "Lune.String.eq") (CVar "modelId")) (CString "mock-no-json")) [CoreAlt (PCon "Lune.Prelude.True" []) (CApp (CVar "Lune.Prelude.Ok") (CRecord [("text",CString "No JSON here."),("usage",CVar "Lune.Prelude.Nothing")])),CoreAlt (PCon "Lune.Prelude.False" []) (CApp (CVar "Lune.Prelude.Err") (CApp (CVar "Nova.Core.ProviderError") (CString "Unknown mock model id.")))])])])])])])),CoreDecl "" (CInt 0),CoreDecl "Nova.Core.countOccurrences" (CLam [PVar "needle",PVar "haystack"] (CCase (CApp (CVar "Lune.String.isEmpty") (CVar "needle")) [CoreAlt (PCon "Lune.Prelude.True" []) (CInt 0),CoreAlt (PCon "Lune.Prelude.False" []) (CApp (CApp (CApp (CApp (CVar "Nova.Core.countOccurrencesFrom") (CVar "needle")) (CApp (CVar "Lune.String.length") (CVar "needle"))) (CInt 0)) (CVar "haystack"))])),CoreDecl "" (CInt 0),CoreDecl "Nova.Core.countOccurrencesFrom" (CLam [PVar "needle",PVar "needleLen",PVar "acc",PVar "s"] (CCase (CApp (CApp (CVar "Lune.String.indexOf") (CVar "needle")) (CVar "s")) [CoreAlt (PCon "Lune.Prelude.Nothing" []) (CVar "acc"),CoreAlt (PCon "Lune.Prelude.Just" [Located {locSpan = Span {spanStartLine = 520, spanStartCol = 10, spanEndLine = 520, spanEndCol = 12}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "i"}]) (CLet "next" (CApp (CApp (CVar "Lune.String.drop") (CApp (CApp (CVar "Lune.Int.add") (CVar "i")) (CVar "needleLen"))) (CVar "s")) (CApp (CApp (CApp (CApp (CVar "Nova.Core.countOccurrencesFrom") (CVar "needle")) (CVar "needleLen")) (CApp (CApp (CVar "Lune.Int.add") (CVar "acc")) (CInt 1))) (CVar "next")))])),CoreDecl "" (CInt 0),CoreDecl "" (CInt 0),CoreDecl "Nova.Tool.toolId" (CLam [PVar "name",PVar "version"] (CRecord [("name",CVar "name"),("version",CVar "version")])),CoreDecl "" (CInt 0),CoreDecl "Nova.Tool.eqToolId" (CLam [PVar "a",PVar "b"] (CCase (CApp (CApp (CVar "Lune.String.eq") (CSelect (CVar "a") "name")) (CSelect (CVar "b") "name")) [CoreAlt (PCon "Lune.Prelude.False" []) (CVar "Lune.Prelude.False"),CoreAlt (PCon "Lune.Prelude.True" []) (CApp (CApp (CVar "Lune.String.eq") (CSelect (CVar "a") "version")) (CSelect (CVar "b") "version"))])),CoreDecl "" (CInt 0),CoreDecl "Nova.Tool.toolIdToString" (CLam [PVar "id"] (CApp (CApp (CVar "Lune.String.append") (CSelect (CVar "id") "name")) (CApp (CApp (CVar "Lune.String.append") (CString "@")) (CSelect (CVar "id") "version")))),CoreDecl "" (CInt 0),CoreDecl "" (CInt 0),CoreDecl "Nova.Tool.decodeJsonString" (CLam [PVar "decoder",PVar "raw"] (CCase (CApp (CVar "Lune.Json.parse") (CVar "raw")) [CoreAlt (PCon "Lune.Prelude.Err" [Located {locSpan = Span {spanStartLine = 48, spanStartCol = 9, spanEndLine = 48, spanEndCol = 13}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "msg"}]) (CApp (CVar "Lune.Prelude.Err") (CRecord [("message",CVar "msg"),("path",CVar "Lune.Prelude.Nil")])),CoreAlt (PCon "Lune.Prelude.Ok" [Located {locSpan = Span {spanStartLine = 51, spanStartCol = 8, spanEndLine = 51, spanEndCol = 13}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "json"}]) (CApp (CApp (CVar "Lune.Json.Decode.decodeValue") (CVar "decoder")) (CVar "json"))])),CoreDecl "" (CInt 0),CoreDecl "Nova.Prompt.toolPreamble" (CApp (CVar "Lune.String.unlines") (CApp (CApp (CVar "Lune.Prelude.Cons") (CString "You must output exactly one JSON value and nothing else.")) (CApp (CApp (CVar "Lune.Prelude.Cons") (CString "")) (CApp (CApp (CVar "Lune.Prelude.Cons") (CString "Rules:")) (CApp (CApp (CVar "Lune.Prelude.Cons") (CString "- Output ONLY valid JSON.")) (CApp (CApp (CVar "Lune.Prelude.Cons") (CString "- No markdown.")) (CApp (CApp (CVar "Lune.Prelude.Cons") (CString "- No code fences.")) (CApp (CApp (CVar "Lune.Prelude.Cons") (CString "- No prose or explanations.")) (CApp (CApp (CVar "Lune.Prelude.Cons") (CString "- No leading or trailing text.")) (CApp (CApp (CVar "Lune.Prelude.Cons") (CString "- Do not add extra keys beyond the requested schema.")) (CVar "Lune.Prelude.Nil"))))))))))),CoreDecl "" (CInt 0),CoreDecl "Nova.Prompt.toolPostamble" (CApp (CVar "Lune.String.unlines") (CApp (CApp (CVar "Lune.Prelude.Cons") (CString "Output ONLY JSON now.")) (CVar "Lune.Prelude.Nil"))),CoreDecl "" (CInt 0),CoreDecl "Nova.Prompt.composeToolPrompt" (CLam [PVar "spec",PVar "userPrompt"] (CApp (CVar "Lune.String.unlines") (CApp (CApp (CVar "Lune.Prelude.Cons") (CVar "Nova.Prompt.toolPreamble")) (CApp (CApp (CVar "Lune.Prelude.Cons") (CString "")) (CApp (CApp (CVar "Lune.Prelude.Cons") (CApp (CApp (CVar "Lune.String.append") (CString "Tool: ")) (CApp (CVar "Nova.Tool.toolIdToString") (CSelect (CVar "spec") "id")))) (CApp (CApp (CVar "Lune.Prelude.Cons") (CApp (CApp (CVar "Lune.String.append") (CString "Description: ")) (CSelect (CVar "spec") "description"))) (CApp (CApp (CVar "Lune.Prelude.Cons") (CApp (CApp (CVar "Lune.String.append") (CString "Schema: ")) (CApp (CVar "Lune.Json.stringify") (CSelect (CVar "spec") "schema")))) (CApp (CApp (CVar "Lune.Prelude.Cons") (CString "")) (CApp (CApp (CVar "Lune.Prelude.Cons") (CString "User:")) (CApp (CApp (CVar "Lune.Prelude.Cons") (CVar "userPrompt")) (CApp (CApp (CVar "Lune.Prelude.Cons") (CString "")) (CApp (CApp (CVar "Lune.Prelude.Cons") (CVar "Nova.Prompt.toolPostamble")) (CVar "Lune.Prelude.Nil"))))))))))))),CoreDecl "" (CInt 0),CoreDecl "Nova.Prompt.extractJson" (CLam [PVar "s"] (CCase (CApp (CVar "Nova.Prompt.extractJsonTrimmed") (CApp (CVar "Lune.String.trim") (CVar "s"))) [CoreAlt (PCon "Lune.Prelude.Ok" [Located {locSpan = Span {spanStartLine = 61, spanStartCol = 8, spanEndLine = 61, spanEndCol = 12}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "raw"}]) (CApp (CVar "Lune.Prelude.Ok") (CVar "raw")),CoreAlt (PCon "Lune.Prelude.Err" [Located {locSpan = Span {spanStartLine = 63, spanStartCol = 9, spanEndLine = 63, spanEndCol = 13}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "msg"}]) (CApp (CVar "Lune.Prelude.Err") (CApp (CVar "Nova.Core.DecodeError") (CVar "msg")))])),CoreDecl "" (CInt 0),CoreDecl "Nova.Prompt.extractJsonTrimmed" (CLam [PVar "t"] (CCase (CApp (CVar "Nova.Prompt.startsLikeJsonContainer") (CVar "t")) [CoreAlt (PCon "Lune.Prelude.True" []) (CCase (CApp (CVar "Nova.Prompt.validateJson") (CVar "t")) [CoreAlt (PCon "Lune.Prelude.Ok" [Located {locSpan = Span {spanStartLine = 71, spanStartCol = 12, spanEndLine = 71, spanEndCol = 14}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PWildcard}]) (CApp (CVar "Lune.Prelude.Ok") (CVar "t")),CoreAlt (PCon "Lune.Prelude.Err" [Located {locSpan = Span {spanStartLine = 73, spanStartCol = 13, spanEndLine = 73, spanEndCol = 15}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PWildcard}]) (CApp (CVar "Nova.Prompt.extractViaSlice") (CVar "t"))]),CoreAlt (PCon "Lune.Prelude.False" []) (CApp (CVar "Nova.Prompt.extractViaSlice") (CVar "t"))])),CoreDecl "" (CInt 0),CoreDecl "Nova.Prompt.startsLikeJsonContainer" (CLam [PVar "t"] (CCase (CApp (CApp (CVar "Lune.String.startsWith") (CString "{")) (CVar "t")) [CoreAlt (PCon "Lune.Prelude.True" []) (CVar "Lune.Prelude.True"),CoreAlt (PCon "Lune.Prelude.False" []) (CApp (CApp (CVar "Lune.String.startsWith") (CString "[")) (CVar "t"))])),CoreDecl "" (CInt 0),CoreDecl "Nova.Prompt.extractViaSlice" (CLam [PVar "t"] (CCase (CApp (CVar "Nova.Prompt.findJsonSlice") (CVar "t")) [CoreAlt (PCon "Lune.Prelude.Err" [Located {locSpan = Span {spanStartLine = 88, spanStartCol = 9, spanEndLine = 88, spanEndCol = 11}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PWildcard}]) (CApp (CVar "Lune.Prelude.Err") (CApp (CApp (CVar "Lune.String.append") (CString "Could not find JSON in response: ")) (CApp (CApp (CVar "Nova.Prompt.snippet") (CInt 240)) (CVar "t")))),CoreAlt (PCon "Lune.Prelude.Ok" [Located {locSpan = Span {spanStartLine = 90, spanStartCol = 8, spanEndLine = 90, spanEndCol = 12}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "raw"}]) (CCase (CApp (CVar "Nova.Prompt.validateJson") (CVar "raw")) [CoreAlt (PCon "Lune.Prelude.Ok" [Located {locSpan = Span {spanStartLine = 92, spanStartCol = 12, spanEndLine = 92, spanEndCol = 14}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PWildcard}]) (CApp (CVar "Lune.Prelude.Ok") (CVar "raw")),CoreAlt (PCon "Lune.Prelude.Err" [Located {locSpan = Span {spanStartLine = 93, spanStartCol = 13, spanEndLine = 93, spanEndCol = 15}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PWildcard}]) (CApp (CVar "Lune.Prelude.Err") (CApp (CApp (CVar "Lune.String.append") (CString "Could not parse JSON in response: ")) (CApp (CApp (CVar "Nova.Prompt.snippet") (CInt 240)) (CVar "raw"))))])])),CoreDecl "" (CInt 0),CoreDecl "Nova.Prompt.validateJson" (CLam [PVar "raw"] (CApp (CVar "Lune.Json.parse") (CVar "raw"))),CoreDecl "" (CInt 0),CoreDecl "Nova.Prompt.findJsonSlice" (CLam [PVar "t"] (CCase (CApp (CVar "Nova.Prompt.firstJsonStart") (CVar "t")) [CoreAlt (PCon "Lune.Prelude.Nothing" []) (CApp (CVar "Lune.Prelude.Err") (CString "no start")),CoreAlt (PCon "Lune.Prelude.Just" [Located {locSpan = Span {spanStartLine = 104, spanStartCol = 10, spanEndLine = 104, spanEndCol = 16}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "start"}]) (CCase (CApp (CVar "Nova.Prompt.lastJsonEnd") (CVar "t")) [CoreAlt (PCon "Lune.Prelude.Nothing" []) (CApp (CVar "Lune.Prelude.Err") (CString "no end")),CoreAlt (PCon "Lune.Prelude.Just" [Located {locSpan = Span {spanStartLine = 108, spanStartCol = 14, spanEndLine = 108, spanEndCol = 18}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "end"}]) (CCase (CApp (CApp (CVar "Nova.Prompt.ltInt") (CVar "start")) (CVar "end")) [CoreAlt (PCon "Lune.Prelude.True" []) (CApp (CVar "Lune.Prelude.Ok") (CApp (CApp (CApp (CVar "Nova.Prompt.sliceInclusive") (CVar "start")) (CVar "end")) (CVar "t"))),CoreAlt (PCon "Lune.Prelude.False" []) (CApp (CVar "Lune.Prelude.Err") (CString "invalid slice"))])])])),CoreDecl "" (CInt 0),CoreDecl "Nova.Prompt.firstJsonStart" (CLam [PVar "t"] (CApp (CApp (CVar "Nova.Prompt.minMaybe") (CApp (CApp (CVar "Lune.String.indexOf") (CString "{")) (CVar "t"))) (CApp (CApp (CVar "Lune.String.indexOf") (CString "[")) (CVar "t")))),CoreDecl "" (CInt 0),CoreDecl "Nova.Prompt.lastJsonEnd" (CLam [PVar "t"] (CApp (CApp (CVar "Nova.Prompt.maxMaybe") (CApp (CApp (CVar "Nova.Prompt.lastIndexOfChar") (CApp (CVar "prim_intToChar") (CInt 125))) (CVar "t"))) (CApp (CApp (CVar "Nova.Prompt.lastIndexOfChar") (CApp (CVar "prim_intToChar") (CInt 93))) (CVar "t")))),CoreDecl "" (CInt 0),CoreDecl "Nova.Prompt.lastIndexOfChar" (CLam [PVar "c",PVar "s"] (CApp (CApp (CApp (CApp (CVar "Nova.Prompt.lastIndexOfCharGo") (CVar "c")) (CApp (CVar "Lune.String.toChars") (CVar "s"))) (CInt 0)) (CVar "Lune.Prelude.Nothing"))),CoreDecl "" (CInt 0),CoreDecl "Nova.Prompt.lastIndexOfCharGo" (CLam [PVar "c",PVar "chars",PVar "idx",PVar "last"] (CCase (CVar "chars") [CoreAlt (PCon "Lune.Prelude.Nil" []) (CVar "last"),CoreAlt (PCon "Lune.Prelude.Cons" [Located {locSpan = Span {spanStartLine = 134, spanStartCol = 10, spanEndLine = 134, spanEndCol = 12}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "x"},Located {locSpan = Span {spanStartLine = 134, spanStartCol = 12, spanEndLine = 134, spanEndCol = 15}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "xs"}]) (CCase (CApp (CApp (CVar "prim_eqInt") (CApp (CVar "prim_charToInt") (CVar "x"))) (CApp (CVar "prim_charToInt") (CVar "c"))) [CoreAlt (PCon "Lune.Prelude.True" []) (CApp (CApp (CApp (CApp (CVar "Nova.Prompt.lastIndexOfCharGo") (CVar "c")) (CVar "xs")) (CApp (CApp (CVar "Lune.Int.add") (CVar "idx")) (CInt 1))) (CApp (CVar "Lune.Prelude.Just") (CVar "idx"))),CoreAlt (PCon "Lune.Prelude.False" []) (CApp (CApp (CApp (CApp (CVar "Nova.Prompt.lastIndexOfCharGo") (CVar "c")) (CVar "xs")) (CApp (CApp (CVar "Lune.Int.add") (CVar "idx")) (CInt 1))) (CVar "last"))])])),CoreDecl "" (CInt 0),CoreDecl "Nova.Prompt.minMaybe" (CLam [PVar "a",PVar "b"] (CCase (CVar "a") [CoreAlt (PCon "Lune.Prelude.Nothing" []) (CVar "b"),CoreAlt (PCon "Lune.Prelude.Just" [Located {locSpan = Span {spanStartLine = 145, spanStartCol = 10, spanEndLine = 145, spanEndCol = 12}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "x"}]) (CCase (CVar "b") [CoreAlt (PCon "Lune.Prelude.Nothing" []) (CVar "a"),CoreAlt (PCon "Lune.Prelude.Just" [Located {locSpan = Span {spanStartLine = 148, spanStartCol = 14, spanEndLine = 148, spanEndCol = 16}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "y"}]) (CCase (CApp (CApp (CVar "prim_leInt") (CVar "x")) (CVar "y")) [CoreAlt (PCon "Lune.Prelude.True" []) (CApp (CVar "Lune.Prelude.Just") (CVar "x")),CoreAlt (PCon "Lune.Prelude.False" []) (CApp (CVar "Lune.Prelude.Just") (CVar "y"))])])])),CoreDecl "" (CInt 0),CoreDecl "Nova.Prompt.maxMaybe" (CLam [PVar "a",PVar "b"] (CCase (CVar "a") [CoreAlt (PCon "Lune.Prelude.Nothing" []) (CVar "b"),CoreAlt (PCon "Lune.Prelude.Just" [Located {locSpan = Span {spanStartLine = 157, spanStartCol = 10, spanEndLine = 157, spanEndCol = 12}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "x"}]) (CCase (CVar "b") [CoreAlt (PCon "Lune.Prelude.Nothing" []) (CVar "a"),CoreAlt (PCon "Lune.Prelude.Just" [Located {locSpan = Span {spanStartLine = 160, spanStartCol = 14, spanEndLine = 160, spanEndCol = 16}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "y"}]) (CCase (CApp (CApp (CVar "prim_leInt") (CVar "x")) (CVar "y")) [CoreAlt (PCon "Lune.Prelude.True" []) (CApp (CVar "Lune.Prelude.Just") (CVar "y")),CoreAlt (PCon "Lune.Prelude.False" []) (CApp (CVar "Lune.Prelude.Just") (CVar "x"))])])])),CoreDecl "" (CInt 0),CoreDecl "Nova.Prompt.sliceInclusive" (CLam [PVar "start",PVar "end",PVar "s"] (CLet "len" (CApp (CApp (CVar "Lune.Int.add") (CApp (CApp (CVar "Lune.Int.sub") (CVar "end")) (CVar "start"))) (CInt 1)) (CApp (CApp (CVar "Lune.String.take") (CVar "len")) (CApp (CApp (CVar "Lune.String.drop") (CVar "start")) (CVar "s"))))),CoreDecl "" (CInt 0),CoreDecl "Nova.Prompt.ltInt" (CLam [PVar "a",PVar "b"] (CCase (CApp (CApp (CVar "prim_leInt") (CVar "a")) (CVar "b")) [CoreAlt (PCon "Lune.Prelude.True" []) (CCase (CApp (CApp (CVar "prim_eqInt") (CVar "a")) (CVar "b")) [CoreAlt (PCon "Lune.Prelude.True" []) (CVar "Lune.Prelude.False"),CoreAlt (PCon "Lune.Prelude.False" []) (CVar "Lune.Prelude.True")]),CoreAlt (PCon "Lune.Prelude.False" []) (CVar "Lune.Prelude.False")])),CoreDecl "" (CInt 0),CoreDecl "Nova.Prompt.snippet" (CLam [PVar "n",PVar "s"] (CCase (CApp (CApp (CVar "prim_leInt") (CApp (CVar "Lune.String.length") (CVar "s"))) (CVar "n")) [CoreAlt (PCon "Lune.Prelude.True" []) (CVar "s"),CoreAlt (PCon "Lune.Prelude.False" []) (CApp (CApp (CVar "Lune.String.append") (CApp (CApp (CVar "Lune.String.take") (CVar "n")) (CVar "s"))) (CString "\8230"))])),CoreDecl "" (CInt 0),CoreDecl "" (CInt 0),CoreDecl "" (CInt 0),CoreDecl "" (CInt 0),CoreDecl "" (CInt 0),CoreDecl "Lune.Atomic.commit" (CLam [PVar "ma"] (CApp (CVar "Lune.Prelude.Task") (CApp (CApp (CVar "Lune.IO.andThen") (CApp (CVar "prim_atomically") (CVar "ma"))) (CLam [PVar "a"] (CApp (CVar "Lune.IO.pure") (CApp (CVar "Lune.Prelude.Ok") (CVar "a"))))))),CoreDecl "" (CInt 0),CoreDecl "Lune.Atomic.new" (CVar "prim_newTVar"),CoreDecl "" (CInt 0),CoreDecl "Lune.Atomic.read" (CVar "prim_readTVar"),CoreDecl "" (CInt 0),CoreDecl "Lune.Atomic.write" (CVar "prim_writeTVar"),CoreDecl "" (CInt 0),CoreDecl "Lune.Atomic.wait" (CVar "prim_retry"),CoreDecl "" (CInt 0),CoreDecl "Lune.Atomic.orElse" (CVar "prim_orElse"),CoreDecl "" (CInt 0),CoreDecl "" (CInt 0),CoreDecl "" (CInt 0),CoreDecl "Nova.Runtime.executeWithGuards" (CLam [PVar "cfg",PVar "spec",PVar "input"] (CApp (CApp (CApp (CApp (CVar "Nova.Runtime.executeWithGuardsUsing") (CVar "cfg")) (CVar "spec")) (CLam [PWildcard] (CApp (CVar "Lune.Task.fail") (CApp (CVar "Nova.Runtime.ToolNotImplemented") (CSelect (CVar "spec") "id"))))) (CVar "input"))),CoreDecl "" (CInt 0),CoreDecl "Nova.Runtime.executeWithGuardsUsing" (CLam [PVar "cfg",PVar "spec",PVar "exec",PVar "input"] (CCase (CApp (CApp (CVar "Nova.Runtime.guardTool") (CVar "cfg")) (CSelect (CVar "spec") "id")) [CoreAlt (PCon "Lune.Prelude.Err" [Located {locSpan = Span {spanStartLine = 49, spanStartCol = 9, spanEndLine = 49, spanEndCol = 11}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "e"}]) (CApp (CVar "Lune.Task.fail") (CVar "e")),CoreAlt (PCon "Lune.Prelude.Ok" [Located {locSpan = Span {spanStartLine = 52, spanStartCol = 8, spanEndLine = 52, spanEndCol = 10}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PWildcard}]) (CApp (CApp (CApp (CVar "Nova.Runtime.withTimeout") (CSelect (CVar "cfg") "toolTimeoutMs")) (CSelect (CVar "spec") "id")) (CApp (CVar "exec") (CVar "input")))])),CoreDecl "" (CInt 0),CoreDecl "Nova.Runtime.guardTool" (CLam [PVar "cfg",PVar "toolId"] (CCase (CApp (CApp (CVar "prim_leInt") (CSelect (CVar "cfg") "maxTurns")) (CInt 0)) [CoreAlt (PCon "Lune.Prelude.True" []) (CApp (CVar "Lune.Prelude.Err") (CApp (CVar "Nova.Runtime.MaxTurnsExceeded") (CSelect (CVar "cfg") "maxTurns"))),CoreAlt (PCon "Lune.Prelude.False" []) (CCase (CApp (CApp (CApp (CVar "Nova.Core.setMember") (CVar "Nova.Tool.eqToolId")) (CVar "toolId")) (CSelect (CVar "cfg") "allowedTools")) [CoreAlt (PCon "Lune.Prelude.False" []) (CApp (CVar "Lune.Prelude.Err") (CApp (CVar "Nova.Runtime.ToolNotAllowed") (CVar "toolId"))),CoreAlt (PCon "Lune.Prelude.True" []) (CCase (CApp (CApp (CApp (CVar "Nova.Core.setMember") (CVar "Nova.Tool.eqToolId")) (CVar "toolId")) (CSelect (CVar "cfg") "requireApproval")) [CoreAlt (PCon "Lune.Prelude.True" []) (CApp (CVar "Lune.Prelude.Err") (CApp (CVar "Nova.Runtime.ApprovalRequired") (CVar "toolId"))),CoreAlt (PCon "Lune.Prelude.False" []) (CApp (CVar "Lune.Prelude.Ok") (CVar "Lune.Prelude.unit"))])])])),CoreDecl "" (CInt 0),CoreDecl "Nova.Runtime.withTimeout" (CLam [PVar "timeoutMs",PVar "toolId",PVar "task"] (CApp (CApp (CSelect (CVar "$dictMonad_Task") "andThen") (CApp (CVar "Lune.Atomic.commit") (CApp (CVar "Lune.Atomic.new") (CVar "Lune.Prelude.Nothing")))) (CLam [PVar "resultVar"] (CApp (CApp (CSelect (CVar "$dictMonad_Task") "andThen") (CApp (CVar "Lune.Fiber.spawn") (CApp (CApp (CVar "Nova.Runtime.writeToolResult") (CVar "resultVar")) (CVar "task")))) (CLam [PWildcard] (CApp (CApp (CSelect (CVar "$dictMonad_Task") "andThen") (CApp (CVar "Lune.Fiber.spawn") (CApp (CApp (CApp (CVar "Nova.Runtime.writeTimeoutResult") (CVar "resultVar")) (CVar "timeoutMs")) (CVar "toolId")))) (CLam [PWildcard] (CApp (CApp (CSelect (CVar "$dictMonad_Task") "andThen") (CApp (CVar "Lune.Atomic.commit") (CApp (CVar "Nova.Runtime.awaitJust") (CVar "resultVar")))) (CLam [PVar "r"] (CCase (CVar "r") [CoreAlt (PCon "Lune.Prelude.Ok" [Located {locSpan = Span {spanStartLine = 82, spanStartCol = 10, spanEndLine = 82, spanEndCol = 12}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "a"}]) (CApp (CVar "Lune.Task.succeed") (CVar "a")),CoreAlt (PCon "Lune.Prelude.Err" [Located {locSpan = Span {spanStartLine = 84, spanStartCol = 11, spanEndLine = 84, spanEndCol = 13}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "e"}]) (CApp (CVar "Lune.Task.fail") (CVar "e"))])))))))))),CoreDecl "" (CInt 0),CoreDecl "Nova.Runtime.writeToolResult" (CLam [PVar "resultVar",PVar "task"] (CApp (CApp (CSelect (CVar "$dictMonad_Task") "andThen") (CApp (CVar "Lune.Task.fromIO") (CApp (CVar "Lune.Task.attempt") (CVar "task")))) (CLam [PVar "r"] (CApp (CVar "Lune.Atomic.commit") (CApp (CApp (CVar "Nova.Runtime.writeIfNothing") (CVar "resultVar")) (CVar "r")))))),CoreDecl "" (CInt 0),CoreDecl "Nova.Runtime.writeTimeoutResult" (CLam [PVar "resultVar",PVar "timeoutMs",PVar "toolId"] (CApp (CApp (CSelect (CVar "$dictMonad_Task") "andThen") (CApp (CVar "Lune.IO.sleepMs") (CVar "timeoutMs"))) (CLam [PWildcard] (CApp (CVar "Lune.Atomic.commit") (CApp (CApp (CVar "Nova.Runtime.writeIfNothing") (CVar "resultVar")) (CApp (CVar "Lune.Prelude.Err") (CApp (CVar "Nova.Runtime.ToolTimedOut") (CVar "toolId")))))))),CoreDecl "" (CInt 0),CoreDecl "Nova.Runtime.writeIfNothing" (CLam [PVar "var",PVar "value"] (CApp (CApp (CSelect (CVar "$dictMonad_STM") "andThen") (CApp (CVar "Lune.Atomic.read") (CVar "var"))) (CLam [PVar "current"] (CCase (CVar "current") [CoreAlt (PCon "Lune.Prelude.Nothing" []) (CApp (CApp (CVar "Lune.Atomic.write") (CVar "var")) (CApp (CVar "Lune.Prelude.Just") (CVar "value"))),CoreAlt (PCon "Lune.Prelude.Just" [Located {locSpan = Span {spanStartLine = 106, spanStartCol = 12, spanEndLine = 106, spanEndCol = 14}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PWildcard}]) (CApp (CSelect (CVar "$dictApplicative_STM") "pure") (CVar "Lune.Prelude.unit"))])))),CoreDecl "" (CInt 0),CoreDecl "Nova.Runtime.awaitJust" (CLam [PVar "var"] (CApp (CApp (CSelect (CVar "$dictMonad_STM") "andThen") (CApp (CVar "Lune.Atomic.read") (CVar "var"))) (CLam [PVar "v"] (CCase (CVar "v") [CoreAlt (PCon "Lune.Prelude.Nothing" []) (CVar "Lune.Atomic.wait"),CoreAlt (PCon "Lune.Prelude.Just" [Located {locSpan = Span {spanStartLine = 116, spanStartCol = 12, spanEndLine = 116, spanEndCol = 14}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "x"}]) (CApp (CSelect (CVar "$dictApplicative_STM") "pure") (CVar "x"))])))),CoreDecl "" (CInt 0),CoreDecl "" (CInt 0),CoreDecl "Json.decode" (CLam [PVar "$dictJson.Decode0",PVar "s"] (CCase (CApp (CApp (CVar "Json.decodeDetailed") (CVar "$dictJson.Decode0")) (CVar "s")) [CoreAlt (PCon "Lune.Prelude.Ok" [Located {locSpan = Span {spanStartLine = 28, spanStartCol = 8, spanEndLine = 28, spanEndCol = 10}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "a"}]) (CApp (CVar "Lune.Prelude.Ok") (CVar "a")),CoreAlt (PCon "Lune.Prelude.Err" [Located {locSpan = Span {spanStartLine = 30, spanStartCol = 9, spanEndLine = 30, spanEndCol = 13}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "err"}]) (CApp (CVar "Lune.Prelude.Err") (CSelect (CVar "err") "message"))])),CoreDecl "" (CInt 0),CoreDecl "Json.decodeDetailed" (CLam [PVar "$dictJson.Decode0",PVar "s"] (CCase (CApp (CVar "Lune.Json.parse") (CVar "s")) [CoreAlt (PCon "Lune.Prelude.Err" [Located {locSpan = Span {spanStartLine = 36, spanStartCol = 9, spanEndLine = 36, spanEndCol = 13}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "msg"}]) (CApp (CVar "Lune.Prelude.Err") (CRecord [("message",CVar "msg"),("path",CVar "Lune.Prelude.Nil")])),CoreAlt (PCon "Lune.Prelude.Ok" [Located {locSpan = Span {spanStartLine = 38, spanStartCol = 8, spanEndLine = 38, spanEndCol = 13}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "json"}]) (CApp (CApp (CVar "Lune.Json.Decode.decodeValue") (CSelect (CVar "$dictJson.Decode0") "decoder")) (CVar "json"))])),CoreDecl "" (CInt 0),CoreDecl "" (CInt 0),CoreDecl "" (CInt 0),CoreDecl "" (CInt 0),CoreDecl "" (CInt 0),CoreDecl "" (CInt 0),CoreDecl "Nova.openrouter" (CVar "Nova.Core.openrouter"),CoreDecl "" (CInt 0),CoreDecl "Nova.ollama" (CVar "Nova.Core.ollama"),CoreDecl "" (CInt 0),CoreDecl "Nova.provider" (CLam [PVar "s"] (CApp (CVar "Nova.Core.Provider") (CVar "s"))),CoreDecl "" (CInt 0),CoreDecl "Nova.providerId" (CVar "Nova.Core.providerId"),CoreDecl "" (CInt 0),CoreDecl "Nova.providerEq" (CVar "Nova.eqProvider"),CoreDecl "" (CInt 0),CoreDecl "Nova.showProvider" (CVar "Nova.providerId"),CoreDecl "" (CInt 0),CoreDecl "Nova.showError" (CLam [PVar "e"] (CCase (CVar "e") [CoreAlt (PCon "Nova.Core.NetworkError" [Located {locSpan = Span {spanStartLine = 126, spanStartCol = 18, spanEndLine = 126, spanEndCol = 22}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "msg"}]) (CApp (CApp (CVar "Lune.String.append") (CString "NetworkError ")) (CVar "msg")),CoreAlt (PCon "Nova.Core.RateLimited" []) (CString "RateLimited"),CoreAlt (PCon "Nova.Core.Unauthorized" []) (CString "Unauthorized"),CoreAlt (PCon "Nova.Core.BadRequest" [Located {locSpan = Span {spanStartLine = 132, spanStartCol = 16, spanEndLine = 132, spanEndCol = 20}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "msg"}]) (CApp (CApp (CVar "Lune.String.append") (CString "BadRequest ")) (CVar "msg")),CoreAlt (PCon "Nova.Core.ProviderError" [Located {locSpan = Span {spanStartLine = 134, spanStartCol = 19, spanEndLine = 134, spanEndCol = 23}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "msg"}]) (CApp (CApp (CVar "Lune.String.append") (CString "ProviderError ")) (CVar "msg")),CoreAlt (PCon "Nova.Core.DecodeError" [Located {locSpan = Span {spanStartLine = 136, spanStartCol = 17, spanEndLine = 136, spanEndCol = 21}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "msg"}]) (CApp (CApp (CVar "Lune.String.append") (CString "DecodeError ")) (CVar "msg"))])),CoreDecl "" (CInt 0),CoreDecl "Nova.showAskResult" (CLam [PVar "r"] (CCase (CVar "r") [CoreAlt (PCon "Lune.Prelude.Err" [Located {locSpan = Span {spanStartLine = 142, spanStartCol = 9, spanEndLine = 142, spanEndCol = 11}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "e"}]) (CApp (CVar "Nova.showError") (CVar "e")),CoreAlt (PCon "Lune.Prelude.Ok" [Located {locSpan = Span {spanStartLine = 144, spanStartCol = 8, spanEndLine = 144, spanEndCol = 10}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "s"}]) (CVar "s")])),CoreDecl "" (CInt 0),CoreDecl "Nova.showJsonResult" (CLam [PVar "r"] (CCase (CVar "r") [CoreAlt (PCon "Lune.Prelude.Err" [Located {locSpan = Span {spanStartLine = 150, spanStartCol = 9, spanEndLine = 150, spanEndCol = 11}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "e"}]) (CApp (CVar "Nova.showError") (CVar "e")),CoreAlt (PCon "Lune.Prelude.Ok" [Located {locSpan = Span {spanStartLine = 152, spanStartCol = 8, spanEndLine = 152, spanEndCol = 10}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "j"}]) (CApp (CVar "Lune.Json.stringify") (CVar "j"))])),CoreDecl "" (CInt 0),CoreDecl "" (CInt 0),CoreDecl "" (CInt 0),CoreDecl "Nova.newClient" (CLam [PVar "providers",PVar "provider",PVar "model"] (CRecord [("provider",CVar "provider"),("model",CVar "model"),("providerConfig",CVar "Nova.Core.defaultProviderConfig"),("providers",CVar "providers"),("hooks",CVar "Lune.Prelude.Nothing")])),CoreDecl "" (CInt 0),CoreDecl "Nova.defaultClient" (CApp (CApp (CApp (CVar "Nova.newClient") (CVar "Nova.Core.defaultProviderRegistry")) (CVar "Nova.ollama")) (CString "llama3")),CoreDecl "" (CInt 0),CoreDecl "Nova.withProvider" (CLam [PVar "provider",PVar "client"] (CRecord [("provider",CVar "provider"),("model",CSelect (CVar "client") "model"),("providerConfig",CSelect (CVar "client") "providerConfig"),("providers",CSelect (CVar "client") "providers"),("hooks",CSelect (CVar "client") "hooks")])),CoreDecl "" (CInt 0),CoreDecl "Nova.withModel" (CLam [PVar "model",PVar "client"] (CRecord [("provider",CSelect (CVar "client") "provider"),("model",CVar "model"),("providerConfig",CSelect (CVar "client") "providerConfig"),("providers",CSelect (CVar "client") "providers"),("hooks",CSelect (CVar "client") "hooks")])),CoreDecl "" (CInt 0),CoreDecl "Nova.withHooks" (CLam [PVar "hooks",PVar "client"] (CRecord [("provider",CSelect (CVar "client") "provider"),("model",CSelect (CVar "client") "model"),("providerConfig",CSelect (CVar "client") "providerConfig"),("providers",CSelect (CVar "client") "providers"),("hooks",CApp (CVar "Lune.Prelude.Just") (CVar "hooks"))])),CoreDecl "" (CInt 0),CoreDecl "Nova.withoutHooks" (CLam [PVar "client"] (CRecord [("provider",CSelect (CVar "client") "provider"),("model",CSelect (CVar "client") "model"),("providerConfig",CSelect (CVar "client") "providerConfig"),("providers",CSelect (CVar "client") "providers"),("hooks",CVar "Lune.Prelude.Nothing")])),CoreDecl "" (CInt 0),CoreDecl "Nova.eqProvider" (CLam [PVar "a",PVar "b"] (CApp (CApp (CVar "Lune.String.eq") (CApp (CVar "Nova.providerId") (CVar "a"))) (CApp (CVar "Nova.providerId") (CVar "b")))),CoreDecl "" (CInt 0),CoreDecl "Nova.defaultSettings" (CRecord [("baseUrl",CString ""),("apiKey",CVar "Lune.Prelude.Nothing"),("appName",CVar "Lune.Prelude.Nothing")]),CoreDecl "" (CInt 0),CoreDecl "Nova.getSettings" (CLam [PVar "provider",PVar "cfg"] (CCase (CApp (CApp (CApp (CVar "Nova.Core.dictGet") (CVar "Nova.eqProvider")) (CVar "provider")) (CVar "cfg")) [CoreAlt (PCon "Lune.Prelude.Just" [Located {locSpan = Span {spanStartLine = 242, spanStartCol = 10, spanEndLine = 242, spanEndCol = 12}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "s"}]) (CVar "s"),CoreAlt (PCon "Lune.Prelude.Nothing" []) (CVar "Nova.defaultSettings")])),CoreDecl "" (CInt 0),CoreDecl "Nova.updateSettings" (CLam [PVar "provider",PVar "f",PVar "client"] (CLet "current" (CApp (CApp (CVar "Nova.getSettings") (CVar "provider")) (CSelect (CVar "client") "providerConfig")) (CLet "next" (CApp (CVar "f") (CVar "current")) (CRecord [("provider",CSelect (CVar "client") "provider"),("model",CSelect (CVar "client") "model"),("providerConfig",CApp (CApp (CApp (CApp (CVar "Nova.Core.dictInsert") (CVar "Nova.eqProvider")) (CVar "provider")) (CVar "next")) (CSelect (CVar "client") "providerConfig")),("providers",CSelect (CVar "client") "providers"),("hooks",CSelect (CVar "client") "hooks")])))),CoreDecl "" (CInt 0),CoreDecl "Nova.withOpenRouterKey" (CLam [PVar "key"] (CApp (CApp (CVar "Nova.updateSettings") (CVar "Nova.openrouter")) (CLam [PVar "s"] (CRecord [("baseUrl",CSelect (CVar "s") "baseUrl"),("apiKey",CApp (CVar "Lune.Prelude.Just") (CVar "key")),("appName",CSelect (CVar "s") "appName")])))),CoreDecl "" (CInt 0),CoreDecl "Nova.withOpenRouterBaseUrl" (CLam [PVar "url"] (CApp (CApp (CVar "Nova.updateSettings") (CVar "Nova.openrouter")) (CLam [PVar "s"] (CRecord [("baseUrl",CVar "url"),("apiKey",CSelect (CVar "s") "apiKey"),("appName",CSelect (CVar "s") "appName")])))),CoreDecl "" (CInt 0),CoreDecl "Nova.withOllamaBaseUrl" (CLam [PVar "url"] (CApp (CApp (CVar "Nova.updateSettings") (CVar "Nova.ollama")) (CLam [PVar "s"] (CRecord [("baseUrl",CVar "url"),("apiKey",CSelect (CVar "s") "apiKey"),("appName",CSelect (CVar "s") "appName")])))),CoreDecl "" (CInt 0),CoreDecl "Nova.toolPreamble" (CVar "Nova.Prompt.toolPreamble"),CoreDecl "" (CInt 0),CoreDecl "Nova.toolPostamble" (CVar "Nova.Prompt.toolPostamble"),CoreDecl "" (CInt 0),CoreDecl "Nova.extractJson" (CVar "Nova.Prompt.extractJson"),CoreDecl "" (CInt 0),CoreDecl "Nova.composeToolPrompt" (CVar "Nova.Prompt.composeToolPrompt"),CoreDecl "" (CInt 0),CoreDecl "Nova.askRaw" (CLam [PVar "client",PVar "prompt"] (CLet "request" (CRecord [("provider",CSelect (CVar "client") "provider"),("model",CSelect (CVar "client") "model"),("prompt",CVar "prompt")]) (CApp (CApp (CVar "Lune.Task.andThen") (CApp (CVar "Nova.liftResult") (CApp (CApp (CApp (CApp (CApp (CVar "Nova.Core.callProvider") (CSelect (CVar "client") "providers")) (CSelect (CVar "client") "providerConfig")) (CSelect (CVar "client") "provider")) (CSelect (CVar "client") "model")) (CVar "prompt")))) (CLam [PVar "response"] (CCase (CSelect (CVar "client") "hooks") [CoreAlt (PCon "Lune.Prelude.Nothing" []) (CApp (CVar "Lune.Task.succeed") (CVar "response")),CoreAlt (PCon "Lune.Prelude.Just" [Located {locSpan = Span {spanStartLine = 318, spanStartCol = 16, spanEndLine = 318, spanEndCol = 22}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "hooks"}]) (CApp (CApp (CVar "Lune.Task.andThen") (CApp (CApp (CVar "Lune.Task.mapError") (CLam [PWildcard] (CApp (CVar "Nova.Core.ProviderError") (CString "hook failed")))) (CApp (CSelect (CVar "hooks") "onTurn") (CRecord [("request",CVar "request"),("response",CVar "response")])))) (CLam [PWildcard] (CApp (CVar "Lune.Task.succeed") (CVar "response"))))]))))),CoreDecl "" (CInt 0),CoreDecl "Nova.liftResult" (CLam [PVar "io"] (CApp (CVar "Lune.Prelude.Task") (CVar "io"))),CoreDecl "" (CInt 0),CoreDecl "Nova.ask" (CLam [PVar "client",PVar "prompt"] (CApp (CApp (CVar "Lune.Task.map") (CLam [PVar "response"] (CSelect (CVar "response") "text"))) (CApp (CApp (CVar "Nova.askRaw") (CVar "client")) (CVar "prompt")))),CoreDecl "" (CInt 0),CoreDecl "Nova.json" (CLam [PVar "$dictJson.Decode0",PVar "client",PVar "prompt"] (CApp (CApp (CVar "Lune.Task.andThen") (CApp (CApp (CVar "Nova.askRaw") (CVar "client")) (CVar "prompt"))) (CLam [PVar "response"] (CCase (CApp (CApp (CVar "Json.decodeDetailed") (CVar "$dictJson.Decode0")) (CSelect (CVar "response") "text")) [CoreAlt (PCon "Lune.Prelude.Ok" [Located {locSpan = Span {spanStartLine = 338, spanStartCol = 12, spanEndLine = 338, spanEndCol = 14}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "a"}]) (CApp (CVar "Lune.Task.succeed") (CVar "a")),CoreAlt (PCon "Lune.Prelude.Err" [Located {locSpan = Span {spanStartLine = 340, spanStartCol = 13, spanEndLine = 340, spanEndCol = 23}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "decodeErr"}]) (CApp (CVar "Lune.Task.fail") (CApp (CVar "Nova.Core.DecodeError") (CApp (CVar "Nova.formatDecodeError") (CVar "decodeErr"))))])))),CoreDecl "" (CInt 0),CoreDecl "Nova.tool" (CLam [PVar "$dictJson.Decode0",PVar "client",PVar "prompt"] (CLet "wrapped" (CApp (CVar "Lune.String.unlines") (CApp (CApp (CVar "Lune.Prelude.Cons") (CVar "Nova.toolPreamble")) (CApp (CApp (CVar "Lune.Prelude.Cons") (CString "")) (CApp (CApp (CVar "Lune.Prelude.Cons") (CVar "prompt")) (CApp (CApp (CVar "Lune.Prelude.Cons") (CString "")) (CApp (CApp (CVar "Lune.Prelude.Cons") (CVar "Nova.toolPostamble")) (CVar "Lune.Prelude.Nil"))))))) (CApp (CApp (CVar "Lune.Task.andThen") (CApp (CApp (CVar "Nova.askRaw") (CVar "client")) (CVar "wrapped"))) (CLam [PVar "response"] (CCase (CApp (CVar "Nova.extractJson") (CSelect (CVar "response") "text")) [CoreAlt (PCon "Lune.Prelude.Err" [Located {locSpan = Span {spanStartLine = 352, spanStartCol = 15, spanEndLine = 352, spanEndCol = 17}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "e"}]) (CApp (CVar "Lune.Task.fail") (CVar "e")),CoreAlt (PCon "Lune.Prelude.Ok" [Located {locSpan = Span {spanStartLine = 354, spanStartCol = 14, spanEndLine = 354, spanEndCol = 22}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "rawJson"}]) (CCase (CApp (CApp (CVar "Json.decodeDetailed") (CVar "$dictJson.Decode0")) (CVar "rawJson")) [CoreAlt (PCon "Lune.Prelude.Ok" [Located {locSpan = Span {spanStartLine = 356, spanStartCol = 18, spanEndLine = 356, spanEndCol = 20}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "a"}]) (CApp (CVar "Lune.Task.succeed") (CVar "a")),CoreAlt (PCon "Lune.Prelude.Err" [Located {locSpan = Span {spanStartLine = 358, spanStartCol = 19, spanEndLine = 358, spanEndCol = 29}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "decodeErr"}]) (CApp (CVar "Lune.Task.fail") (CApp (CVar "Nova.Core.DecodeError") (CApp (CVar "Nova.formatDecodeError") (CVar "decodeErr"))))])]))))),CoreDecl "" (CInt 0),CoreDecl "Nova.formatDecodeError" (CLam [PVar "err"] (CCase (CSelect (CVar "err") "path") [CoreAlt (PCon "Lune.Prelude.Nil" []) (CSelect (CVar "err") "message"),CoreAlt PWildcard (CApp (CApp (CVar "Lune.String.append") (CSelect (CVar "err") "message")) (CApp (CApp (CVar "Lune.String.append") (CString " at ")) (CApp (CVar "Nova.pathToString") (CSelect (CVar "err") "path"))))])),CoreDecl "" (CInt 0),CoreDecl "Nova.pathToString" (CLam [PVar "path"] (CApp (CApp (CVar "Nova.pathToStringGo") (CString "$")) (CVar "path"))),CoreDecl "" (CInt 0),CoreDecl "Nova.pathToStringGo" (CLam [PVar "acc",PVar "items"] (CCase (CVar "items") [CoreAlt (PCon "Lune.Prelude.Nil" []) (CVar "acc"),CoreAlt (PCon "Lune.Prelude.Cons" [Located {locSpan = Span {spanStartLine = 377, spanStartCol = 10, spanEndLine = 377, spanEndCol = 15}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "item"},Located {locSpan = Span {spanStartLine = 377, spanStartCol = 15, spanEndLine = 377, spanEndCol = 20}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "rest"}]) (CApp (CApp (CVar "Nova.pathToStringGo") (CApp (CApp (CVar "Lune.String.append") (CVar "acc")) (CApp (CVar "Nova.pathItemToString") (CVar "item")))) (CVar "rest"))])),CoreDecl "" (CInt 0),CoreDecl "Nova.pathItemToString" (CLam [PVar "item"] (CCase (CVar "item") [CoreAlt (PCon "Lune.Json.Decode.Field" [Located {locSpan = Span {spanStartLine = 383, spanStartCol = 11, spanEndLine = 383, spanEndCol = 16}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "name"}]) (CApp (CApp (CVar "Lune.String.append") (CString ".")) (CVar "name")),CoreAlt (PCon "Lune.Json.Decode.Index" [Located {locSpan = Span {spanStartLine = 385, spanStartCol = 11, spanEndLine = 385, spanEndCol = 13}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "i"}]) (CApp (CApp (CVar "Lune.String.append") (CString "[")) (CApp (CApp (CVar "Lune.String.append") (CApp (CVar "Lune.String.fromInt") (CVar "i"))) (CString "]")))])),CoreDecl "" (CInt 0),CoreDecl "" (CInt 0),CoreDecl "" (CInt 0),CoreDecl "Nova.next" (CLam [PVar "stream"] (CCase (CVar "stream") [CoreAlt (PCon "Nova.Stream" [Located {locSpan = Span {spanStartLine = 402, spanStartCol = 12, spanEndLine = 402, spanEndCol = 15}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "io"}]) (CVar "io")])),CoreDecl "" (CInt 0),CoreDecl "Nova.streamFromList" (CLam [PVar "xs"] (CApp (CVar "Nova.Stream") (CApp (CVar "Lune.IO.pure") (CApp (CVar "Lune.Prelude.Ok") (CApp (CVar "Nova.stepFromList") (CVar "xs")))))),CoreDecl "" (CInt 0),CoreDecl "Nova.stepFromList" (CLam [PVar "xs"] (CCase (CVar "xs") [CoreAlt (PCon "Lune.Prelude.Nil" []) (CVar "Nova.StreamEnd"),CoreAlt (PCon "Lune.Prelude.Cons" [Located {locSpan = Span {spanStartLine = 413, spanStartCol = 10, spanEndLine = 413, spanEndCol = 12}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "x"},Located {locSpan = Span {spanStartLine = 413, spanStartCol = 12, spanEndLine = 413, spanEndCol = 17}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "rest"}]) (CApp (CApp (CVar "Nova.StreamYield") (CVar "x")) (CApp (CVar "Nova.streamFromList") (CVar "rest")))])),CoreDecl "" (CInt 0),CoreDecl "" (CInt 0),CoreDecl "Nova.showNovaEvent" (CLam [PVar "ev"] (CCase (CVar "ev") [CoreAlt (PCon "Nova.TextDelta" [Located {locSpan = Span {spanStartLine = 425, spanStartCol = 15, spanEndLine = 425, spanEndCol = 17}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "s"}]) (CApp (CApp (CVar "Lune.String.append") (CString "TextDelta ")) (CVar "s")),CoreAlt (PCon "Nova.ToolCallDelta" [Located {locSpan = Span {spanStartLine = 427, spanStartCol = 19, spanEndLine = 427, spanEndCol = 21}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PWildcard}]) (CString "ToolCallDelta"),CoreAlt (PCon "Nova.ToolCallComplete" [Located {locSpan = Span {spanStartLine = 429, spanStartCol = 22, spanEndLine = 429, spanEndCol = 24}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PWildcard}]) (CString "ToolCallComplete"),CoreAlt (PCon "Nova.UsageFinal" [Located {locSpan = Span {spanStartLine = 431, spanStartCol = 16, spanEndLine = 431, spanEndCol = 18}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PWildcard}]) (CString "UsageFinal")])),CoreDecl "" (CInt 0),CoreDecl "Nova.showEvent" (CVar "Nova.showNovaEvent"),CoreDecl "" (CInt 0),CoreDecl "Nova.showStreamStep" (CLam [PVar "showA",PVar "step"] (CCase (CVar "step") [CoreAlt (PCon "Nova.StreamEnd" []) (CString "StreamEnd"),CoreAlt (PCon "Nova.StreamYield" [Located {locSpan = Span {spanStartLine = 442, spanStartCol = 17, spanEndLine = 442, spanEndCol = 19}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "a"},Located {locSpan = Span {spanStartLine = 442, spanStartCol = 19, spanEndLine = 442, spanEndCol = 21}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PWildcard}]) (CApp (CApp (CVar "Lune.String.append") (CString "StreamYield ")) (CApp (CVar "showA") (CVar "a")))])),CoreDecl "" (CInt 0),CoreDecl "Nova.showStreamResult" (CLam [PVar "showE",PVar "showA",PVar "r"] (CCase (CVar "r") [CoreAlt (PCon "Lune.Prelude.Err" [Located {locSpan = Span {spanStartLine = 449, spanStartCol = 9, spanEndLine = 449, spanEndCol = 11}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "e"}]) (CApp (CApp (CVar "Lune.String.append") (CString "StreamErr ")) (CApp (CVar "showE") (CVar "e"))),CoreAlt (PCon "Lune.Prelude.Ok" [Located {locSpan = Span {spanStartLine = 451, spanStartCol = 8, spanEndLine = 451, spanEndCol = 13}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "step"}]) (CApp (CApp (CVar "Nova.showStreamStep") (CVar "showA")) (CVar "step"))])),CoreDecl "" (CInt 0),CoreDecl "Nova.askStream" (CLam [PVar "client",PVar "prompt"] (CApp (CVar "Nova.Stream") (CApp (CApp (CVar "Lune.IO.andThen") (CApp (CVar "Lune.Task.attempt") (CApp (CApp (CVar "Nova.askRaw") (CVar "client")) (CVar "prompt")))) (CLam [PVar "r"] (CCase (CVar "r") [CoreAlt (PCon "Lune.Prelude.Err" [Located {locSpan = Span {spanStartLine = 461, spanStartCol = 15, spanEndLine = 461, spanEndCol = 17}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "e"}]) (CApp (CVar "Lune.IO.pure") (CApp (CVar "Lune.Prelude.Err") (CVar "e"))),CoreAlt (PCon "Lune.Prelude.Ok" [Located {locSpan = Span {spanStartLine = 463, spanStartCol = 14, spanEndLine = 463, spanEndCol = 23}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "response"}]) (CApp (CVar "Lune.IO.pure") (CApp (CVar "Lune.Prelude.Ok") (CApp (CVar "Nova.stepFromList") (CApp (CVar "Nova.responseToEvents") (CVar "response")))))]))))),CoreDecl "" (CInt 0),CoreDecl "Nova.responseToEvents" (CLam [PVar "response"] (CLet "chunks" (CApp (CApp (CVar "Nova.chunkText") (CInt 24)) (CSelect (CVar "response") "text")) (CLet "textEvents" (CApp (CApp (CVar "Nova.listMap") (CVar "Nova.TextDelta")) (CVar "chunks")) (CCase (CSelect (CVar "response") "usage") [CoreAlt (PCon "Lune.Prelude.Nothing" []) (CVar "textEvents"),CoreAlt (PCon "Lune.Prelude.Just" [Located {locSpan = Span {spanStartLine = 475, spanStartCol = 12, spanEndLine = 475, spanEndCol = 18}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "usage"}]) (CApp (CApp (CVar "Nova.listAppend") (CVar "textEvents")) (CApp (CApp (CVar "Lune.Prelude.Cons") (CApp (CVar "Nova.UsageFinal") (CVar "usage"))) (CVar "Lune.Prelude.Nil")))])))),CoreDecl "" (CInt 0),CoreDecl "Nova.chunkText" (CLam [PVar "chunkSize",PVar "s"] (CCase (CApp (CApp (CVar "prim_leInt") (CVar "chunkSize")) (CInt 0)) [CoreAlt (PCon "Lune.Prelude.True" []) (CCase (CApp (CVar "Lune.String.isEmpty") (CVar "s")) [CoreAlt (PCon "Lune.Prelude.True" []) (CVar "Lune.Prelude.Nil"),CoreAlt (PCon "Lune.Prelude.False" []) (CApp (CApp (CVar "Lune.Prelude.Cons") (CVar "s")) (CVar "Lune.Prelude.Nil"))]),CoreAlt (PCon "Lune.Prelude.False" []) (CCase (CApp (CApp (CVar "prim_leInt") (CApp (CVar "Lune.String.length") (CVar "s"))) (CVar "chunkSize")) [CoreAlt (PCon "Lune.Prelude.True" []) (CCase (CApp (CVar "Lune.String.isEmpty") (CVar "s")) [CoreAlt (PCon "Lune.Prelude.True" []) (CVar "Lune.Prelude.Nil"),CoreAlt (PCon "Lune.Prelude.False" []) (CApp (CApp (CVar "Lune.Prelude.Cons") (CVar "s")) (CVar "Lune.Prelude.Nil"))]),CoreAlt (PCon "Lune.Prelude.False" []) (CApp (CApp (CVar "Lune.Prelude.Cons") (CApp (CApp (CVar "Lune.String.take") (CVar "chunkSize")) (CVar "s"))) (CApp (CApp (CVar "Nova.chunkText") (CVar "chunkSize")) (CApp (CApp (CVar "Lune.String.drop") (CVar "chunkSize")) (CVar "s"))))])])),CoreDecl "" (CInt 0),CoreDecl "Nova.listMap" (CLam [PVar "f",PVar "xs"] (CCase (CVar "xs") [CoreAlt (PCon "Lune.Prelude.Nil" []) (CVar "Lune.Prelude.Nil"),CoreAlt (PCon "Lune.Prelude.Cons" [Located {locSpan = Span {spanStartLine = 505, spanStartCol = 10, spanEndLine = 505, spanEndCol = 12}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "x"},Located {locSpan = Span {spanStartLine = 505, spanStartCol = 12, spanEndLine = 505, spanEndCol = 17}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "rest"}]) (CApp (CApp (CVar "Lune.Prelude.Cons") (CApp (CVar "f") (CVar "x"))) (CApp (CApp (CVar "Nova.listMap") (CVar "f")) (CVar "rest")))])),CoreDecl "" (CInt 0),CoreDecl "Nova.listAppend" (CLam [PVar "xs",PVar "ys"] (CCase (CVar "xs") [CoreAlt (PCon "Lune.Prelude.Nil" []) (CVar "ys"),CoreAlt (PCon "Lune.Prelude.Cons" [Located {locSpan = Span {spanStartLine = 513, spanStartCol = 10, spanEndLine = 513, spanEndCol = 12}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "x"},Located {locSpan = Span {spanStartLine = 513, spanStartCol = 12, spanEndLine = 513, spanEndCol = 17}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "rest"}]) (CApp (CApp (CVar "Lune.Prelude.Cons") (CVar "x")) (CApp (CApp (CVar "Nova.listAppend") (CVar "rest")) (CVar "ys")))])),CoreDecl "" (CInt 0),CoreDecl "Nova.executeTool" (CLam [PVar "client",PVar "runtimeConfig",PVar "spec",PVar "encodeInput",PVar "encodeOutput",PVar "exec",PVar "input"] (CLet "inputJson" (CApp (CVar "encodeInput") (CVar "input")) (CApp (CApp (CSelect (CVar "$dictMonad_Task") "andThen") (CCase (CSelect (CVar "client") "hooks") [CoreAlt (PCon "Lune.Prelude.Nothing" []) (CApp (CVar "Lune.Task.succeed") (CVar "Lune.Prelude.unit")),CoreAlt (PCon "Lune.Prelude.Just" [Located {locSpan = Span {spanStartLine = 535, spanStartCol = 12, spanEndLine = 535, spanEndCol = 18}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "hooks"}]) (CApp (CApp (CVar "Lune.Task.mapError") (CLam [PWildcard] (CApp (CVar "Nova.Runtime.ToolFailed") (CString "hook failed")))) (CApp (CSelect (CVar "hooks") "onToolStart") (CRecord [("tool",CSelect (CVar "spec") "id"),("input",CVar "inputJson")])))])) (CLam [PWildcard] (CApp (CApp (CSelect (CVar "$dictMonad_Task") "andThen") (CApp (CVar "Lune.Task.fromIO") (CVar "prim_timeNowMicros"))) (CLam [PVar "t0"] (CApp (CApp (CSelect (CVar "$dictMonad_Task") "andThen") (CApp (CVar "Lune.Task.fromIO") (CApp (CVar "Lune.Task.attempt") (CApp (CApp (CApp (CApp (CVar "Nova.Runtime.executeWithGuardsUsing") (CVar "runtimeConfig")) (CVar "spec")) (CVar "exec")) (CVar "input"))))) (CLam [PVar "result"] (CApp (CApp (CSelect (CVar "$dictMonad_Task") "andThen") (CApp (CVar "Lune.Task.fromIO") (CVar "prim_timeNowMicros"))) (CLam [PVar "t1"] (CLet "durationMs" (CApp (CApp (CVar "Lune.Int.div") (CApp (CApp (CVar "Lune.Int.sub") (CVar "t1")) (CVar "t0"))) (CInt 1000)) (CLet "outputJson" (CCase (CVar "result") [CoreAlt (PCon "Lune.Prelude.Ok" [Located {locSpan = Span {spanStartLine = 550, spanStartCol = 12, spanEndLine = 550, spanEndCol = 14}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "b"}]) (CApp (CVar "encodeOutput") (CVar "b")),CoreAlt (PCon "Lune.Prelude.Err" [Located {locSpan = Span {spanStartLine = 552, spanStartCol = 13, spanEndLine = 552, spanEndCol = 15}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "e"}]) (CApp (CVar "Nova.encodeToolExecError") (CVar "e"))]) (CApp (CApp (CSelect (CVar "$dictMonad_Task") "andThen") (CCase (CSelect (CVar "client") "hooks") [CoreAlt (PCon "Lune.Prelude.Nothing" []) (CApp (CVar "Lune.Task.succeed") (CVar "Lune.Prelude.unit")),CoreAlt (PCon "Lune.Prelude.Just" [Located {locSpan = Span {spanStartLine = 558, spanStartCol = 12, spanEndLine = 558, spanEndCol = 18}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "hooks"}]) (CApp (CApp (CVar "Lune.Task.mapError") (CLam [PWildcard] (CApp (CVar "Nova.Runtime.ToolFailed") (CString "hook failed")))) (CApp (CSelect (CVar "hooks") "onToolFinish") (CRecord [("tool",CSelect (CVar "spec") "id"),("output",CVar "outputJson"),("durationMs",CVar "durationMs")])))])) (CLam [PWildcard] (CCase (CVar "result") [CoreAlt (PCon "Lune.Prelude.Ok" [Located {locSpan = Span {spanStartLine = 565, spanStartCol = 10, spanEndLine = 565, spanEndCol = 12}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "b"}]) (CApp (CVar "Lune.Task.succeed") (CVar "b")),CoreAlt (PCon "Lune.Prelude.Err" [Located {locSpan = Span {spanStartLine = 567, spanStartCol = 11, spanEndLine = 567, spanEndCol = 13}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "e"}]) (CApp (CVar "Lune.Task.fail") (CVar "e"))]))))))))))))))),CoreDecl "" (CInt 0),CoreDecl "Nova.encodeToolExecError" (CLam [PVar "e"] (CApp (CVar "Lune.Json.Encode.object") (CApp (CApp (CVar "Lune.Prelude.Cons") (CRecord [("key",CString "error"),("value",CApp (CVar "Lune.Json.Encode.string") (CApp (CVar "Nova.toolExecErrorToString") (CVar "e")))])) (CVar "Lune.Prelude.Nil")))),CoreDecl "" (CInt 0),CoreDecl "Nova.toolExecErrorToString" (CLam [PVar "e"] (CCase (CVar "e") [CoreAlt (PCon "Nova.Runtime.ToolNotAllowed" [Located {locSpan = Span {spanStartLine = 578, spanStartCol = 20, spanEndLine = 578, spanEndCol = 23}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "id"}]) (CApp (CApp (CVar "Lune.String.append") (CString "ToolNotAllowed ")) (CApp (CVar "Nova.Tool.toolIdToString") (CVar "id"))),CoreAlt (PCon "Nova.Runtime.ApprovalRequired" [Located {locSpan = Span {spanStartLine = 580, spanStartCol = 22, spanEndLine = 580, spanEndCol = 25}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "id"}]) (CApp (CApp (CVar "Lune.String.append") (CString "ApprovalRequired ")) (CApp (CVar "Nova.Tool.toolIdToString") (CVar "id"))),CoreAlt (PCon "Nova.Runtime.ToolTimedOut" [Located {locSpan = Span {spanStartLine = 582, spanStartCol = 18, spanEndLine = 582, spanEndCol = 21}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "id"}]) (CApp (CApp (CVar "Lune.String.append") (CString "ToolTimedOut ")) (CApp (CVar "Nova.Tool.toolIdToString") (CVar "id"))),CoreAlt (PCon "Nova.Runtime.MaxTurnsExceeded" [Located {locSpan = Span {spanStartLine = 584, spanStartCol = 22, spanEndLine = 584, spanEndCol = 24}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "n"}]) (CApp (CApp (CVar "Lune.String.append") (CString "MaxTurnsExceeded ")) (CApp (CVar "Lune.String.fromInt") (CVar "n"))),CoreAlt (PCon "Nova.Runtime.ToolNotImplemented" [Located {locSpan = Span {spanStartLine = 586, spanStartCol = 24, spanEndLine = 586, spanEndCol = 27}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "id"}]) (CApp (CApp (CVar "Lune.String.append") (CString "ToolNotImplemented ")) (CApp (CVar "Nova.Tool.toolIdToString") (CVar "id"))),CoreAlt (PCon "Nova.Runtime.ToolFailed" [Located {locSpan = Span {spanStartLine = 588, spanStartCol = 16, spanEndLine = 588, spanEndCol = 20}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "msg"}]) (CApp (CApp (CVar "Lune.String.append") (CString "ToolFailed ")) (CVar "msg"))])),CoreDecl "" (CInt 0),CoreDecl "Nova.showToolExecResult" (CLam [PVar "r"] (CCase (CVar "r") [CoreAlt (PCon "Lune.Prelude.Ok" [Located {locSpan = Span {spanStartLine = 594, spanStartCol = 8, spanEndLine = 594, spanEndCol = 10}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "n"}]) (CApp (CApp (CVar "Lune.String.append") (CString "Ok ")) (CApp (CVar "Lune.String.fromInt") (CVar "n"))),CoreAlt (PCon "Lune.Prelude.Err" [Located {locSpan = Span {spanStartLine = 596, spanStartCol = 9, spanEndLine = 596, spanEndCol = 11}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "e"}]) (CApp (CApp (CVar "Lune.String.append") (CString "Err ")) (CApp (CVar "Nova.showToolExecError") (CVar "e")))])),CoreDecl "" (CInt 0),CoreDecl "Nova.showToolExecError" (CVar "Nova.toolExecErrorToString"),CoreDecl "" (CInt 0),CoreDecl "" (CInt 0),CoreDecl "HealthAgent.diskUsageDecoder" (CApp (CApp (CApp (CApp (CVar "Lune.Json.Decode.map3") (CLam [PVar "name",PVar "readBytesPerSec",PVar "writeBytesPerSec"] (CRecord [("name",CVar "name"),("readBytesPerSec",CVar "readBytesPerSec"),("writeBytesPerSec",CVar "writeBytesPerSec")]))) (CApp (CApp (CVar "Lune.Json.Decode.field") (CString "name")) (CVar "Lune.Json.Decode.string"))) (CApp (CApp (CVar "Lune.Json.Decode.field") (CString "readBytesPerSec")) (CVar "Lune.Json.Decode.int"))) (CApp (CApp (CVar "Lune.Json.Decode.field") (CString "writeBytesPerSec")) (CVar "Lune.Json.Decode.int"))),CoreDecl "" (CInt 0),CoreDecl "HealthAgent.diskUsageEncoder" (CLam [PVar "d"] (CApp (CVar "Lune.Json.Encode.object") (CApp (CApp (CVar "Lune.Prelude.Cons") (CRecord [("key",CString "name"),("value",CApp (CVar "Lune.Json.Encode.string") (CSelect (CVar "d") "name"))])) (CApp (CApp (CVar "Lune.Prelude.Cons") (CRecord [("key",CString "readBytesPerSec"),("value",CApp (CVar "Lune.Json.Encode.int") (CSelect (CVar "d") "readBytesPerSec"))])) (CApp (CApp (CVar "Lune.Prelude.Cons") (CRecord [("key",CString "writeBytesPerSec"),("value",CApp (CVar "Lune.Json.Encode.int") (CSelect (CVar "d") "writeBytesPerSec"))])) (CVar "Lune.Prelude.Nil")))))),CoreDecl "" (CInt 0),CoreDecl "" (CInt 0),CoreDecl "HealthAgent.memoryUsageDecoder" (CApp (CApp (CApp (CApp (CApp (CVar "Lune.Json.Decode.map4") (CLam [PVar "totalMb",PVar "availableMb",PVar "usedMb",PVar "swapUsedMb"] (CRecord [("totalMb",CVar "totalMb"),("availableMb",CVar "availableMb"),("usedMb",CVar "usedMb"),("swapUsedMb",CVar "swapUsedMb")]))) (CApp (CApp (CVar "Lune.Json.Decode.field") (CString "totalMb")) (CVar "Lune.Json.Decode.int"))) (CApp (CApp (CVar "Lune.Json.Decode.field") (CString "availableMb")) (CVar "Lune.Json.Decode.int"))) (CApp (CApp (CVar "Lune.Json.Decode.field") (CString "usedMb")) (CVar "Lune.Json.Decode.int"))) (CApp (CApp (CVar "Lune.Json.Decode.field") (CString "swapUsedMb")) (CVar "Lune.Json.Decode.int"))),CoreDecl "" (CInt 0),CoreDecl "HealthAgent.memoryUsageEncoder" (CLam [PVar "m"] (CApp (CVar "Lune.Json.Encode.object") (CApp (CApp (CVar "Lune.Prelude.Cons") (CRecord [("key",CString "totalMb"),("value",CApp (CVar "Lune.Json.Encode.int") (CSelect (CVar "m") "totalMb"))])) (CApp (CApp (CVar "Lune.Prelude.Cons") (CRecord [("key",CString "availableMb"),("value",CApp (CVar "Lune.Json.Encode.int") (CSelect (CVar "m") "availableMb"))])) (CApp (CApp (CVar "Lune.Prelude.Cons") (CRecord [("key",CString "usedMb"),("value",CApp (CVar "Lune.Json.Encode.int") (CSelect (CVar "m") "usedMb"))])) (CApp (CApp (CVar "Lune.Prelude.Cons") (CRecord [("key",CString "swapUsedMb"),("value",CApp (CVar "Lune.Json.Encode.int") (CSelect (CVar "m") "swapUsedMb"))])) (CVar "Lune.Prelude.Nil"))))))),CoreDecl "" (CInt 0),CoreDecl "" (CInt 0),CoreDecl "HealthAgent.cpuUsageDecoder" (CApp (CApp (CApp (CApp (CApp (CApp (CVar "Lune.Json.Decode.map5") (CLam [PVar "usagePercent",PVar "perCorePercent",PVar "loadAvg1",PVar "loadAvg5",PVar "loadAvg15"] (CRecord [("usagePercent",CVar "usagePercent"),("perCorePercent",CVar "perCorePercent"),("loadAvg1",CVar "loadAvg1"),("loadAvg5",CVar "loadAvg5"),("loadAvg15",CVar "loadAvg15")]))) (CApp (CApp (CVar "Lune.Json.Decode.field") (CString "usagePercent")) (CVar "Lune.Json.Decode.int"))) (CApp (CApp (CVar "Lune.Json.Decode.field") (CString "perCorePercent")) (CApp (CVar "Lune.Json.Decode.list") (CVar "Lune.Json.Decode.int")))) (CApp (CApp (CVar "Lune.Json.Decode.field") (CString "loadAvg1")) (CApp (CVar "Lune.Json.Decode.maybe") (CVar "Lune.Json.Decode.float")))) (CApp (CApp (CVar "Lune.Json.Decode.field") (CString "loadAvg5")) (CApp (CVar "Lune.Json.Decode.maybe") (CVar "Lune.Json.Decode.float")))) (CApp (CApp (CVar "Lune.Json.Decode.field") (CString "loadAvg15")) (CApp (CVar "Lune.Json.Decode.maybe") (CVar "Lune.Json.Decode.float")))),CoreDecl "" (CInt 0),CoreDecl "HealthAgent.cpuUsageEncoder" (CLam [PVar "c"] (CApp (CVar "Lune.Json.Encode.object") (CApp (CApp (CVar "Lune.Prelude.Cons") (CRecord [("key",CString "usagePercent"),("value",CApp (CVar "Lune.Json.Encode.int") (CSelect (CVar "c") "usagePercent"))])) (CApp (CApp (CVar "Lune.Prelude.Cons") (CRecord [("key",CString "perCorePercent"),("value",CApp (CApp (CVar "Lune.Json.Encode.list") (CVar "Lune.Json.Encode.int")) (CSelect (CVar "c") "perCorePercent"))])) (CApp (CApp (CVar "Lune.Prelude.Cons") (CRecord [("key",CString "loadAvg1"),("value",CApp (CLam [PVar "v"] (CCase (CVar "v") [CoreAlt (PCon "Lune.Prelude.Nothing" []) (CVar "Lune.Json.Encode.null"),CoreAlt (PCon "Lune.Prelude.Just" [Located {locSpan = Span {spanStartLine = 0, spanStartCol = 0, spanEndLine = 0, spanEndCol = 0}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "x"}]) (CApp (CVar "Lune.Json.Encode.float") (CVar "x"))])) (CSelect (CVar "c") "loadAvg1"))])) (CApp (CApp (CVar "Lune.Prelude.Cons") (CRecord [("key",CString "loadAvg5"),("value",CApp (CLam [PVar "v"] (CCase (CVar "v") [CoreAlt (PCon "Lune.Prelude.Nothing" []) (CVar "Lune.Json.Encode.null"),CoreAlt (PCon "Lune.Prelude.Just" [Located {locSpan = Span {spanStartLine = 0, spanStartCol = 0, spanEndLine = 0, spanEndCol = 0}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "x"}]) (CApp (CVar "Lune.Json.Encode.float") (CVar "x"))])) (CSelect (CVar "c") "loadAvg5"))])) (CApp (CApp (CVar "Lune.Prelude.Cons") (CRecord [("key",CString "loadAvg15"),("value",CApp (CLam [PVar "v"] (CCase (CVar "v") [CoreAlt (PCon "Lune.Prelude.Nothing" []) (CVar "Lune.Json.Encode.null"),CoreAlt (PCon "Lune.Prelude.Just" [Located {locSpan = Span {spanStartLine = 0, spanStartCol = 0, spanEndLine = 0, spanEndCol = 0}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "x"}]) (CApp (CVar "Lune.Json.Encode.float") (CVar "x"))])) (CSelect (CVar "c") "loadAvg15"))])) (CVar "Lune.Prelude.Nil")))))))),CoreDecl "" (CInt 0),CoreDecl "" (CInt 0),CoreDecl "HealthAgent.networkUsageDecoder" (CApp (CApp (CApp (CApp (CVar "Lune.Json.Decode.map3") (CLam [PVar "rxBytesPerSec",PVar "txBytesPerSec",PVar "interfaces"] (CRecord [("rxBytesPerSec",CVar "rxBytesPerSec"),("txBytesPerSec",CVar "txBytesPerSec"),("interfaces",CVar "interfaces")]))) (CApp (CApp (CVar "Lune.Json.Decode.field") (CString "rxBytesPerSec")) (CVar "Lune.Json.Decode.int"))) (CApp (CApp (CVar "Lune.Json.Decode.field") (CString "txBytesPerSec")) (CVar "Lune.Json.Decode.int"))) (CApp (CApp (CVar "Lune.Json.Decode.field") (CString "interfaces")) (CApp (CVar "Lune.Json.Decode.list") (CApp (CApp (CApp (CApp (CVar "Lune.Json.Decode.map3") (CLam [PVar "name",PVar "rxBytesPerSec",PVar "txBytesPerSec"] (CRecord [("name",CVar "name"),("rxBytesPerSec",CVar "rxBytesPerSec"),("txBytesPerSec",CVar "txBytesPerSec")]))) (CApp (CApp (CVar "Lune.Json.Decode.field") (CString "name")) (CVar "Lune.Json.Decode.string"))) (CApp (CApp (CVar "Lune.Json.Decode.field") (CString "rxBytesPerSec")) (CVar "Lune.Json.Decode.int"))) (CApp (CApp (CVar "Lune.Json.Decode.field") (CString "txBytesPerSec")) (CVar "Lune.Json.Decode.int")))))),CoreDecl "" (CInt 0),CoreDecl "HealthAgent.networkUsageEncoder" (CLam [PVar "n"] (CApp (CVar "Lune.Json.Encode.object") (CApp (CApp (CVar "Lune.Prelude.Cons") (CRecord [("key",CString "rxBytesPerSec"),("value",CApp (CVar "Lune.Json.Encode.int") (CSelect (CVar "n") "rxBytesPerSec"))])) (CApp (CApp (CVar "Lune.Prelude.Cons") (CRecord [("key",CString "txBytesPerSec"),("value",CApp (CVar "Lune.Json.Encode.int") (CSelect (CVar "n") "txBytesPerSec"))])) (CApp (CApp (CVar "Lune.Prelude.Cons") (CRecord [("key",CString "interfaces"),("value",CApp (CApp (CVar "Lune.Json.Encode.list") (CLam [PVar "r"] (CApp (CVar "Lune.Json.Encode.object") (CApp (CApp (CVar "Lune.Prelude.Cons") (CRecord [("key",CString "name"),("value",CApp (CVar "Lune.Json.Encode.string") (CSelect (CVar "r") "name"))])) (CApp (CApp (CVar "Lune.Prelude.Cons") (CRecord [("key",CString "rxBytesPerSec"),("value",CApp (CVar "Lune.Json.Encode.int") (CSelect (CVar "r") "rxBytesPerSec"))])) (CApp (CApp (CVar "Lune.Prelude.Cons") (CRecord [("key",CString "txBytesPerSec"),("value",CApp (CVar "Lune.Json.Encode.int") (CSelect (CVar "r") "txBytesPerSec"))])) (CVar "Lune.Prelude.Nil"))))))) (CSelect (CVar "n") "interfaces"))])) (CVar "Lune.Prelude.Nil")))))),CoreDecl "" (CInt 0),CoreDecl "" (CInt 0),CoreDecl "HealthAgent.gpuUsageDecoder" (CApp (CApp (CApp (CApp (CApp (CVar "Lune.Json.Decode.map4") (CLam [PVar "busyPercent",PVar "tempC",PVar "powerW",PVar "vramUsedBytes"] (CRecord [("busyPercent",CVar "busyPercent"),("tempC",CVar "tempC"),("powerW",CVar "powerW"),("vramUsedBytes",CVar "vramUsedBytes")]))) (CApp (CApp (CVar "Lune.Json.Decode.field") (CString "busyPercent")) (CApp (CVar "Lune.Json.Decode.maybe") (CVar "Lune.Json.Decode.int")))) (CApp (CApp (CVar "Lune.Json.Decode.field") (CString "tempC")) (CApp (CVar "Lune.Json.Decode.maybe") (CVar "Lune.Json.Decode.float")))) (CApp (CApp (CVar "Lune.Json.Decode.field") (CString "powerW")) (CApp (CVar "Lune.Json.Decode.maybe") (CVar "Lune.Json.Decode.float")))) (CApp (CApp (CVar "Lune.Json.Decode.field") (CString "vramUsedBytes")) (CApp (CVar "Lune.Json.Decode.maybe") (CVar "Lune.Json.Decode.int")))),CoreDecl "" (CInt 0),CoreDecl "HealthAgent.gpuUsageEncoder" (CLam [PVar "g"] (CApp (CVar "Lune.Json.Encode.object") (CApp (CApp (CVar "Lune.Prelude.Cons") (CRecord [("key",CString "busyPercent"),("value",CApp (CLam [PVar "v"] (CCase (CVar "v") [CoreAlt (PCon "Lune.Prelude.Nothing" []) (CVar "Lune.Json.Encode.null"),CoreAlt (PCon "Lune.Prelude.Just" [Located {locSpan = Span {spanStartLine = 0, spanStartCol = 0, spanEndLine = 0, spanEndCol = 0}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "x"}]) (CApp (CVar "Lune.Json.Encode.int") (CVar "x"))])) (CSelect (CVar "g") "busyPercent"))])) (CApp (CApp (CVar "Lune.Prelude.Cons") (CRecord [("key",CString "tempC"),("value",CApp (CLam [PVar "v"] (CCase (CVar "v") [CoreAlt (PCon "Lune.Prelude.Nothing" []) (CVar "Lune.Json.Encode.null"),CoreAlt (PCon "Lune.Prelude.Just" [Located {locSpan = Span {spanStartLine = 0, spanStartCol = 0, spanEndLine = 0, spanEndCol = 0}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "x"}]) (CApp (CVar "Lune.Json.Encode.float") (CVar "x"))])) (CSelect (CVar "g") "tempC"))])) (CApp (CApp (CVar "Lune.Prelude.Cons") (CRecord [("key",CString "powerW"),("value",CApp (CLam [PVar "v"] (CCase (CVar "v") [CoreAlt (PCon "Lune.Prelude.Nothing" []) (CVar "Lune.Json.Encode.null"),CoreAlt (PCon "Lune.Prelude.Just" [Located {locSpan = Span {spanStartLine = 0, spanStartCol = 0, spanEndLine = 0, spanEndCol = 0}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "x"}]) (CApp (CVar "Lune.Json.Encode.float") (CVar "x"))])) (CSelect (CVar "g") "powerW"))])) (CApp (CApp (CVar "Lune.Prelude.Cons") (CRecord [("key",CString "vramUsedBytes"),("value",CApp (CLam [PVar "v"] (CCase (CVar "v") [CoreAlt (PCon "Lune.Prelude.Nothing" []) (CVar "Lune.Json.Encode.null"),CoreAlt (PCon "Lune.Prelude.Just" [Located {locSpan = Span {spanStartLine = 0, spanStartCol = 0, spanEndLine = 0, spanEndCol = 0}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "x"}]) (CApp (CVar "Lune.Json.Encode.int") (CVar "x"))])) (CSelect (CVar "g") "vramUsedBytes"))])) (CVar "Lune.Prelude.Nil"))))))),CoreDecl "" (CInt 0),CoreDecl "" (CInt 0),CoreDecl "HealthAgent.processUsageDecoder" (CApp (CApp (CApp (CApp (CApp (CVar "Lune.Json.Decode.map4") (CLam [PVar "pid",PVar "name",PVar "cpuTimeDelta",PVar "rssBytes"] (CRecord [("pid",CVar "pid"),("name",CVar "name"),("cpuTimeDelta",CVar "cpuTimeDelta"),("rssBytes",CVar "rssBytes")]))) (CApp (CApp (CVar "Lune.Json.Decode.field") (CString "pid")) (CVar "Lune.Json.Decode.int"))) (CApp (CApp (CVar "Lune.Json.Decode.field") (CString "name")) (CVar "Lune.Json.Decode.string"))) (CApp (CApp (CVar "Lune.Json.Decode.field") (CString "cpuTimeDelta")) (CVar "Lune.Json.Decode.int"))) (CApp (CApp (CVar "Lune.Json.Decode.field") (CString "rssBytes")) (CApp (CVar "Lune.Json.Decode.maybe") (CVar "Lune.Json.Decode.int")))),CoreDecl "" (CInt 0),CoreDecl "HealthAgent.processUsageEncoder" (CLam [PVar "p"] (CApp (CVar "Lune.Json.Encode.object") (CApp (CApp (CVar "Lune.Prelude.Cons") (CRecord [("key",CString "pid"),("value",CApp (CVar "Lune.Json.Encode.int") (CSelect (CVar "p") "pid"))])) (CApp (CApp (CVar "Lune.Prelude.Cons") (CRecord [("key",CString "name"),("value",CApp (CVar "Lune.Json.Encode.string") (CSelect (CVar "p") "name"))])) (CApp (CApp (CVar "Lune.Prelude.Cons") (CRecord [("key",CString "cpuTimeDelta"),("value",CApp (CVar "Lune.Json.Encode.int") (CSelect (CVar "p") "cpuTimeDelta"))])) (CApp (CApp (CVar "Lune.Prelude.Cons") (CRecord [("key",CString "rssBytes"),("value",CApp (CLam [PVar "v"] (CCase (CVar "v") [CoreAlt (PCon "Lune.Prelude.Nothing" []) (CVar "Lune.Json.Encode.null"),CoreAlt (PCon "Lune.Prelude.Just" [Located {locSpan = Span {spanStartLine = 0, spanStartCol = 0, spanEndLine = 0, spanEndCol = 0}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "x"}]) (CApp (CVar "Lune.Json.Encode.int") (CVar "x"))])) (CSelect (CVar "p") "rssBytes"))])) (CVar "Lune.Prelude.Nil"))))))),CoreDecl "" (CInt 0),CoreDecl "" (CInt 0),CoreDecl "HealthAgent.healthReportDecoder" (CApp (CApp (CVar "Lune.Json.Decode.andThen") (CLam [PVar "cpu"] (CApp (CApp (CVar "Lune.Json.Decode.andThen") (CLam [PVar "memory"] (CApp (CApp (CVar "Lune.Json.Decode.andThen") (CLam [PVar "disks"] (CApp (CApp (CVar "Lune.Json.Decode.andThen") (CLam [PVar "network"] (CApp (CApp (CVar "Lune.Json.Decode.andThen") (CLam [PVar "gpus"] (CApp (CApp (CVar "Lune.Json.Decode.andThen") (CLam [PVar "topProcesses"] (CApp (CApp (CVar "Lune.Json.Decode.andThen") (CLam [PVar "dtMs"] (CApp (CVar "Lune.Json.Decode.succeed") (CRecord [("cpu",CVar "cpu"),("memory",CVar "memory"),("disks",CVar "disks"),("network",CVar "network"),("gpus",CVar "gpus"),("topProcesses",CVar "topProcesses"),("dtMs",CVar "dtMs")])))) (CApp (CApp (CVar "Lune.Json.Decode.field") (CString "dtMs")) (CVar "Lune.Json.Decode.int"))))) (CApp (CApp (CVar "Lune.Json.Decode.field") (CString "topProcesses")) (CApp (CVar "Lune.Json.Decode.list") (CVar "HealthAgent.processUsageDecoder")))))) (CApp (CApp (CVar "Lune.Json.Decode.field") (CString "gpus")) (CApp (CVar "Lune.Json.Decode.list") (CVar "HealthAgent.gpuUsageDecoder")))))) (CApp (CApp (CVar "Lune.Json.Decode.field") (CString "network")) (CVar "HealthAgent.networkUsageDecoder"))))) (CApp (CApp (CVar "Lune.Json.Decode.field") (CString "disks")) (CApp (CVar "Lune.Json.Decode.list") (CVar "HealthAgent.diskUsageDecoder")))))) (CApp (CApp (CVar "Lune.Json.Decode.field") (CString "memory")) (CVar "HealthAgent.memoryUsageDecoder"))))) (CApp (CApp (CVar "Lune.Json.Decode.field") (CString "cpu")) (CVar "HealthAgent.cpuUsageDecoder"))),CoreDecl "" (CInt 0),CoreDecl "HealthAgent.healthReportEncoder" (CLam [PVar "h"] (CApp (CVar "Lune.Json.Encode.object") (CApp (CApp (CVar "Lune.Prelude.Cons") (CRecord [("key",CString "cpu"),("value",CApp (CVar "HealthAgent.cpuUsageEncoder") (CSelect (CVar "h") "cpu"))])) (CApp (CApp (CVar "Lune.Prelude.Cons") (CRecord [("key",CString "memory"),("value",CApp (CVar "HealthAgent.memoryUsageEncoder") (CSelect (CVar "h") "memory"))])) (CApp (CApp (CVar "Lune.Prelude.Cons") (CRecord [("key",CString "disks"),("value",CApp (CApp (CVar "Lune.Json.Encode.list") (CVar "HealthAgent.diskUsageEncoder")) (CSelect (CVar "h") "disks"))])) (CApp (CApp (CVar "Lune.Prelude.Cons") (CRecord [("key",CString "network"),("value",CApp (CVar "HealthAgent.networkUsageEncoder") (CSelect (CVar "h") "network"))])) (CApp (CApp (CVar "Lune.Prelude.Cons") (CRecord [("key",CString "gpus"),("value",CApp (CApp (CVar "Lune.Json.Encode.list") (CVar "HealthAgent.gpuUsageEncoder")) (CSelect (CVar "h") "gpus"))])) (CApp (CApp (CVar "Lune.Prelude.Cons") (CRecord [("key",CString "topProcesses"),("value",CApp (CApp (CVar "Lune.Json.Encode.list") (CVar "HealthAgent.processUsageEncoder")) (CSelect (CVar "h") "topProcesses"))])) (CApp (CApp (CVar "Lune.Prelude.Cons") (CRecord [("key",CString "dtMs"),("value",CApp (CVar "Lune.Json.Encode.int") (CSelect (CVar "h") "dtMs"))])) (CVar "Lune.Prelude.Nil")))))))))),CoreDecl "" (CInt 0),CoreDecl "" (CInt 0),CoreDecl "HealthAgent.severityDecoder" (CApp (CApp (CVar "Lune.Json.Decode.andThen") (CLam [PVar "tag"] (CCase (CVar "tag") [CoreAlt (PString "Critical") (CApp (CVar "Lune.Json.Decode.succeed") (CVar "HealthAgent.Critical")),CoreAlt (PString "Warning") (CApp (CVar "Lune.Json.Decode.succeed") (CVar "HealthAgent.Warning")),CoreAlt (PString "Info") (CApp (CVar "Lune.Json.Decode.succeed") (CVar "HealthAgent.Info")),CoreAlt (PVar "other") (CApp (CVar "Lune.Json.Decode.fail") (CApp (CApp (CVar "prim_appendString") (CString "Unknown tag: ")) (CVar "other")))]))) (CApp (CApp (CVar "Lune.Json.Decode.field") (CString "tag")) (CVar "Lune.Json.Decode.string"))),CoreDecl "" (CInt 0),CoreDecl "HealthAgent.severityEncoder" (CLam [PVar "s"] (CCase (CVar "s") [CoreAlt (PCon "HealthAgent.Critical" []) (CApp (CVar "Lune.Json.Encode.object") (CApp (CApp (CVar "Lune.Prelude.Cons") (CRecord [("key",CString "tag"),("value",CApp (CVar "Lune.Json.Encode.string") (CString "Critical"))])) (CApp (CApp (CVar "Lune.Prelude.Cons") (CRecord [("key",CString "fields"),("value",CApp (CApp (CVar "Lune.Json.Encode.list") (CLam [PVar "x"] (CVar "x"))) (CVar "Lune.Prelude.Nil"))])) (CVar "Lune.Prelude.Nil")))),CoreAlt (PCon "HealthAgent.Warning" []) (CApp (CVar "Lune.Json.Encode.object") (CApp (CApp (CVar "Lune.Prelude.Cons") (CRecord [("key",CString "tag"),("value",CApp (CVar "Lune.Json.Encode.string") (CString "Warning"))])) (CApp (CApp (CVar "Lune.Prelude.Cons") (CRecord [("key",CString "fields"),("value",CApp (CApp (CVar "Lune.Json.Encode.list") (CLam [PVar "x"] (CVar "x"))) (CVar "Lune.Prelude.Nil"))])) (CVar "Lune.Prelude.Nil")))),CoreAlt (PCon "HealthAgent.Info" []) (CApp (CVar "Lune.Json.Encode.object") (CApp (CApp (CVar "Lune.Prelude.Cons") (CRecord [("key",CString "tag"),("value",CApp (CVar "Lune.Json.Encode.string") (CString "Info"))])) (CApp (CApp (CVar "Lune.Prelude.Cons") (CRecord [("key",CString "fields"),("value",CApp (CApp (CVar "Lune.Json.Encode.list") (CLam [PVar "x"] (CVar "x"))) (CVar "Lune.Prelude.Nil"))])) (CVar "Lune.Prelude.Nil"))))])),CoreDecl "" (CInt 0),CoreDecl "" (CInt 0),CoreDecl "HealthAgent.issueDecoder" (CApp (CApp (CApp (CApp (CVar "Lune.Json.Decode.map3") (CLam [PVar "severity",PVar "summary",PVar "details"] (CRecord [("severity",CVar "severity"),("summary",CVar "summary"),("details",CVar "details")]))) (CApp (CApp (CVar "Lune.Json.Decode.field") (CString "severity")) (CVar "HealthAgent.severityDecoder"))) (CApp (CApp (CVar "Lune.Json.Decode.field") (CString "summary")) (CVar "Lune.Json.Decode.string"))) (CApp (CApp (CVar "Lune.Json.Decode.field") (CString "details")) (CVar "Lune.Json.Decode.string"))),CoreDecl "" (CInt 0),CoreDecl "HealthAgent.issueEncoder" (CLam [PVar "i"] (CApp (CVar "Lune.Json.Encode.object") (CApp (CApp (CVar "Lune.Prelude.Cons") (CRecord [("key",CString "severity"),("value",CApp (CVar "HealthAgent.severityEncoder") (CSelect (CVar "i") "severity"))])) (CApp (CApp (CVar "Lune.Prelude.Cons") (CRecord [("key",CString "summary"),("value",CApp (CVar "Lune.Json.Encode.string") (CSelect (CVar "i") "summary"))])) (CApp (CApp (CVar "Lune.Prelude.Cons") (CRecord [("key",CString "details"),("value",CApp (CVar "Lune.Json.Encode.string") (CSelect (CVar "i") "details"))])) (CVar "Lune.Prelude.Nil")))))),CoreDecl "" (CInt 0),CoreDecl "" (CInt 0),CoreDecl "HealthAgent.proposedActionDecoder" (CApp (CApp (CVar "Lune.Json.Decode.andThen") (CLam [PVar "id"] (CApp (CApp (CVar "Lune.Json.Decode.andThen") (CLam [PVar "issue"] (CApp (CApp (CVar "Lune.Json.Decode.andThen") (CLam [PVar "action"] (CApp (CApp (CVar "Lune.Json.Decode.andThen") (CLam [PVar "command"] (CApp (CApp (CVar "Lune.Json.Decode.andThen") (CLam [PVar "risk"] (CApp (CApp (CVar "Lune.Json.Decode.andThen") (CLam [PVar "expectedOutcome"] (CApp (CVar "Lune.Json.Decode.succeed") (CRecord [("id",CVar "id"),("issue",CVar "issue"),("action",CVar "action"),("command",CVar "command"),("risk",CVar "risk"),("expectedOutcome",CVar "expectedOutcome")])))) (CApp (CApp (CVar "Lune.Json.Decode.field") (CString "expectedOutcome")) (CVar "Lune.Json.Decode.string"))))) (CApp (CApp (CVar "Lune.Json.Decode.field") (CString "risk")) (CVar "Lune.Json.Decode.string"))))) (CApp (CApp (CVar "Lune.Json.Decode.field") (CString "command")) (CVar "Lune.Json.Decode.string"))))) (CApp (CApp (CVar "Lune.Json.Decode.field") (CString "action")) (CVar "Lune.Json.Decode.string"))))) (CApp (CApp (CVar "Lune.Json.Decode.field") (CString "issue")) (CVar "Lune.Json.Decode.string"))))) (CApp (CApp (CVar "Lune.Json.Decode.field") (CString "id")) (CVar "Lune.Json.Decode.int"))),CoreDecl "" (CInt 0),CoreDecl "HealthAgent.proposedActionEncoder" (CLam [PVar "p"] (CApp (CVar "Lune.Json.Encode.object") (CApp (CApp (CVar "Lune.Prelude.Cons") (CRecord [("key",CString "id"),("value",CApp (CVar "Lune.Json.Encode.int") (CSelect (CVar "p") "id"))])) (CApp (CApp (CVar "Lune.Prelude.Cons") (CRecord [("key",CString "issue"),("value",CApp (CVar "Lune.Json.Encode.string") (CSelect (CVar "p") "issue"))])) (CApp (CApp (CVar "Lune.Prelude.Cons") (CRecord [("key",CString "action"),("value",CApp (CVar "Lune.Json.Encode.string") (CSelect (CVar "p") "action"))])) (CApp (CApp (CVar "Lune.Prelude.Cons") (CRecord [("key",CString "command"),("value",CApp (CVar "Lune.Json.Encode.string") (CSelect (CVar "p") "command"))])) (CApp (CApp (CVar "Lune.Prelude.Cons") (CRecord [("key",CString "risk"),("value",CApp (CVar "Lune.Json.Encode.string") (CSelect (CVar "p") "risk"))])) (CApp (CApp (CVar "Lune.Prelude.Cons") (CRecord [("key",CString "expectedOutcome"),("value",CApp (CVar "Lune.Json.Encode.string") (CSelect (CVar "p") "expectedOutcome"))])) (CVar "Lune.Prelude.Nil"))))))))),CoreDecl "" (CInt 0),CoreDecl "" (CInt 0),CoreDecl "HealthAgent.healthAnalysisDecoder" (CApp (CApp (CApp (CVar "Lune.Json.Decode.map2") (CLam [PVar "issues",PVar "actions"] (CRecord [("issues",CVar "issues"),("actions",CVar "actions")]))) (CApp (CApp (CVar "Lune.Json.Decode.field") (CString "issues")) (CApp (CVar "Lune.Json.Decode.list") (CVar "HealthAgent.issueDecoder")))) (CApp (CApp (CVar "Lune.Json.Decode.field") (CString "actions")) (CApp (CVar "Lune.Json.Decode.list") (CVar "HealthAgent.proposedActionDecoder")))),CoreDecl "" (CInt 0),CoreDecl "HealthAgent.healthAnalysisEncoder" (CLam [PVar "h"] (CApp (CVar "Lune.Json.Encode.object") (CApp (CApp (CVar "Lune.Prelude.Cons") (CRecord [("key",CString "issues"),("value",CApp (CApp (CVar "Lune.Json.Encode.list") (CVar "HealthAgent.issueEncoder")) (CSelect (CVar "h") "issues"))])) (CApp (CApp (CVar "Lune.Prelude.Cons") (CRecord [("key",CString "actions"),("value",CApp (CApp (CVar "Lune.Json.Encode.list") (CVar "HealthAgent.proposedActionEncoder")) (CSelect (CVar "h") "actions"))])) (CVar "Lune.Prelude.Nil"))))),CoreDecl "" (CInt 0),CoreDecl "" (CInt 0),CoreDecl "HealthAgent.collectHealthReport" (CApp (CApp (CSelect (CVar "$dictMonad_Task") "andThen") (CApp (CVar "Lune.Task.result") (CVar "Lune.System.sample"))) (CLam [PVar "r1"] (CCase (CVar "r1") [CoreAlt (PCon "Lune.Prelude.Err" [Located {locSpan = Span {spanStartLine = 143, spanStartCol = 11, spanEndLine = 143, spanEndCol = 13}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "e"}]) (CApp (CVar "Lune.Task.fail") (CApp (CVar "HealthAgent.SystemErrorMsg") (CApp (CVar "Lune.System.errorToString") (CVar "e")))),CoreAlt (PCon "Lune.Prelude.Ok" [Located {locSpan = Span {spanStartLine = 145, spanStartCol = 10, spanEndLine = 145, spanEndCol = 13}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "s1"}]) (CApp (CApp (CSelect (CVar "$dictMonad_Task") "andThen") (CApp (CVar "Lune.IO.sleepMs") (CInt 500))) (CLam [PWildcard] (CApp (CApp (CSelect (CVar "$dictMonad_Task") "andThen") (CApp (CVar "Lune.Task.result") (CVar "Lune.System.sample"))) (CLam [PVar "r2"] (CCase (CVar "r2") [CoreAlt (PCon "Lune.Prelude.Err" [Located {locSpan = Span {spanStartLine = 150, spanStartCol = 17, spanEndLine = 150, spanEndCol = 19}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "e"}]) (CApp (CVar "Lune.Task.fail") (CApp (CVar "HealthAgent.SystemErrorMsg") (CApp (CVar "Lune.System.errorToString") (CVar "e")))),CoreAlt (PCon "Lune.Prelude.Ok" [Located {locSpan = Span {spanStartLine = 152, spanStartCol = 16, spanEndLine = 152, spanEndCol = 19}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "s2"}]) (CLet "d" (CApp (CApp (CVar "Lune.System.diff") (CVar "s1")) (CVar "s2")) (CApp (CVar "Lune.Task.succeed") (CApp (CApp (CVar "HealthAgent.diffToReport") (CVar "s2")) (CVar "d"))))])))))]))),CoreDecl "" (CInt 0),CoreDecl "HealthAgent.diffToReport" (CLam [PVar "s",PVar "d"] (CRecord [("cpu",CApp (CVar "HealthAgent.cpuFromDiff") (CSelect (CVar "d") "cpu")),("memory",CApp (CVar "HealthAgent.memFromSample") (CSelect (CVar "s") "mem")),("disks",CApp (CVar "HealthAgent.disksFromDiff") (CSelect (CVar "d") "disk")),("network",CApp (CVar "HealthAgent.netFromDiff") (CSelect (CVar "d") "net")),("gpus",CApp (CVar "HealthAgent.gpusFromDiff") (CSelect (CVar "d") "gpu")),("topProcesses",CApp (CVar "HealthAgent.procsFromDiff") (CSelect (CVar "d") "procs")),("dtMs",CSelect (CVar "d") "dtMs")])),CoreDecl "" (CInt 0),CoreDecl "HealthAgent.cpuFromDiff" (CLam [PVar "c"] (CRecord [("usagePercent",CSelect (CVar "c") "usagePercent"),("perCorePercent",CSelect (CVar "c") "perCoreUsagePercent"),("loadAvg1",CSelect (CVar "c") "loadAvg1"),("loadAvg5",CSelect (CVar "c") "loadAvg5"),("loadAvg15",CSelect (CVar "c") "loadAvg15")])),CoreDecl "" (CInt 0),CoreDecl "HealthAgent.memFromSample" (CLam [PVar "m"] (CLet "totalMb" (CApp (CApp (CVar "Lune.Int.div") (CSelect (CVar "m") "totalBytes")) (CApp (CApp (CVar "Lune.Int.mul") (CInt 1024)) (CInt 1024))) (CLet "availableMb" (CCase (CSelect (CVar "m") "availableBytes") [CoreAlt (PCon "Lune.Prelude.Just" [Located {locSpan = Span {spanStartLine = 184, spanStartCol = 14, spanEndLine = 184, spanEndCol = 16}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "a"}]) (CApp (CApp (CVar "Lune.Int.div") (CVar "a")) (CApp (CApp (CVar "Lune.Int.mul") (CInt 1024)) (CInt 1024))),CoreAlt (PCon "Lune.Prelude.Nothing" []) (CCase (CSelect (CVar "m") "freeBytes") [CoreAlt (PCon "Lune.Prelude.Just" [Located {locSpan = Span {spanStartLine = 188, spanStartCol = 18, spanEndLine = 188, spanEndCol = 20}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "f"}]) (CApp (CApp (CVar "Lune.Int.div") (CVar "f")) (CApp (CApp (CVar "Lune.Int.mul") (CInt 1024)) (CInt 1024))),CoreAlt (PCon "Lune.Prelude.Nothing" []) (CInt 0)])]) (CLet "usedMb" (CApp (CApp (CVar "Lune.Int.max") (CInt 0)) (CApp (CApp (CVar "Lune.Int.sub") (CVar "totalMb")) (CVar "availableMb"))) (CLet "swapUsedMb" (CCase (CApp (CApp (CVar "Lune.Prelude.Pair") (CSelect (CVar "m") "swapTotalBytes")) (CSelect (CVar "m") "swapFreeBytes")) [CoreAlt (PCon "Lune.Prelude.Pair" [Located {locSpan = Span {spanStartLine = 195, spanStartCol = 10, spanEndLine = 195, spanEndCol = 20}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PCon "Lune.Prelude.Just" [Located {locSpan = Span {spanStartLine = 195, spanStartCol = 15, spanEndLine = 195, spanEndCol = 20}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "total"}]},Located {locSpan = Span {spanStartLine = 195, spanStartCol = 22, spanEndLine = 195, spanEndCol = 31}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PCon "Lune.Prelude.Just" [Located {locSpan = Span {spanStartLine = 195, spanStartCol = 27, spanEndLine = 195, spanEndCol = 31}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "free"}]}]) (CApp (CApp (CVar "Lune.Int.div") (CApp (CApp (CVar "Lune.Int.max") (CInt 0)) (CApp (CApp (CVar "Lune.Int.sub") (CVar "total")) (CVar "free")))) (CApp (CApp (CVar "Lune.Int.mul") (CInt 1024)) (CInt 1024))),CoreAlt PWildcard (CInt 0)]) (CRecord [("totalMb",CVar "totalMb"),("availableMb",CVar "availableMb"),("usedMb",CVar "usedMb"),("swapUsedMb",CVar "swapUsedMb")])))))),CoreDecl "" (CInt 0),CoreDecl "HealthAgent.disksFromDiff" (CLam [PVar "d"] (CApp (CApp (CVar "Lune.List.map") (CLam [PVar "dev"] (CRecord [("name",CSelect (CVar "dev") "name"),("readBytesPerSec",CSelect (CVar "dev") "readBytesPerSec"),("writeBytesPerSec",CSelect (CVar "dev") "writeBytesPerSec")]))) (CSelect (CVar "d") "devices"))),CoreDecl "" (CInt 0),CoreDecl "HealthAgent.netFromDiff" (CLam [PVar "n"] (CRecord [("rxBytesPerSec",CSelect (CVar "n") "rxBytesPerSec"),("txBytesPerSec",CSelect (CVar "n") "txBytesPerSec"),("interfaces",CApp (CApp (CVar "Lune.List.map") (CLam [PVar "i"] (CRecord [("name",CSelect (CVar "i") "name"),("rxBytesPerSec",CSelect (CVar "i") "rxBytesPerSec"),("txBytesPerSec",CSelect (CVar "i") "txBytesPerSec")]))) (CSelect (CVar "n") "interfaces"))])),CoreDecl "" (CInt 0),CoreDecl "HealthAgent.gpusFromDiff" (CLam [PVar "g"] (CApp (CApp (CVar "Lune.List.map") (CLam [PVar "dev"] (CRecord [("busyPercent",CSelect (CVar "dev") "busyPercent"),("tempC",CSelect (CVar "dev") "tempC"),("powerW",CSelect (CVar "dev") "powerW"),("vramUsedBytes",CSelect (CVar "dev") "vramUsedBytes")]))) (CSelect (CVar "g") "devices"))),CoreDecl "" (CInt 0),CoreDecl "HealthAgent.procsFromDiff" (CLam [PVar "p"] (CApp (CApp (CVar "Lune.List.map") (CLam [PVar "proc"] (CRecord [("pid",CSelect (CVar "proc") "pid"),("name",CSelect (CVar "proc") "comm"),("cpuTimeDelta",CSelect (CVar "proc") "cpuTimeDelta"),("rssBytes",CSelect (CVar "proc") "rssBytes")]))) (CSelect (CVar "p") "top"))),CoreDecl "" (CInt 0),CoreDecl "HealthAgent.showSeverity" (CLam [PVar "sev"] (CCase (CVar "sev") [CoreAlt (PCon "HealthAgent.Critical" []) (CString "CRITICAL"),CoreAlt (PCon "HealthAgent.Warning" []) (CString "WARNING"),CoreAlt (PCon "HealthAgent.Info" []) (CString "INFO")])),CoreDecl "" (CInt 0),CoreDecl "HealthAgent.showIssue" (CLam [PVar "iss"] (CApp (CVar "Template.render") (CTemplate False [CTemplateText "  * [",CTemplateHole (TCon "String") (CApp (CSelect (CVar "$dictToTemplate_String") "toTemplate") (CApp (CVar "HealthAgent.showSeverity") (CSelect (CVar "iss") "severity"))),CTemplateText "] ",CTemplateHole (TCon "String") (CApp (CSelect (CVar "$dictToTemplate_String") "toTemplate") (CSelect (CVar "iss") "summary"))]))),CoreDecl "" (CInt 0),CoreDecl "HealthAgent.showIssuesHeader" (CString "Issues found:"),CoreDecl "" (CInt 0),CoreDecl "HealthAgent.showIssues" (CLam [PVar "issues"] (CCase (CVar "issues") [CoreAlt (PCon "Lune.Prelude.Nil" []) (CString "No issues found."),CoreAlt PWildcard (CApp (CApp (CVar "Lune.String.join") (CString "\n")) (CApp (CApp (CVar "Lune.Prelude.Cons") (CVar "HealthAgent.showIssuesHeader")) (CApp (CApp (CVar "Lune.List.map") (CVar "HealthAgent.showIssue")) (CVar "issues"))))])),CoreDecl "" (CInt 0),CoreDecl "HealthAgent.showAction" (CLam [PVar "current",PVar "total",PVar "act"] (CApp (CVar "Template.render") (CTemplate True [CTemplateText "+-------------------------------------------------+\n| Action ",CTemplateHole (TCon "String") (CApp (CSelect (CVar "$dictToTemplate_String") "toTemplate") (CApp (CVar "Lune.String.fromInt") (CVar "current"))),CTemplateText " of ",CTemplateHole (TCon "String") (CApp (CSelect (CVar "$dictToTemplate_String") "toTemplate") (CApp (CVar "Lune.String.fromInt") (CVar "total"))),CTemplateText " [",CTemplateHole (TCon "String") (CApp (CSelect (CVar "$dictToTemplate_String") "toTemplate") (CSelect (CVar "act") "risk")),CTemplateText " risk]\n|\n| Issue: ",CTemplateHole (TCon "String") (CApp (CSelect (CVar "$dictToTemplate_String") "toTemplate") (CSelect (CVar "act") "issue")),CTemplateText "\n|\n| Proposed: ",CTemplateHole (TCon "String") (CApp (CSelect (CVar "$dictToTemplate_String") "toTemplate") (CSelect (CVar "act") "action")),CTemplateText "\n| Command:  ",CTemplateHole (TCon "String") (CApp (CSelect (CVar "$dictToTemplate_String") "toTemplate") (CSelect (CVar "act") "command")),CTemplateText "\n| Expected: ",CTemplateHole (TCon "String") (CApp (CSelect (CVar "$dictToTemplate_String") "toTemplate") (CSelect (CVar "act") "expectedOutcome")),CTemplateText "\n+-------------------------------------------------+"]))),CoreDecl "" (CInt 0),CoreDecl "HealthAgent.analysisSystemPrompt" (CApp (CVar "Template.render") (CTemplate True [CTemplateText "You are a Linux sysadmin assistant. Analyze these system\nhealth metrics and identify issues that need attention.\n\nSeverity guidelines:\n- Critical: System at risk of failure (disk >90%, OOM imminent)\n- Warning: Degraded performance or trending toward critical\n- Info: Notable but not actionable\n\nFor each issue, propose a concrete remediation action with\nthe exact command to run. Assess risk level:\n- low: Safe, no service impact (clear caches, rotate logs)\n- medium: Brief impact (restart service, kill process)\n- high: Potential data loss or extended downtime\n\nReturn actions in priority order (most urgent first)."])),CoreDecl "" (CInt 0),CoreDecl "HealthAgent.buildAnalysisPrompt" (CLam [PVar "report"] (CApp (CVar "Template.render") (CTemplate True [CTemplateHole (TCon "String") (CApp (CSelect (CVar "$dictToTemplate_String") "toTemplate") (CVar "HealthAgent.analysisSystemPrompt")),CTemplateText "\n\nHealth Report:\n",CTemplateHole (TCon "String") (CApp (CSelect (CVar "$dictToTemplate_String") "toTemplate") (CApp (CVar "Lune.Json.stringify") (CApp (CVar "HealthAgent.healthReportEncoder") (CVar "report"))))]))),CoreDecl "" (CInt 0),CoreDecl "HealthAgent.makeClient" (CApp (CApp (CVar "Nova.withModel") (CString "qwen3")) (CVar "Nova.defaultClient")),CoreDecl "" (CInt 0),CoreDecl "HealthAgent.analyzeHealth" (CLam [PVar "report"] (CLet "prompt" (CApp (CVar "HealthAgent.buildAnalysisPrompt") (CVar "report")) (CApp (CApp (CSelect (CVar "$dictMonad_Task") "andThen") (CApp (CVar "Lune.Task.result") (CApp (CApp (CApp (CVar "Nova.tool") (CVar "$dictJson.Decode_Json")) (CVar "HealthAgent.makeClient")) (CVar "prompt")))) (CLam [PVar "toolResult"] (CCase (CVar "toolResult") [CoreAlt (PCon "Lune.Prelude.Err" [Located {locSpan = Span {spanStartLine = 341, spanStartCol = 11, spanEndLine = 341, spanEndCol = 13}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "e"}]) (CApp (CVar "Lune.Task.fail") (CApp (CVar "HealthAgent.LlmErrorMsg") (CApp (CVar "Nova.showError") (CVar "e")))),CoreAlt (PCon "Lune.Prelude.Ok" [Located {locSpan = Span {spanStartLine = 343, spanStartCol = 10, spanEndLine = 343, spanEndCol = 23}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "analysisJson"}]) (CCase (CApp (CApp (CVar "Lune.Json.Decode.decodeValue") (CVar "HealthAgent.healthAnalysisDecoder")) (CVar "analysisJson")) [CoreAlt (PCon "Lune.Prelude.Err" [Located {locSpan = Span {spanStartLine = 345, spanStartCol = 15, spanEndLine = 345, spanEndCol = 17}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "d"}]) (CApp (CVar "Lune.Task.fail") (CApp (CVar "HealthAgent.AgentDecodeError") (CSelect (CVar "d") "message"))),CoreAlt (PCon "Lune.Prelude.Ok" [Located {locSpan = Span {spanStartLine = 347, spanStartCol = 14, spanEndLine = 347, spanEndCol = 23}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "analysis"}]) (CApp (CVar "Lune.Task.succeed") (CVar "analysis"))])]))))),CoreDecl "" (CInt 0),CoreDecl "HealthAgent.displayAnalysis" (CLam [PVar "analysis"] (CApp (CApp (CSelect (CVar "$dictMonad_Task") "andThen") (CApp (CVar "Lune.IO.println") (CString ""))) (CLam [PWildcard] (CApp (CApp (CSelect (CVar "$dictMonad_Task") "andThen") (CApp (CVar "Lune.IO.println") (CApp (CVar "HealthAgent.showIssues") (CSelect (CVar "analysis") "issues")))) (CLam [PWildcard] (CApp (CApp (CSelect (CVar "$dictMonad_Task") "andThen") (CApp (CVar "Lune.IO.println") (CString ""))) (CLam [PWildcard] (CCase (CSelect (CVar "analysis") "actions") [CoreAlt (PCon "Lune.Prelude.Nil" []) (CApp (CVar "Lune.IO.println") (CString "No remediation actions proposed.")),CoreAlt PWildcard (CLet "count" (CApp (CVar "Lune.List.length") (CSelect (CVar "analysis") "actions")) (CApp (CApp (CSelect (CVar "$dictMonad_Task") "andThen") (CApp (CVar "Lune.IO.println") (CApp (CVar "Template.render") (CTemplate False [CTemplateText "Proposed ",CTemplateHole (TCon "String") (CApp (CSelect (CVar "$dictToTemplate_String") "toTemplate") (CApp (CVar "Lune.String.fromInt") (CVar "count"))),CTemplateText " remediation actions:"])))) (CLam [PWildcard] (CApp (CApp (CSelect (CVar "$dictMonad_Task") "andThen") (CApp (CVar "Lune.IO.println") (CString ""))) (CLam [PWildcard] (CApp (CApp (CVar "HealthAgent.processActions") (CVar "count")) (CSelect (CVar "analysis") "actions")))))))])))))))),CoreDecl "" (CInt 0),CoreDecl "HealthAgent.showAgentError" (CLam [PVar "err"] (CCase (CVar "err") [CoreAlt (PCon "HealthAgent.LlmErrorMsg" [Located {locSpan = Span {spanStartLine = 370, spanStartCol = 17, spanEndLine = 370, spanEndCol = 21}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "msg"}]) (CApp (CVar "Template.render") (CTemplate False [CTemplateText "LLM analysis failed: ",CTemplateHole (TCon "String") (CApp (CSelect (CVar "$dictToTemplate_String") "toTemplate") (CVar "msg"))])),CoreAlt (PCon "HealthAgent.AgentDecodeError" [Located {locSpan = Span {spanStartLine = 372, spanStartCol = 22, spanEndLine = 372, spanEndCol = 26}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "msg"}]) (CApp (CVar "Template.render") (CTemplate False [CTemplateText "Failed to decode response: ",CTemplateHole (TCon "String") (CApp (CSelect (CVar "$dictToTemplate_String") "toTemplate") (CVar "msg"))])),CoreAlt (PCon "HealthAgent.SystemErrorMsg" [Located {locSpan = Span {spanStartLine = 374, spanStartCol = 20, spanEndLine = 374, spanEndCol = 24}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "msg"}]) (CApp (CVar "Template.render") (CTemplate False [CTemplateText "System check failed: ",CTemplateHole (TCon "String") (CApp (CSelect (CVar "$dictToTemplate_String") "toTemplate") (CVar "msg"))]))])),CoreDecl "" (CInt 0),CoreDecl "" (CInt 0),CoreDecl "HealthAgent.promptForApproval" (CApp (CApp (CSelect (CVar "$dictMonad_Task") "andThen") (CApp (CVar "Lune.IO.println") (CString "Approve this action (record command to approved-commands.sh)? [y/n/q] "))) (CLam [PWildcard] (CApp (CApp (CSelect (CVar "$dictMonad_Task") "andThen") (CVar "Lune.IO.readLine")) (CLam [PVar "input"] (CCase (CVar "input") [CoreAlt (PString "y") (CApp (CVar "Lune.Task.succeed") (CVar "HealthAgent.Approved")),CoreAlt (PString "n") (CApp (CVar "Lune.Task.succeed") (CVar "HealthAgent.Skipped")),CoreAlt (PString "q") (CApp (CVar "Lune.Task.succeed") (CVar "HealthAgent.Quit")),CoreAlt PWildcard (CApp (CApp (CSelect (CVar "$dictMonad_Task") "andThen") (CApp (CVar "Lune.IO.println") (CString "Please enter y, n, or q"))) (CLam [PWildcard] (CVar "HealthAgent.promptForApproval")))]))))),CoreDecl "" (CInt 0),CoreDecl "HealthAgent.approvedCommandsPath" (CString "approved-commands.sh"),CoreDecl "" (CInt 0),CoreDecl "HealthAgent.recordApprovedCommand" (CLam [PVar "cmd"] (CApp (CApp (CSelect (CVar "$dictMonad_Task") "andThen") (CApp (CApp (CVar "Lune.Task.onError") (CApp (CVar "Lune.IO.readFile") (CVar "HealthAgent.approvedCommandsPath"))) (CLam [PWildcard] (CApp (CVar "Lune.Task.succeed") (CString ""))))) (CLam [PVar "existing"] (CLet "line" (CApp (CApp (CVar "Lune.String.append") (CVar "cmd")) (CString "\n")) (CLet "updated" (CCase (CApp (CVar "Lune.String.isEmpty") (CVar "existing")) [CoreAlt (PCon "Lune.Prelude.True" []) (CApp (CApp (CVar "Lune.String.append") (CString "#!/usr/bin/env sh\n\n")) (CVar "line")),CoreAlt (PCon "Lune.Prelude.False" []) (CApp (CApp (CVar "Lune.String.append") (CVar "existing")) (CVar "line"))]) (CApp (CApp (CSelect (CVar "$dictMonad_Task") "andThen") (CApp (CApp (CVar "Lune.Task.onError") (CApp (CApp (CVar "Lune.IO.writeFile") (CVar "HealthAgent.approvedCommandsPath")) (CVar "updated"))) (CLam [PWildcard] (CApp (CVar "Lune.Task.succeed") (CVar "Lune.Prelude.unit"))))) (CLam [PWildcard] (CApp (CVar "Lune.Task.succeed") (CApp (CVar "Template.render") (CTemplate False [CTemplateText "Recorded: ",CTemplateHole (TCon "String") (CApp (CSelect (CVar "$dictToTemplate_String") "toTemplate") (CVar "cmd"))])))))))))),CoreDecl "" (CInt 0),CoreDecl "HealthAgent.processActions" (CLam [PVar "total",PVar "actions"] (CApp (CApp (CApp (CVar "HealthAgent.processActionsGo") (CInt 1)) (CVar "total")) (CVar "actions"))),CoreDecl "" (CInt 0),CoreDecl "HealthAgent.processActionsGo" (CLam [PVar "current",PVar "total",PVar "actions"] (CCase (CVar "actions") [CoreAlt (PCon "Lune.Prelude.Nil" []) (CApp (CApp (CSelect (CVar "$dictMonad_Task") "andThen") (CApp (CVar "Lune.IO.println") (CString "All actions processed."))) (CLam [PWildcard] (CApp (CVar "Lune.Task.succeed") (CVar "Lune.Prelude.unit")))),CoreAlt (PCon "Lune.Prelude.Cons" [Located {locSpan = Span {spanStartLine = 433, spanStartCol = 10, spanEndLine = 433, spanEndCol = 14}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "act"},Located {locSpan = Span {spanStartLine = 433, spanStartCol = 14, spanEndLine = 433, spanEndCol = 19}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "rest"}]) (CApp (CApp (CSelect (CVar "$dictMonad_Task") "andThen") (CApp (CVar "Lune.IO.println") (CApp (CApp (CApp (CVar "HealthAgent.showAction") (CVar "current")) (CVar "total")) (CVar "act")))) (CLam [PWildcard] (CApp (CApp (CSelect (CVar "$dictMonad_Task") "andThen") (CVar "HealthAgent.promptForApproval")) (CLam [PVar "approval"] (CCase (CVar "approval") [CoreAlt (PCon "HealthAgent.Quit" []) (CApp (CApp (CSelect (CVar "$dictMonad_Task") "andThen") (CApp (CVar "Lune.IO.println") (CString "Quitting. Remaining actions skipped."))) (CLam [PWildcard] (CApp (CVar "Lune.Task.succeed") (CVar "Lune.Prelude.unit")))),CoreAlt (PCon "HealthAgent.Skipped" []) (CApp (CApp (CSelect (CVar "$dictMonad_Task") "andThen") (CApp (CVar "Lune.IO.println") (CString "Action skipped."))) (CLam [PWildcard] (CApp (CApp (CApp (CVar "HealthAgent.processActionsGo") (CApp (CApp (CVar "Lune.Int.add") (CVar "current")) (CInt 1))) (CVar "total")) (CVar "rest")))),CoreAlt (PCon "HealthAgent.Approved" []) (CApp (CApp (CSelect (CVar "$dictMonad_Task") "andThen") (CApp (CVar "HealthAgent.recordApprovedCommand") (CSelect (CVar "act") "command"))) (CLam [PVar "result"] (CApp (CApp (CSelect (CVar "$dictMonad_Task") "andThen") (CApp (CVar "Lune.IO.println") (CVar "result"))) (CLam [PWildcard] (CApp (CApp (CSelect (CVar "$dictMonad_Task") "andThen") (CApp (CVar "Lune.IO.println") (CString "Action recorded."))) (CLam [PWildcard] (CApp (CApp (CApp (CVar "HealthAgent.processActionsGo") (CApp (CApp (CVar "Lune.Int.add") (CVar "current")) (CInt 1))) (CVar "total")) (CVar "rest"))))))))])))))])),CoreDecl "" (CInt 0),CoreDecl "HealthAgent.runAgent" (CApp (CApp (CSelect (CVar "$dictMonad_Task") "andThen") (CApp (CVar "Lune.IO.println") (CString "Collecting system health data..."))) (CLam [PWildcard] (CApp (CApp (CSelect (CVar "$dictMonad_Task") "andThen") (CVar "HealthAgent.collectHealthReport")) (CLam [PVar "report"] (CApp (CApp (CSelect (CVar "$dictMonad_Task") "andThen") (CApp (CVar "Lune.IO.println") (CApp (CVar "Template.render") (CTemplate False [CTemplateText "Health data collected (sampled over ",CTemplateHole (TCon "String") (CApp (CSelect (CVar "$dictToTemplate_String") "toTemplate") (CApp (CVar "Lune.String.fromInt") (CSelect (CVar "report") "dtMs"))),CTemplateText "ms)."])))) (CLam [PWildcard] (CApp (CApp (CSelect (CVar "$dictMonad_Task") "andThen") (CApp (CVar "Lune.IO.println") (CString ""))) (CLam [PWildcard] (CApp (CApp (CSelect (CVar "$dictMonad_Task") "andThen") (CApp (CVar "Lune.IO.println") (CString "Analysing with LLM..."))) (CLam [PWildcard] (CApp (CApp (CSelect (CVar "$dictMonad_Task") "andThen") (CApp (CVar "HealthAgent.analyzeHealth") (CVar "report"))) (CLam [PVar "analysis"] (CApp (CVar "HealthAgent.displayAnalysis") (CVar "analysis")))))))))))))),CoreDecl "" (CInt 0),CoreDecl "HealthAgent.main" (CApp (CApp (CSelect (CVar "$dictMonad_Task") "andThen") (CApp (CVar "Lune.IO.println") (CString "=== Health Agent ==="))) (CLam [PWildcard] (CApp (CApp (CSelect (CVar "$dictMonad_Task") "andThen") (CApp (CVar "Lune.IO.println") (CString ""))) (CLam [PWildcard] (CApp (CApp (CSelect (CVar "$dictMonad_Task") "andThen") (CApp (CVar "Lune.Task.result") (CVar "HealthAgent.runAgent"))) (CLam [PVar "result"] (CCase (CVar "result") [CoreAlt (PCon "Lune.Prelude.Ok" [Located {locSpan = Span {spanStartLine = 475, spanStartCol = 10, spanEndLine = 475, spanEndCol = 12}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PWildcard}]) (CApp (CVar "Lune.Task.succeed") (CVar "Lune.Prelude.unit")),CoreAlt (PCon "Lune.Prelude.Err" [Located {locSpan = Span {spanStartLine = 477, spanStartCol = 11, spanEndLine = 477, spanEndCol = 13}, locComments = Comments {commentsLeading = [], commentsTrailing = [], commentsInner = []}, locValue = PVar "e"}]) (CApp (CVar "Lune.IO.println") (CApp (CVar "HealthAgent.showAgentError") (CVar "e")))])))))))]}
