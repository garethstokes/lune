CoreModule {coreName = "HelloPostgres", coreDecls = [CoreDecl "$dictFunctor_IO" (CRecord [("map",CLam [PVar "f",PVar "ma"] (CApp (CApp (CVar "$primIOBind") (CVar "ma")) (CLam [PVar "a"] (CApp (CVar "$primIOPure") (CApp (CVar "f") (CVar "a"))))))]),CoreDecl "$dictApplicative_IO" (CRecord [("$superFunctor",CVar "$dictFunctor_IO"),("pure",CVar "$primIOPure"),("apply",CLam [PVar "mf",PVar "ma"] (CApp (CApp (CVar "$primIOBind") (CVar "mf")) (CLam [PVar "f"] (CApp (CApp (CVar "$primIOBind") (CVar "ma")) (CLam [PVar "a"] (CApp (CVar "$primIOPure") (CApp (CVar "f") (CVar "a"))))))))]),CoreDecl "$dictMonad_IO" (CRecord [("$superApplicative",CVar "$dictApplicative_IO"),("andThen",CVar "$primIOBind"),("then",CVar "$primIOThen")]),CoreDecl "$dictFunctor_Result" (CRecord [("map",CLam [PVar "f",PVar "r"] (CCase (CVar "r") [CoreAlt (PCon "Lune.Prelude.Err" [PVar "e"]) (CApp (CVar "Lune.Prelude.Err") (CVar "e")),CoreAlt (PCon "Lune.Prelude.Ok" [PVar "a"]) (CApp (CVar "Lune.Prelude.Ok") (CApp (CVar "f") (CVar "a")))]))]),CoreDecl "$dictApplicative_Result" (CRecord [("$superFunctor",CVar "$dictFunctor_Result"),("pure",CLam [PVar "a"] (CApp (CVar "Lune.Prelude.Ok") (CVar "a"))),("apply",CLam [PVar "rf",PVar "ra"] (CCase (CVar "rf") [CoreAlt (PCon "Lune.Prelude.Err" [PVar "e"]) (CApp (CVar "Lune.Prelude.Err") (CVar "e")),CoreAlt (PCon "Lune.Prelude.Ok" [PVar "f"]) (CCase (CVar "ra") [CoreAlt (PCon "Lune.Prelude.Err" [PVar "e"]) (CApp (CVar "Lune.Prelude.Err") (CVar "e")),CoreAlt (PCon "Lune.Prelude.Ok" [PVar "a"]) (CApp (CVar "Lune.Prelude.Ok") (CApp (CVar "f") (CVar "a")))])]))]),CoreDecl "$dictMonad_Result" (CRecord [("$superApplicative",CVar "$dictApplicative_Result"),("andThen",CLam [PVar "m",PVar "k"] (CCase (CVar "m") [CoreAlt (PCon "Lune.Prelude.Ok" [PVar "a"]) (CApp (CVar "k") (CVar "a")),CoreAlt (PCon "Lune.Prelude.Err" [PVar "e"]) (CApp (CVar "Lune.Prelude.Err") (CVar "e"))])),("then",CLam [PVar "ra",PVar "rb"] (CCase (CVar "ra") [CoreAlt (PCon "Lune.Prelude.Ok" [PWildcard]) (CVar "rb"),CoreAlt (PCon "Lune.Prelude.Err" [PVar "e"]) (CApp (CVar "Lune.Prelude.Err") (CVar "e"))]))]),CoreDecl "$dictFunctor_STM" (CRecord [("map",CLam [PVar "f",PVar "ma"] (CApp (CApp (CVar "$primSTMBind") (CVar "ma")) (CLam [PVar "a"] (CApp (CVar "$primSTMPure") (CApp (CVar "f") (CVar "a"))))))]),CoreDecl "$dictApplicative_STM" (CRecord [("$superFunctor",CVar "$dictFunctor_STM"),("pure",CVar "$primSTMPure"),("apply",CLam [PVar "mf",PVar "ma"] (CApp (CApp (CVar "$primSTMBind") (CVar "mf")) (CLam [PVar "f"] (CApp (CApp (CVar "$primSTMBind") (CVar "ma")) (CLam [PVar "a"] (CApp (CVar "$primSTMPure") (CApp (CVar "f") (CVar "a"))))))))]),CoreDecl "$dictMonad_STM" (CRecord [("$superApplicative",CVar "$dictApplicative_STM"),("andThen",CVar "$primSTMBind"),("then",CLam [PVar "ma",PVar "mb"] (CApp (CApp (CVar "$primSTMBind") (CVar "ma")) (CLam [PWildcard] (CVar "mb"))))]),CoreDecl "$dictFunctor_Api" (CRecord [("map",CLam [PVar "f",PVar "ma"] (CApp (CApp (CVar "prim_apiAndThen") (CLam [PVar "a"] (CApp (CVar "prim_apiPure") (CApp (CVar "f") (CVar "a"))))) (CVar "ma")))]),CoreDecl "$dictApplicative_Api" (CRecord [("$superFunctor",CVar "$dictFunctor_Api"),("pure",CVar "prim_apiPure"),("apply",CLam [PVar "mf",PVar "ma"] (CApp (CApp (CVar "prim_apiAndThen") (CLam [PVar "f"] (CApp (CApp (CVar "prim_apiAndThen") (CLam [PVar "a"] (CApp (CVar "prim_apiPure") (CApp (CVar "f") (CVar "a"))))) (CVar "ma")))) (CVar "mf")))]),CoreDecl "$dictMonad_Api" (CRecord [("$superApplicative",CVar "$dictApplicative_Api"),("andThen",CLam [PVar "ma",PVar "k"] (CApp (CApp (CVar "prim_apiAndThen") (CVar "k")) (CVar "ma"))),("then",CLam [PVar "ma",PVar "mb"] (CApp (CApp (CVar "prim_apiAndThen") (CLam [PWildcard] (CVar "mb"))) (CVar "ma")))]),CoreDecl "Lune.Prelude.unit" (CVar "Lune.Prelude.Unit"),CoreDecl "Lune.Prelude.fst" (CLam [PVar "p"] (CCase (CVar "p") [CoreAlt (PCon "Lune.Prelude.Pair" [PVar "x",PWildcard]) (CVar "x")])),CoreDecl "Lune.Prelude.snd" (CLam [PVar "p"] (CCase (CVar "p") [CoreAlt (PCon "Lune.Prelude.Pair" [PWildcard,PVar "y"]) (CVar "y")])),CoreDecl "Lune.IO.println" (CVar "prim_putStrLn"),CoreDecl "Lune.IO.readLine" (CVar "prim_readLine"),CoreDecl "Lune.IO.readInt" (CVar "prim_readInt"),CoreDecl "Lune.IO.sleepMs" (CVar "prim_sleepMs"),CoreDecl "Lune.IO.readFile" (CVar "prim_readFile"),CoreDecl "Lune.IO.writeFile" (CVar "prim_writeFile"),CoreDecl "Lune.String.append" (CVar "prim_appendString"),CoreDecl "Lune.String.eq" (CVar "prim_eqString"),CoreDecl "Lune.String.fromInt" (CVar "prim_showInt"),CoreDecl "Lune.String.fromFloat" (CVar "prim_showFloat"),CoreDecl "Lune.String.toInt" (CVar "prim_parseInt"),CoreDecl "Lune.Database.errorToString" (CLam [PVar "err"] (CCase (CVar "err") [CoreAlt (PCon "Lune.Database.ConnectionFailed" [PVar "msg"]) (CApp (CApp (CVar "Lune.String.append") (CString "Connection failed: ")) (CVar "msg")),CoreAlt (PCon "Lune.Database.QueryFailed" [PVar "msg"]) (CApp (CApp (CVar "Lune.String.append") (CString "Query failed: ")) (CVar "msg")),CoreAlt (PCon "Lune.Database.InvalidConnection" []) (CString "Invalid database connection")])),CoreDecl "Lune.Database.null" (CVar "prim_dbNull"),CoreDecl "Lune.Database.int" (CVar "prim_dbInt"),CoreDecl "Lune.Database.float" (CVar "prim_dbFloat"),CoreDecl "Lune.Database.string" (CVar "prim_dbString"),CoreDecl "Lune.Database.bool" (CVar "prim_dbBool"),CoreDecl "Lune.Database.Postgres.connect" (CVar "prim_pgConnect"),CoreDecl "Lune.Database.Postgres.execute" (CVar "prim_pgExecute"),CoreDecl "Lune.Database.Postgres.query" (CVar "prim_pgQuery"),CoreDecl "Lune.Database.Postgres.close" (CVar "prim_pgClose"),CoreDecl "HelloPostgres.main" (CApp (CApp (CSelect (CVar "$dictMonad_IO") "then") (CApp (CVar "Lune.IO.println") (CString "Connecting to PostgreSQL..."))) (CApp (CApp (CSelect (CVar "$dictMonad_IO") "andThen") (CApp (CVar "Lune.Database.Postgres.connect") (CString "postgresql://localhost/testdb"))) (CLam [PVar "result"] (CCase (CVar "result") [CoreAlt (PCon "Lune.Prelude.Err" [PVar "e"]) (CApp (CVar "Lune.IO.println") (CApp (CApp (CVar "Lune.String.append") (CString "Connection error: ")) (CApp (CVar "Lune.Database.errorToString") (CVar "e")))),CoreAlt (PCon "Lune.Prelude.Ok" [PVar "conn"]) (CApp (CApp (CSelect (CVar "$dictMonad_IO") "then") (CApp (CVar "Lune.IO.println") (CString "Connected!"))) (CApp (CApp (CSelect (CVar "$dictMonad_IO") "then") (CApp (CVar "Lune.IO.println") (CString "Running: SELECT 1 as num"))) (CApp (CApp (CSelect (CVar "$dictMonad_IO") "andThen") (CApp (CApp (CApp (CVar "Lune.Database.Postgres.query") (CVar "conn")) (CString "SELECT 1 as num")) (CVar "Lune.Prelude.Nil"))) (CLam [PVar "queryResult"] (CApp (CApp (CSelect (CVar "$dictMonad_IO") "then") (CCase (CVar "queryResult") [CoreAlt (PCon "Lune.Prelude.Err" [PVar "e"]) (CApp (CVar "Lune.IO.println") (CApp (CApp (CVar "Lune.String.append") (CString "Query error: ")) (CApp (CVar "Lune.Database.errorToString") (CVar "e")))),CoreAlt (PCon "Lune.Prelude.Ok" [PVar "rows"]) (CApp (CApp (CSelect (CVar "$dictMonad_IO") "then") (CApp (CVar "Lune.IO.println") (CString "Query succeeded!"))) (CApp (CVar "HelloPostgres.printRows") (CVar "rows")))])) (CApp (CApp (CSelect (CVar "$dictMonad_IO") "then") (CApp (CVar "Lune.IO.println") (CString ""))) (CApp (CApp (CSelect (CVar "$dictMonad_IO") "then") (CApp (CVar "Lune.IO.println") (CString "Running: SELECT $1 as greeting"))) (CApp (CApp (CSelect (CVar "$dictMonad_IO") "andThen") (CApp (CApp (CApp (CVar "Lune.Database.Postgres.query") (CVar "conn")) (CString "SELECT $1 as greeting")) (CApp (CApp (CVar "Lune.Prelude.Cons") (CApp (CVar "Lune.Database.string") (CString "Hello from Lune!"))) (CVar "Lune.Prelude.Nil")))) (CLam [PVar "paramResult"] (CApp (CApp (CSelect (CVar "$dictMonad_IO") "then") (CCase (CVar "paramResult") [CoreAlt (PCon "Lune.Prelude.Err" [PVar "e"]) (CApp (CVar "Lune.IO.println") (CApp (CApp (CVar "Lune.String.append") (CString "Param query error: ")) (CApp (CVar "Lune.Database.errorToString") (CVar "e")))),CoreAlt (PCon "Lune.Prelude.Ok" [PVar "rows"]) (CApp (CApp (CSelect (CVar "$dictMonad_IO") "then") (CApp (CVar "Lune.IO.println") (CString "Parameterized query succeeded!"))) (CApp (CVar "HelloPostgres.printRows") (CVar "rows")))])) (CApp (CApp (CSelect (CVar "$dictMonad_IO") "andThen") (CApp (CVar "Lune.Database.Postgres.close") (CVar "conn"))) (CLam [PVar "closeResult"] (CCase (CVar "closeResult") [CoreAlt (PCon "Lune.Prelude.Err" [PVar "e"]) (CApp (CVar "Lune.IO.println") (CApp (CApp (CVar "Lune.String.append") (CString "Close error: ")) (CApp (CVar "Lune.Database.errorToString") (CVar "e")))),CoreAlt (PCon "Lune.Prelude.Ok" [PWildcard]) (CApp (CVar "Lune.IO.println") (CString "Connection closed."))])))))))))))))])))),CoreDecl "HelloPostgres.printRows" (CLam [PVar "rows"] (CCase (CVar "rows") [CoreAlt (PCon "Lune.Prelude.Nil" []) (CApp (CVar "Lune.IO.println") (CString "(no rows)")),CoreAlt (PCon "Lune.Prelude.Cons" [PVar "row",PVar "rest"]) (CApp (CApp (CSelect (CVar "$dictMonad_IO") "then") (CApp (CVar "Lune.IO.println") (CApp (CApp (CVar "Lune.String.append") (CString "  Row: ")) (CApp (CVar "HelloPostgres.showRow") (CVar "row"))))) (CApp (CVar "HelloPostgres.printRows") (CVar "rest")))])),CoreDecl "HelloPostgres.showRow" (CLam [PVar "cols"] (CCase (CVar "cols") [CoreAlt (PCon "Lune.Prelude.Nil" []) (CString ""),CoreAlt (PCon "Lune.Prelude.Cons" [PVar "val",PCon "Lune.Prelude.Nil" []]) (CApp (CVar "HelloPostgres.showDbValue") (CVar "val")),CoreAlt (PCon "Lune.Prelude.Cons" [PVar "val",PVar "rest"]) (CApp (CApp (CVar "Lune.String.append") (CApp (CVar "HelloPostgres.showDbValue") (CVar "val"))) (CApp (CApp (CVar "Lune.String.append") (CString ", ")) (CApp (CVar "HelloPostgres.showRow") (CVar "rest"))))])),CoreDecl "HelloPostgres.showDbValue" (CLam [PVar "val"] (CCase (CVar "val") [CoreAlt (PCon "Lune.Database.DbNull" []) (CString "NULL"),CoreAlt (PCon "Lune.Database.DbInt" [PVar "n"]) (CApp (CVar "Lune.String.fromInt") (CVar "n")),CoreAlt (PCon "Lune.Database.DbFloat" [PVar "f"]) (CApp (CVar "Lune.String.fromFloat") (CVar "f")),CoreAlt (PCon "Lune.Database.DbString" [PVar "s"]) (CVar "s"),CoreAlt (PCon "Lune.Database.DbBool" [PVar "b"]) (CCase (CVar "b") [CoreAlt (PCon "Lune.Prelude.True" []) (CString "true"),CoreAlt (PCon "Lune.Prelude.False" []) (CString "false")])]))]}
