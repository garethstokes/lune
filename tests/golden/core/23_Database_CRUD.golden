CoreModule {coreName = "DatabaseCRUD", coreDecls = [CoreDecl "$dictFunctor_IO" (CRecord [("map",CLam [PVar "f",PVar "ma"] (CApp (CApp (CVar "$primIOBind") (CVar "ma")) (CLam [PVar "a"] (CApp (CVar "$primIOPure") (CApp (CVar "f") (CVar "a"))))))]),CoreDecl "$dictApplicative_IO" (CRecord [("$superFunctor",CVar "$dictFunctor_IO"),("pure",CVar "$primIOPure"),("apply",CLam [PVar "mf",PVar "ma"] (CApp (CApp (CVar "$primIOBind") (CVar "mf")) (CLam [PVar "f"] (CApp (CApp (CVar "$primIOBind") (CVar "ma")) (CLam [PVar "a"] (CApp (CVar "$primIOPure") (CApp (CVar "f") (CVar "a"))))))))]),CoreDecl "$dictMonad_IO" (CRecord [("$superApplicative",CVar "$dictApplicative_IO"),("andThen",CVar "$primIOBind"),("then",CVar "$primIOThen")]),CoreDecl "$dictFunctor_Result" (CRecord [("map",CLam [PVar "f",PVar "r"] (CCase (CVar "r") [CoreAlt (PCon "Lune.Prelude.Err" [PVar "e"]) (CApp (CVar "Lune.Prelude.Err") (CVar "e")),CoreAlt (PCon "Lune.Prelude.Ok" [PVar "a"]) (CApp (CVar "Lune.Prelude.Ok") (CApp (CVar "f") (CVar "a")))]))]),CoreDecl "$dictApplicative_Result" (CRecord [("$superFunctor",CVar "$dictFunctor_Result"),("pure",CLam [PVar "a"] (CApp (CVar "Lune.Prelude.Ok") (CVar "a"))),("apply",CLam [PVar "rf",PVar "ra"] (CCase (CVar "rf") [CoreAlt (PCon "Lune.Prelude.Err" [PVar "e"]) (CApp (CVar "Lune.Prelude.Err") (CVar "e")),CoreAlt (PCon "Lune.Prelude.Ok" [PVar "f"]) (CCase (CVar "ra") [CoreAlt (PCon "Lune.Prelude.Err" [PVar "e"]) (CApp (CVar "Lune.Prelude.Err") (CVar "e")),CoreAlt (PCon "Lune.Prelude.Ok" [PVar "a"]) (CApp (CVar "Lune.Prelude.Ok") (CApp (CVar "f") (CVar "a")))])]))]),CoreDecl "$dictMonad_Result" (CRecord [("$superApplicative",CVar "$dictApplicative_Result"),("andThen",CLam [PVar "m",PVar "k"] (CCase (CVar "m") [CoreAlt (PCon "Lune.Prelude.Ok" [PVar "a"]) (CApp (CVar "k") (CVar "a")),CoreAlt (PCon "Lune.Prelude.Err" [PVar "e"]) (CApp (CVar "Lune.Prelude.Err") (CVar "e"))])),("then",CLam [PVar "ra",PVar "rb"] (CCase (CVar "ra") [CoreAlt (PCon "Lune.Prelude.Ok" [PWildcard]) (CVar "rb"),CoreAlt (PCon "Lune.Prelude.Err" [PVar "e"]) (CApp (CVar "Lune.Prelude.Err") (CVar "e"))]))]),CoreDecl "$dictFunctor_STM" (CRecord [("map",CLam [PVar "f",PVar "ma"] (CApp (CApp (CVar "$primSTMBind") (CVar "ma")) (CLam [PVar "a"] (CApp (CVar "$primSTMPure") (CApp (CVar "f") (CVar "a"))))))]),CoreDecl "$dictApplicative_STM" (CRecord [("$superFunctor",CVar "$dictFunctor_STM"),("pure",CVar "$primSTMPure"),("apply",CLam [PVar "mf",PVar "ma"] (CApp (CApp (CVar "$primSTMBind") (CVar "mf")) (CLam [PVar "f"] (CApp (CApp (CVar "$primSTMBind") (CVar "ma")) (CLam [PVar "a"] (CApp (CVar "$primSTMPure") (CApp (CVar "f") (CVar "a"))))))))]),CoreDecl "$dictMonad_STM" (CRecord [("$superApplicative",CVar "$dictApplicative_STM"),("andThen",CVar "$primSTMBind"),("then",CLam [PVar "ma",PVar "mb"] (CApp (CApp (CVar "$primSTMBind") (CVar "ma")) (CLam [PWildcard] (CVar "mb"))))]),CoreDecl "$dictFunctor_Api" (CRecord [("map",CLam [PVar "f",PVar "ma"] (CApp (CApp (CVar "prim_apiAndThen") (CLam [PVar "a"] (CApp (CVar "prim_apiPure") (CApp (CVar "f") (CVar "a"))))) (CVar "ma")))]),CoreDecl "$dictApplicative_Api" (CRecord [("$superFunctor",CVar "$dictFunctor_Api"),("pure",CVar "prim_apiPure"),("apply",CLam [PVar "mf",PVar "ma"] (CApp (CApp (CVar "prim_apiAndThen") (CLam [PVar "f"] (CApp (CApp (CVar "prim_apiAndThen") (CLam [PVar "a"] (CApp (CVar "prim_apiPure") (CApp (CVar "f") (CVar "a"))))) (CVar "ma")))) (CVar "mf")))]),CoreDecl "$dictMonad_Api" (CRecord [("$superApplicative",CVar "$dictApplicative_Api"),("andThen",CLam [PVar "ma",PVar "k"] (CApp (CApp (CVar "prim_apiAndThen") (CVar "k")) (CVar "ma"))),("then",CLam [PVar "ma",PVar "mb"] (CApp (CApp (CVar "prim_apiAndThen") (CLam [PWildcard] (CVar "mb"))) (CVar "ma")))]),CoreDecl "Lune.Prelude.unit" (CVar "Lune.Prelude.Unit"),CoreDecl "Lune.Prelude.fst" (CLam [PVar "p"] (CCase (CVar "p") [CoreAlt (PCon "Lune.Prelude.Pair" [PVar "x",PWildcard]) (CVar "x")])),CoreDecl "Lune.Prelude.snd" (CLam [PVar "p"] (CCase (CVar "p") [CoreAlt (PCon "Lune.Prelude.Pair" [PWildcard,PVar "y"]) (CVar "y")])),CoreDecl "Lune.IO.println" (CVar "prim_putStrLn"),CoreDecl "Lune.IO.readLine" (CVar "prim_readLine"),CoreDecl "Lune.IO.readInt" (CVar "prim_readInt"),CoreDecl "Lune.IO.sleepMs" (CVar "prim_sleepMs"),CoreDecl "Lune.IO.readFile" (CVar "prim_readFile"),CoreDecl "Lune.IO.writeFile" (CVar "prim_writeFile"),CoreDecl "Lune.String.append" (CVar "prim_appendString"),CoreDecl "Lune.String.eq" (CVar "prim_eqString"),CoreDecl "Lune.String.fromInt" (CVar "prim_showInt"),CoreDecl "Lune.String.fromFloat" (CVar "prim_showFloat"),CoreDecl "Lune.String.toInt" (CVar "prim_parseInt"),CoreDecl "Lune.Database.errorToString" (CLam [PVar "err"] (CCase (CVar "err") [CoreAlt (PCon "Lune.Database.ConnectionFailed" [PVar "msg"]) (CApp (CApp (CVar "Lune.String.append") (CString "Connection failed: ")) (CVar "msg")),CoreAlt (PCon "Lune.Database.QueryFailed" [PVar "msg"]) (CApp (CApp (CVar "Lune.String.append") (CString "Query failed: ")) (CVar "msg")),CoreAlt (PCon "Lune.Database.InvalidConnection" []) (CString "Invalid database connection")])),CoreDecl "Lune.Database.null" (CVar "prim_dbNull"),CoreDecl "Lune.Database.int" (CVar "prim_dbInt"),CoreDecl "Lune.Database.float" (CVar "prim_dbFloat"),CoreDecl "Lune.Database.string" (CVar "prim_dbString"),CoreDecl "Lune.Database.bool" (CVar "prim_dbBool"),CoreDecl "Lune.Int.add" (CVar "prim_addInt"),CoreDecl "Lune.Int.sub" (CVar "prim_subInt"),CoreDecl "Lune.Int.mul" (CVar "prim_mulInt"),CoreDecl "Lune.Int.eq" (CVar "prim_eqInt"),CoreDecl "Lune.Int.gte" (CVar "prim_geInt"),CoreDecl "Lune.Int.lte" (CVar "prim_leInt"),CoreDecl "Lune.Float.add" (CVar "prim_addFloat"),CoreDecl "Lune.Float.sub" (CVar "prim_subFloat"),CoreDecl "Lune.Float.mul" (CVar "prim_mulFloat"),CoreDecl "Lune.Float.div" (CVar "prim_divFloat"),CoreDecl "Lune.Float.eq" (CVar "prim_eqFloat"),CoreDecl "Lune.Float.gt" (CVar "prim_gtFloat"),CoreDecl "Lune.Float.lt" (CVar "prim_ltFloat"),CoreDecl "Lune.Float.gte" (CVar "prim_geFloat"),CoreDecl "Lune.Float.lte" (CVar "prim_leFloat"),CoreDecl "Lune.Float.fromInt" (CVar "prim_fromIntFloat"),CoreDecl "Lune.Float.truncate" (CVar "prim_truncateFloat"),CoreDecl "Lune.Database.Decode.decodeRow" (CLam [PVar "decoder",PVar "row"] (CApp (CVar "decoder") (CVar "row"))),CoreDecl "Lune.Database.Decode.succeed" (CLam [PVar "value"] (CLam [PWildcard] (CApp (CVar "Lune.Prelude.Ok") (CVar "value")))),CoreDecl "Lune.Database.Decode.fail" (CLam [PVar "message"] (CLam [PWildcard] (CApp (CVar "Lune.Prelude.Err") (CRecord [("message",CVar "message"),("column",CInt 0)])))),CoreDecl "Lune.Database.Decode.index" (CLam [PVar "idx",PVar "decoder"] (CLam [PVar "row"] (CCase (CApp (CApp (CVar "Lune.Database.Decode.getAt") (CVar "idx")) (CVar "row")) [CoreAlt (PCon "Lune.Prelude.Nothing" []) (CApp (CVar "Lune.Prelude.Err") (CRecord [("message",CApp (CApp (CVar "Lune.String.append") (CString "Column index out of bounds: ")) (CApp (CVar "Lune.String.fromInt") (CVar "idx"))),("column",CVar "idx")])),CoreAlt (PCon "Lune.Prelude.Just" [PVar "val"]) (CCase (CApp (CVar "decoder") (CApp (CApp (CVar "Lune.Prelude.Cons") (CVar "val")) (CVar "Lune.Prelude.Nil"))) [CoreAlt (PCon "Lune.Prelude.Err" [PVar "err"]) (CApp (CVar "Lune.Prelude.Err") (CRecord [("message",CSelect (CVar "err") "message"),("column",CVar "idx")])),CoreAlt (PCon "Lune.Prelude.Ok" [PVar "a"]) (CApp (CVar "Lune.Prelude.Ok") (CVar "a"))])]))),CoreDecl "Lune.Database.Decode.getAt" (CLam [PVar "idx",PVar "xs"] (CCase (CVar "xs") [CoreAlt (PCon "Lune.Prelude.Nil" []) (CVar "Lune.Prelude.Nothing"),CoreAlt (PCon "Lune.Prelude.Cons" [PVar "x",PVar "rest"]) (CCase (CApp (CApp (CVar "Lune.Int.lte") (CVar "idx")) (CInt 0)) [CoreAlt (PCon "Lune.Prelude.True" []) (CApp (CVar "Lune.Prelude.Just") (CVar "x")),CoreAlt (PCon "Lune.Prelude.False" []) (CApp (CApp (CVar "Lune.Database.Decode.getAt") (CApp (CApp (CVar "Lune.Int.sub") (CVar "idx")) (CInt 1))) (CVar "rest"))])])),CoreDecl "Lune.Database.Decode.int" (CLam [PVar "row"] (CCase (CVar "row") [CoreAlt (PCon "Lune.Prelude.Cons" [PCon "Lune.Database.DbInt" [PVar "n"],PWildcard]) (CApp (CVar "Lune.Prelude.Ok") (CVar "n")),CoreAlt (PCon "Lune.Prelude.Cons" [PCon "Lune.Database.DbString" [PVar "s"],PWildcard]) (CCase (CApp (CVar "Lune.String.toInt") (CVar "s")) [CoreAlt (PCon "Lune.Prelude.Ok" [PVar "n"]) (CApp (CVar "Lune.Prelude.Ok") (CVar "n")),CoreAlt (PCon "Lune.Prelude.Err" [PWildcard]) (CApp (CVar "Lune.Prelude.Err") (CRecord [("message",CString "Expected integer"),("column",CInt 0)]))]),CoreAlt (PCon "Lune.Prelude.Cons" [PCon "Lune.Database.DbNull" [],PWildcard]) (CApp (CVar "Lune.Prelude.Err") (CRecord [("message",CString "Expected integer, got NULL"),("column",CInt 0)])),CoreAlt PWildcard (CApp (CVar "Lune.Prelude.Err") (CRecord [("message",CString "Expected integer"),("column",CInt 0)]))])),CoreDecl "Lune.Database.Decode.float" (CLam [PVar "row"] (CCase (CVar "row") [CoreAlt (PCon "Lune.Prelude.Cons" [PCon "Lune.Database.DbFloat" [PVar "f"],PWildcard]) (CApp (CVar "Lune.Prelude.Ok") (CVar "f")),CoreAlt (PCon "Lune.Prelude.Cons" [PCon "Lune.Database.DbInt" [PVar "n"],PWildcard]) (CApp (CVar "Lune.Prelude.Ok") (CApp (CVar "Lune.Float.fromInt") (CVar "n"))),CoreAlt (PCon "Lune.Prelude.Cons" [PCon "Lune.Database.DbString" [PVar "s"],PWildcard]) (CApp (CVar "Lune.Prelude.Err") (CRecord [("message",CString "Expected float"),("column",CInt 0)])),CoreAlt (PCon "Lune.Prelude.Cons" [PCon "Lune.Database.DbNull" [],PWildcard]) (CApp (CVar "Lune.Prelude.Err") (CRecord [("message",CString "Expected float, got NULL"),("column",CInt 0)])),CoreAlt PWildcard (CApp (CVar "Lune.Prelude.Err") (CRecord [("message",CString "Expected float"),("column",CInt 0)]))])),CoreDecl "Lune.Database.Decode.string" (CLam [PVar "row"] (CCase (CVar "row") [CoreAlt (PCon "Lune.Prelude.Cons" [PCon "Lune.Database.DbString" [PVar "s"],PWildcard]) (CApp (CVar "Lune.Prelude.Ok") (CVar "s")),CoreAlt (PCon "Lune.Prelude.Cons" [PCon "Lune.Database.DbInt" [PVar "n"],PWildcard]) (CApp (CVar "Lune.Prelude.Ok") (CApp (CVar "Lune.String.fromInt") (CVar "n"))),CoreAlt (PCon "Lune.Prelude.Cons" [PCon "Lune.Database.DbFloat" [PVar "f"],PWildcard]) (CApp (CVar "Lune.Prelude.Ok") (CApp (CVar "Lune.String.fromFloat") (CVar "f"))),CoreAlt (PCon "Lune.Prelude.Cons" [PCon "Lune.Database.DbBool" [PVar "b"],PWildcard]) (CCase (CVar "b") [CoreAlt (PCon "Lune.Prelude.True" []) (CApp (CVar "Lune.Prelude.Ok") (CString "true")),CoreAlt (PCon "Lune.Prelude.False" []) (CApp (CVar "Lune.Prelude.Ok") (CString "false"))]),CoreAlt (PCon "Lune.Prelude.Cons" [PCon "Lune.Database.DbNull" [],PWildcard]) (CApp (CVar "Lune.Prelude.Err") (CRecord [("message",CString "Expected string, got NULL"),("column",CInt 0)])),CoreAlt PWildcard (CApp (CVar "Lune.Prelude.Err") (CRecord [("message",CString "Expected string"),("column",CInt 0)]))])),CoreDecl "Lune.Database.Decode.bool" (CLam [PVar "row"] (CCase (CVar "row") [CoreAlt (PCon "Lune.Prelude.Cons" [PCon "Lune.Database.DbBool" [PVar "b"],PWildcard]) (CApp (CVar "Lune.Prelude.Ok") (CVar "b")),CoreAlt (PCon "Lune.Prelude.Cons" [PCon "Lune.Database.DbString" [PVar "s"],PWildcard]) (CApp (CVar "Lune.Database.Decode.parseBoolString") (CVar "s")),CoreAlt (PCon "Lune.Prelude.Cons" [PCon "Lune.Database.DbNull" [],PWildcard]) (CApp (CVar "Lune.Prelude.Err") (CRecord [("message",CString "Expected boolean, got NULL"),("column",CInt 0)])),CoreAlt PWildcard (CApp (CVar "Lune.Prelude.Err") (CRecord [("message",CString "Expected boolean"),("column",CInt 0)]))])),CoreDecl "Lune.Database.Decode.parseBoolString" (CLam [PVar "s"] (CCase (CApp (CApp (CVar "Lune.String.eq") (CVar "s")) (CString "t")) [CoreAlt (PCon "Lune.Prelude.True" []) (CApp (CVar "Lune.Prelude.Ok") (CVar "Lune.Prelude.True")),CoreAlt (PCon "Lune.Prelude.False" []) (CCase (CApp (CApp (CVar "Lune.String.eq") (CVar "s")) (CString "true")) [CoreAlt (PCon "Lune.Prelude.True" []) (CApp (CVar "Lune.Prelude.Ok") (CVar "Lune.Prelude.True")),CoreAlt (PCon "Lune.Prelude.False" []) (CCase (CApp (CApp (CVar "Lune.String.eq") (CVar "s")) (CString "1")) [CoreAlt (PCon "Lune.Prelude.True" []) (CApp (CVar "Lune.Prelude.Ok") (CVar "Lune.Prelude.True")),CoreAlt (PCon "Lune.Prelude.False" []) (CCase (CApp (CApp (CVar "Lune.String.eq") (CVar "s")) (CString "f")) [CoreAlt (PCon "Lune.Prelude.True" []) (CApp (CVar "Lune.Prelude.Ok") (CVar "Lune.Prelude.False")),CoreAlt (PCon "Lune.Prelude.False" []) (CCase (CApp (CApp (CVar "Lune.String.eq") (CVar "s")) (CString "false")) [CoreAlt (PCon "Lune.Prelude.True" []) (CApp (CVar "Lune.Prelude.Ok") (CVar "Lune.Prelude.False")),CoreAlt (PCon "Lune.Prelude.False" []) (CCase (CApp (CApp (CVar "Lune.String.eq") (CVar "s")) (CString "0")) [CoreAlt (PCon "Lune.Prelude.True" []) (CApp (CVar "Lune.Prelude.Ok") (CVar "Lune.Prelude.False")),CoreAlt (PCon "Lune.Prelude.False" []) (CApp (CVar "Lune.Prelude.Err") (CRecord [("message",CString "Expected boolean"),("column",CInt 0)]))])])])])])])),CoreDecl "Lune.Database.Decode.nullable" (CLam [PVar "decoder"] (CLam [PVar "row"] (CCase (CVar "row") [CoreAlt (PCon "Lune.Prelude.Cons" [PCon "Lune.Database.DbNull" [],PWildcard]) (CApp (CVar "Lune.Prelude.Ok") (CVar "Lune.Prelude.Nothing")),CoreAlt PWildcard (CCase (CApp (CVar "decoder") (CVar "row")) [CoreAlt (PCon "Lune.Prelude.Ok" [PVar "a"]) (CApp (CVar "Lune.Prelude.Ok") (CApp (CVar "Lune.Prelude.Just") (CVar "a"))),CoreAlt (PCon "Lune.Prelude.Err" [PVar "err"]) (CApp (CVar "Lune.Prelude.Err") (CVar "err"))])]))),CoreDecl "Lune.Database.Decode.map" (CLam [PVar "f",PVar "decoder"] (CLam [PVar "row"] (CCase (CApp (CVar "decoder") (CVar "row")) [CoreAlt (PCon "Lune.Prelude.Err" [PVar "err"]) (CApp (CVar "Lune.Prelude.Err") (CVar "err")),CoreAlt (PCon "Lune.Prelude.Ok" [PVar "a"]) (CApp (CVar "Lune.Prelude.Ok") (CApp (CVar "f") (CVar "a")))]))),CoreDecl "Lune.Database.Decode.map2" (CLam [PVar "f",PVar "decoderA",PVar "decoderB"] (CLam [PVar "row"] (CCase (CApp (CVar "decoderA") (CVar "row")) [CoreAlt (PCon "Lune.Prelude.Err" [PVar "err"]) (CApp (CVar "Lune.Prelude.Err") (CVar "err")),CoreAlt (PCon "Lune.Prelude.Ok" [PVar "a"]) (CCase (CApp (CVar "decoderB") (CVar "row")) [CoreAlt (PCon "Lune.Prelude.Err" [PVar "err"]) (CApp (CVar "Lune.Prelude.Err") (CVar "err")),CoreAlt (PCon "Lune.Prelude.Ok" [PVar "b"]) (CApp (CVar "Lune.Prelude.Ok") (CApp (CApp (CVar "f") (CVar "a")) (CVar "b")))])]))),CoreDecl "Lune.Database.Decode.map3" (CLam [PVar "f",PVar "da",PVar "db",PVar "dc"] (CLam [PVar "row"] (CCase (CApp (CVar "da") (CVar "row")) [CoreAlt (PCon "Lune.Prelude.Err" [PVar "err"]) (CApp (CVar "Lune.Prelude.Err") (CVar "err")),CoreAlt (PCon "Lune.Prelude.Ok" [PVar "a"]) (CCase (CApp (CVar "db") (CVar "row")) [CoreAlt (PCon "Lune.Prelude.Err" [PVar "err"]) (CApp (CVar "Lune.Prelude.Err") (CVar "err")),CoreAlt (PCon "Lune.Prelude.Ok" [PVar "b"]) (CCase (CApp (CVar "dc") (CVar "row")) [CoreAlt (PCon "Lune.Prelude.Err" [PVar "err"]) (CApp (CVar "Lune.Prelude.Err") (CVar "err")),CoreAlt (PCon "Lune.Prelude.Ok" [PVar "c"]) (CApp (CVar "Lune.Prelude.Ok") (CApp (CApp (CApp (CVar "f") (CVar "a")) (CVar "b")) (CVar "c")))])])]))),CoreDecl "Lune.Database.Decode.map4" (CLam [PVar "f",PVar "da",PVar "db",PVar "dc",PVar "dd"] (CLam [PVar "row"] (CCase (CApp (CVar "da") (CVar "row")) [CoreAlt (PCon "Lune.Prelude.Err" [PVar "err"]) (CApp (CVar "Lune.Prelude.Err") (CVar "err")),CoreAlt (PCon "Lune.Prelude.Ok" [PVar "a"]) (CCase (CApp (CVar "db") (CVar "row")) [CoreAlt (PCon "Lune.Prelude.Err" [PVar "err"]) (CApp (CVar "Lune.Prelude.Err") (CVar "err")),CoreAlt (PCon "Lune.Prelude.Ok" [PVar "b"]) (CCase (CApp (CVar "dc") (CVar "row")) [CoreAlt (PCon "Lune.Prelude.Err" [PVar "err"]) (CApp (CVar "Lune.Prelude.Err") (CVar "err")),CoreAlt (PCon "Lune.Prelude.Ok" [PVar "c"]) (CCase (CApp (CVar "dd") (CVar "row")) [CoreAlt (PCon "Lune.Prelude.Err" [PVar "err"]) (CApp (CVar "Lune.Prelude.Err") (CVar "err")),CoreAlt (PCon "Lune.Prelude.Ok" [PVar "d"]) (CApp (CVar "Lune.Prelude.Ok") (CApp (CApp (CApp (CApp (CVar "f") (CVar "a")) (CVar "b")) (CVar "c")) (CVar "d")))])])])]))),CoreDecl "Lune.Database.Decode.map5" (CLam [PVar "fn",PVar "da",PVar "db",PVar "dc",PVar "dd",PVar "de"] (CLam [PVar "row"] (CCase (CApp (CVar "da") (CVar "row")) [CoreAlt (PCon "Lune.Prelude.Err" [PVar "err"]) (CApp (CVar "Lune.Prelude.Err") (CVar "err")),CoreAlt (PCon "Lune.Prelude.Ok" [PVar "a"]) (CCase (CApp (CVar "db") (CVar "row")) [CoreAlt (PCon "Lune.Prelude.Err" [PVar "err"]) (CApp (CVar "Lune.Prelude.Err") (CVar "err")),CoreAlt (PCon "Lune.Prelude.Ok" [PVar "b"]) (CCase (CApp (CVar "dc") (CVar "row")) [CoreAlt (PCon "Lune.Prelude.Err" [PVar "err"]) (CApp (CVar "Lune.Prelude.Err") (CVar "err")),CoreAlt (PCon "Lune.Prelude.Ok" [PVar "c"]) (CCase (CApp (CVar "dd") (CVar "row")) [CoreAlt (PCon "Lune.Prelude.Err" [PVar "err"]) (CApp (CVar "Lune.Prelude.Err") (CVar "err")),CoreAlt (PCon "Lune.Prelude.Ok" [PVar "d"]) (CCase (CApp (CVar "de") (CVar "row")) [CoreAlt (PCon "Lune.Prelude.Err" [PVar "err"]) (CApp (CVar "Lune.Prelude.Err") (CVar "err")),CoreAlt (PCon "Lune.Prelude.Ok" [PVar "e"]) (CApp (CVar "Lune.Prelude.Ok") (CApp (CApp (CApp (CApp (CApp (CVar "fn") (CVar "a")) (CVar "b")) (CVar "c")) (CVar "d")) (CVar "e")))])])])])]))),CoreDecl "Lune.Database.Decode.andThen" (CLam [PVar "continuation",PVar "decoder"] (CLam [PVar "row"] (CCase (CApp (CVar "decoder") (CVar "row")) [CoreAlt (PCon "Lune.Prelude.Err" [PVar "err"]) (CApp (CVar "Lune.Prelude.Err") (CVar "err")),CoreAlt (PCon "Lune.Prelude.Ok" [PVar "a"]) (CApp (CApp (CVar "continuation") (CVar "a")) (CVar "row"))]))),CoreDecl "Lune.Database.Decode.errorToString" (CLam [PVar "err"] (CApp (CApp (CVar "Lune.String.append") (CString "Decode error at column ")) (CApp (CApp (CVar "Lune.String.append") (CApp (CVar "Lune.String.fromInt") (CSelect (CVar "err") "column"))) (CApp (CApp (CVar "Lune.String.append") (CString ": ")) (CSelect (CVar "err") "message"))))),CoreDecl "Lune.Database.Query.unitDecoder" (CLam [PWildcard] (CApp (CVar "Lune.Prelude.Ok") (CVar "Lune.Prelude.unit"))),CoreDecl "Lune.Database.Query.table" (CLam [PVar "name"] (CRecord [("name",CVar "name")])),CoreDecl "Lune.Database.Query.column" (CLam [PVar "tbl",PVar "colName"] (CRecord [("tableName",CSelect (CVar "tbl") "name"),("columnName",CVar "colName")])),CoreDecl "Lune.Database.Query.select" (CLam [PVar "tbl",PVar "decoder"] (CRecord [("tableName",CSelect (CVar "tbl") "name"),("decoder",CVar "decoder"),("queryType",CVar "Lune.Database.Query.Select"),("conditions",CVar "Lune.Prelude.Nil"),("assignments",CVar "Lune.Prelude.Nil"),("orderBy",CVar "Lune.Prelude.Nothing"),("limitCount",CVar "Lune.Prelude.Nothing"),("offsetCount",CVar "Lune.Prelude.Nothing"),("returningFlag",CVar "Lune.Prelude.False")])),CoreDecl "Lune.Database.Query.insert" (CLam [PVar "tbl",PVar "decoder"] (CRecord [("tableName",CSelect (CVar "tbl") "name"),("decoder",CVar "decoder"),("queryType",CVar "Lune.Database.Query.Insert"),("conditions",CVar "Lune.Prelude.Nil"),("assignments",CVar "Lune.Prelude.Nil"),("orderBy",CVar "Lune.Prelude.Nothing"),("limitCount",CVar "Lune.Prelude.Nothing"),("offsetCount",CVar "Lune.Prelude.Nothing"),("returningFlag",CVar "Lune.Prelude.False")])),CoreDecl "Lune.Database.Query.update" (CLam [PVar "tbl",PVar "decoder"] (CRecord [("tableName",CSelect (CVar "tbl") "name"),("decoder",CVar "decoder"),("queryType",CVar "Lune.Database.Query.Update"),("conditions",CVar "Lune.Prelude.Nil"),("assignments",CVar "Lune.Prelude.Nil"),("orderBy",CVar "Lune.Prelude.Nothing"),("limitCount",CVar "Lune.Prelude.Nothing"),("offsetCount",CVar "Lune.Prelude.Nothing"),("returningFlag",CVar "Lune.Prelude.False")])),CoreDecl "Lune.Database.Query.delete" (CLam [PVar "tbl"] (CRecord [("tableName",CSelect (CVar "tbl") "name"),("decoder",CVar "Lune.Database.Query.unitDecoder"),("queryType",CVar "Lune.Database.Query.Delete"),("conditions",CVar "Lune.Prelude.Nil"),("assignments",CVar "Lune.Prelude.Nil"),("orderBy",CVar "Lune.Prelude.Nothing"),("limitCount",CVar "Lune.Prelude.Nothing"),("offsetCount",CVar "Lune.Prelude.Nothing"),("returningFlag",CVar "Lune.Prelude.False")])),CoreDecl "Lune.Database.Query.set" (CLam [PVar "col",PVar "val"] (CRecord [("column",CSelect (CVar "col") "columnName"),("value",CVar "val")])),CoreDecl "Lune.Database.Query.values" (CLam [PVar "assigns",PVar "query"] (CRecord [("tableName",CSelect (CVar "query") "tableName"),("decoder",CSelect (CVar "query") "decoder"),("queryType",CSelect (CVar "query") "queryType"),("conditions",CSelect (CVar "query") "conditions"),("assignments",CApp (CApp (CVar "Lune.Database.Query.appendList") (CVar "assigns")) (CSelect (CVar "query") "assignments")),("orderBy",CSelect (CVar "query") "orderBy"),("limitCount",CSelect (CVar "query") "limitCount"),("offsetCount",CSelect (CVar "query") "offsetCount"),("returningFlag",CSelect (CVar "query") "returningFlag")])),CoreDecl "Lune.Database.Query.returning" (CLam [PVar "query"] (CRecord [("tableName",CSelect (CVar "query") "tableName"),("decoder",CSelect (CVar "query") "decoder"),("queryType",CSelect (CVar "query") "queryType"),("conditions",CSelect (CVar "query") "conditions"),("assignments",CSelect (CVar "query") "assignments"),("orderBy",CSelect (CVar "query") "orderBy"),("limitCount",CSelect (CVar "query") "limitCount"),("offsetCount",CSelect (CVar "query") "offsetCount"),("returningFlag",CVar "Lune.Prelude.True")])),CoreDecl "Lune.Database.Query.eq" (CLam [PVar "col",PVar "val"] (CRecord [("sql",CApp (CApp (CVar "Lune.String.append") (CSelect (CVar "col") "columnName")) (CString " =")),("params",CApp (CApp (CVar "Lune.Prelude.Cons") (CVar "val")) (CVar "Lune.Prelude.Nil"))])),CoreDecl "Lune.Database.Query.gt" (CLam [PVar "col",PVar "val"] (CRecord [("sql",CApp (CApp (CVar "Lune.String.append") (CSelect (CVar "col") "columnName")) (CString " >")),("params",CApp (CApp (CVar "Lune.Prelude.Cons") (CVar "val")) (CVar "Lune.Prelude.Nil"))])),CoreDecl "Lune.Database.Query.lt" (CLam [PVar "col",PVar "val"] (CRecord [("sql",CApp (CApp (CVar "Lune.String.append") (CSelect (CVar "col") "columnName")) (CString " <")),("params",CApp (CApp (CVar "Lune.Prelude.Cons") (CVar "val")) (CVar "Lune.Prelude.Nil"))])),CoreDecl "Lune.Database.Query.gte" (CLam [PVar "col",PVar "val"] (CRecord [("sql",CApp (CApp (CVar "Lune.String.append") (CSelect (CVar "col") "columnName")) (CString " >=")),("params",CApp (CApp (CVar "Lune.Prelude.Cons") (CVar "val")) (CVar "Lune.Prelude.Nil"))])),CoreDecl "Lune.Database.Query.lte" (CLam [PVar "col",PVar "val"] (CRecord [("sql",CApp (CApp (CVar "Lune.String.append") (CSelect (CVar "col") "columnName")) (CString " <=")),("params",CApp (CApp (CVar "Lune.Prelude.Cons") (CVar "val")) (CVar "Lune.Prelude.Nil"))])),CoreDecl "Lune.Database.Query.neq" (CLam [PVar "col",PVar "val"] (CRecord [("sql",CApp (CApp (CVar "Lune.String.append") (CSelect (CVar "col") "columnName")) (CString " <>")),("params",CApp (CApp (CVar "Lune.Prelude.Cons") (CVar "val")) (CVar "Lune.Prelude.Nil"))])),CoreDecl "Lune.Database.Query.like" (CLam [PVar "col",PVar "val"] (CRecord [("sql",CApp (CApp (CVar "Lune.String.append") (CSelect (CVar "col") "columnName")) (CString " LIKE")),("params",CApp (CApp (CVar "Lune.Prelude.Cons") (CVar "val")) (CVar "Lune.Prelude.Nil"))])),CoreDecl "Lune.Database.Query.isNull" (CLam [PVar "col"] (CRecord [("sql",CApp (CApp (CVar "Lune.String.append") (CSelect (CVar "col") "columnName")) (CString " IS NULL")),("params",CVar "Lune.Prelude.Nil")])),CoreDecl "Lune.Database.Query.isNotNull" (CLam [PVar "col"] (CRecord [("sql",CApp (CApp (CVar "Lune.String.append") (CSelect (CVar "col") "columnName")) (CString " IS NOT NULL")),("params",CVar "Lune.Prelude.Nil")])),CoreDecl "Lune.Database.Query.in_" (CLam [PVar "col",PVar "vals"] (CRecord [("sql",CApp (CApp (CVar "Lune.String.append") (CSelect (CVar "col") "columnName")) (CString " IN")),("params",CVar "vals")])),CoreDecl "Lune.Database.Query.where_" (CLam [PVar "cond",PVar "query"] (CRecord [("tableName",CSelect (CVar "query") "tableName"),("decoder",CSelect (CVar "query") "decoder"),("queryType",CSelect (CVar "query") "queryType"),("conditions",CApp (CApp (CVar "Lune.Prelude.Cons") (CVar "cond")) (CSelect (CVar "query") "conditions")),("assignments",CSelect (CVar "query") "assignments"),("orderBy",CSelect (CVar "query") "orderBy"),("limitCount",CSelect (CVar "query") "limitCount"),("offsetCount",CSelect (CVar "query") "offsetCount"),("returningFlag",CSelect (CVar "query") "returningFlag")])),CoreDecl "Lune.Database.Query.orderBy" (CLam [PVar "col",PVar "ord",PVar "query"] (CRecord [("tableName",CSelect (CVar "query") "tableName"),("decoder",CSelect (CVar "query") "decoder"),("queryType",CSelect (CVar "query") "queryType"),("conditions",CSelect (CVar "query") "conditions"),("assignments",CSelect (CVar "query") "assignments"),("orderBy",CApp (CVar "Lune.Prelude.Just") (CRecord [("column",CSelect (CVar "col") "columnName"),("order",CVar "ord")])),("limitCount",CSelect (CVar "query") "limitCount"),("offsetCount",CSelect (CVar "query") "offsetCount"),("returningFlag",CSelect (CVar "query") "returningFlag")])),CoreDecl "Lune.Database.Query.limit" (CLam [PVar "n",PVar "query"] (CRecord [("tableName",CSelect (CVar "query") "tableName"),("decoder",CSelect (CVar "query") "decoder"),("queryType",CSelect (CVar "query") "queryType"),("conditions",CSelect (CVar "query") "conditions"),("assignments",CSelect (CVar "query") "assignments"),("orderBy",CSelect (CVar "query") "orderBy"),("limitCount",CApp (CVar "Lune.Prelude.Just") (CVar "n")),("offsetCount",CSelect (CVar "query") "offsetCount"),("returningFlag",CSelect (CVar "query") "returningFlag")])),CoreDecl "Lune.Database.Query.offset" (CLam [PVar "n",PVar "query"] (CRecord [("tableName",CSelect (CVar "query") "tableName"),("decoder",CSelect (CVar "query") "decoder"),("queryType",CSelect (CVar "query") "queryType"),("conditions",CSelect (CVar "query") "conditions"),("assignments",CSelect (CVar "query") "assignments"),("orderBy",CSelect (CVar "query") "orderBy"),("limitCount",CSelect (CVar "query") "limitCount"),("offsetCount",CApp (CVar "Lune.Prelude.Just") (CVar "n")),("returningFlag",CSelect (CVar "query") "returningFlag")])),CoreDecl "Lune.Database.Query.toSql" (CLam [PVar "query"] (CCase (CSelect (CVar "query") "queryType") [CoreAlt (PCon "Lune.Database.Query.Select" []) (CApp (CVar "Lune.Database.Query.buildSelectSql") (CVar "query")),CoreAlt (PCon "Lune.Database.Query.Insert" []) (CApp (CVar "Lune.Database.Query.buildInsertSql") (CVar "query")),CoreAlt (PCon "Lune.Database.Query.Update" []) (CApp (CVar "Lune.Database.Query.buildUpdateSql") (CVar "query")),CoreAlt (PCon "Lune.Database.Query.Delete" []) (CApp (CVar "Lune.Database.Query.buildDeleteSql") (CVar "query"))])),CoreDecl "Lune.Database.Query.buildSelectSql" (CLam [PVar "query"] (CApp (CApp (CApp (CApp (CApp (CVar "Lune.Database.Query.buildSelectSqlResult") (CSelect (CVar "query") "tableName")) (CApp (CApp (CVar "Lune.Database.Query.buildWhere") (CSelect (CVar "query") "conditions")) (CInt 1))) (CSelect (CVar "query") "orderBy")) (CSelect (CVar "query") "limitCount")) (CSelect (CVar "query") "offsetCount"))),CoreDecl "Lune.Database.Query.buildSelectSqlResult" (CLam [PVar "tableName",PVar "whereResult",PVar "maybeOrder",PVar "maybeLimit",PVar "maybeOffset"] (CRecord [("sql",CApp (CApp (CVar "Lune.String.append") (CString "SELECT * FROM ")) (CApp (CApp (CVar "Lune.String.append") (CVar "tableName")) (CApp (CApp (CVar "Lune.String.append") (CSelect (CVar "whereResult") "sql")) (CApp (CApp (CVar "Lune.String.append") (CApp (CVar "Lune.Database.Query.buildOrderBy") (CVar "maybeOrder"))) (CApp (CApp (CVar "Lune.String.append") (CApp (CVar "Lune.Database.Query.buildLimit") (CVar "maybeLimit"))) (CApp (CVar "Lune.Database.Query.buildOffset") (CVar "maybeOffset"))))))),("params",CSelect (CVar "whereResult") "params")])),CoreDecl "Lune.Database.Query.buildInsertSql" (CLam [PVar "query"] (CCase (CSelect (CVar "query") "assignments") [CoreAlt (PCon "Lune.Prelude.Nil" []) (CRecord [("sql",CApp (CApp (CVar "Lune.String.append") (CString "INSERT INTO ")) (CApp (CApp (CVar "Lune.String.append") (CSelect (CVar "query") "tableName")) (CString " DEFAULT VALUES"))),("params",CVar "Lune.Prelude.Nil")]),CoreAlt PWildcard (CApp (CVar "Lune.Database.Query.buildInsertWithValues") (CVar "query"))])),CoreDecl "Lune.Database.Query.buildInsertWithValues" (CLam [PVar "query"] (CRecord [("sql",CApp (CApp (CVar "Lune.String.append") (CString "INSERT INTO ")) (CApp (CApp (CVar "Lune.String.append") (CSelect (CVar "query") "tableName")) (CApp (CApp (CVar "Lune.String.append") (CString " (")) (CApp (CApp (CVar "Lune.String.append") (CApp (CVar "Lune.Database.Query.buildColumnList") (CSelect (CVar "query") "assignments"))) (CApp (CApp (CVar "Lune.String.append") (CString ") VALUES (")) (CApp (CApp (CVar "Lune.String.append") (CApp (CApp (CVar "Lune.Database.Query.buildPlaceholders") (CSelect (CVar "query") "assignments")) (CInt 1))) (CApp (CApp (CVar "Lune.String.append") (CString ")")) (CApp (CVar "Lune.Database.Query.buildReturning") (CSelect (CVar "query") "returningFlag"))))))))),("params",CApp (CVar "Lune.Database.Query.collectAssignmentValues") (CSelect (CVar "query") "assignments"))])),CoreDecl "Lune.Database.Query.buildColumnList" (CLam [PVar "assigns"] (CCase (CVar "assigns") [CoreAlt (PCon "Lune.Prelude.Nil" []) (CString ""),CoreAlt (PCon "Lune.Prelude.Cons" [PVar "a",PCon "Lune.Prelude.Nil" []]) (CSelect (CVar "a") "column"),CoreAlt (PCon "Lune.Prelude.Cons" [PVar "a",PVar "rest"]) (CApp (CApp (CVar "Lune.String.append") (CSelect (CVar "a") "column")) (CApp (CApp (CVar "Lune.String.append") (CString ", ")) (CApp (CVar "Lune.Database.Query.buildColumnList") (CVar "rest"))))])),CoreDecl "Lune.Database.Query.buildPlaceholders" (CLam [PVar "assigns",PVar "n"] (CCase (CVar "assigns") [CoreAlt (PCon "Lune.Prelude.Nil" []) (CString ""),CoreAlt (PCon "Lune.Prelude.Cons" [PWildcard,PCon "Lune.Prelude.Nil" []]) (CApp (CApp (CVar "Lune.String.append") (CString "$")) (CApp (CVar "Lune.String.fromInt") (CVar "n"))),CoreAlt (PCon "Lune.Prelude.Cons" [PWildcard,PVar "rest"]) (CApp (CApp (CVar "Lune.String.append") (CString "$")) (CApp (CApp (CVar "Lune.String.append") (CApp (CVar "Lune.String.fromInt") (CVar "n"))) (CApp (CApp (CVar "Lune.String.append") (CString ", ")) (CApp (CApp (CVar "Lune.Database.Query.buildPlaceholders") (CVar "rest")) (CApp (CApp (CVar "Lune.Int.add") (CVar "n")) (CInt 1))))))])),CoreDecl "Lune.Database.Query.collectAssignmentValues" (CLam [PVar "assigns"] (CCase (CVar "assigns") [CoreAlt (PCon "Lune.Prelude.Nil" []) (CVar "Lune.Prelude.Nil"),CoreAlt (PCon "Lune.Prelude.Cons" [PVar "a",PVar "rest"]) (CApp (CApp (CVar "Lune.Prelude.Cons") (CSelect (CVar "a") "value")) (CApp (CVar "Lune.Database.Query.collectAssignmentValues") (CVar "rest")))])),CoreDecl "Lune.Database.Query.buildReturning" (CLam [PVar "flag"] (CCase (CVar "flag") [CoreAlt (PCon "Lune.Prelude.True" []) (CString " RETURNING *"),CoreAlt (PCon "Lune.Prelude.False" []) (CString "")])),CoreDecl "Lune.Database.Query.buildUpdateSql" (CLam [PVar "query"] (CCase (CSelect (CVar "query") "assignments") [CoreAlt (PCon "Lune.Prelude.Nil" []) (CRecord [("sql",CApp (CApp (CVar "Lune.String.append") (CString "UPDATE ")) (CApp (CApp (CVar "Lune.String.append") (CSelect (CVar "query") "tableName")) (CString " SET "))),("params",CVar "Lune.Prelude.Nil")]),CoreAlt PWildcard (CApp (CVar "Lune.Database.Query.buildUpdateWithSets") (CVar "query"))])),CoreDecl "Lune.Database.Query.buildUpdateWithSets" (CLam [PVar "query"] (CApp (CApp (CApp (CApp (CVar "Lune.Database.Query.buildUpdateResult") (CSelect (CVar "query") "tableName")) (CSelect (CVar "query") "assignments")) (CSelect (CVar "query") "conditions")) (CSelect (CVar "query") "returningFlag"))),CoreDecl "Lune.Database.Query.buildUpdateResult" (CLam [PVar "tableName",PVar "assigns",PVar "conds",PVar "retFlag"] (CCase (CApp (CApp (CVar "Lune.Database.Query.buildSetClauses") (CVar "assigns")) (CInt 1)) [CoreAlt (PVar "setResult") (CCase (CApp (CApp (CVar "Lune.Database.Query.buildWhere") (CVar "conds")) (CApp (CApp (CVar "Lune.Int.add") (CInt 1)) (CApp (CVar "Lune.Database.Query.listLength") (CVar "assigns")))) [CoreAlt (PVar "whereResult") (CRecord [("sql",CApp (CApp (CVar "Lune.String.append") (CString "UPDATE ")) (CApp (CApp (CVar "Lune.String.append") (CVar "tableName")) (CApp (CApp (CVar "Lune.String.append") (CString " SET ")) (CApp (CApp (CVar "Lune.String.append") (CSelect (CVar "setResult") "sql")) (CApp (CApp (CVar "Lune.String.append") (CSelect (CVar "whereResult") "sql")) (CApp (CVar "Lune.Database.Query.buildReturning") (CVar "retFlag"))))))),("params",CApp (CApp (CVar "Lune.Database.Query.appendList") (CSelect (CVar "setResult") "params")) (CSelect (CVar "whereResult") "params"))])])])),CoreDecl "Lune.Database.Query.buildSetClauses" (CLam [PVar "assigns",PVar "n"] (CCase (CVar "assigns") [CoreAlt (PCon "Lune.Prelude.Nil" []) (CRecord [("sql",CString ""),("params",CVar "Lune.Prelude.Nil")]),CoreAlt (PCon "Lune.Prelude.Cons" [PVar "a",PCon "Lune.Prelude.Nil" []]) (CRecord [("sql",CApp (CApp (CVar "Lune.String.append") (CSelect (CVar "a") "column")) (CApp (CApp (CVar "Lune.String.append") (CString " = $")) (CApp (CVar "Lune.String.fromInt") (CVar "n")))),("params",CApp (CApp (CVar "Lune.Prelude.Cons") (CSelect (CVar "a") "value")) (CVar "Lune.Prelude.Nil"))]),CoreAlt (PCon "Lune.Prelude.Cons" [PVar "a",PVar "rest"]) (CCase (CApp (CApp (CVar "Lune.Database.Query.buildSetClauses") (CVar "rest")) (CApp (CApp (CVar "Lune.Int.add") (CVar "n")) (CInt 1))) [CoreAlt (PVar "restResult") (CRecord [("sql",CApp (CApp (CVar "Lune.String.append") (CSelect (CVar "a") "column")) (CApp (CApp (CVar "Lune.String.append") (CString " = $")) (CApp (CApp (CVar "Lune.String.append") (CApp (CVar "Lune.String.fromInt") (CVar "n"))) (CApp (CApp (CVar "Lune.String.append") (CString ", ")) (CSelect (CVar "restResult") "sql"))))),("params",CApp (CApp (CVar "Lune.Prelude.Cons") (CSelect (CVar "a") "value")) (CSelect (CVar "restResult") "params"))])])])),CoreDecl "Lune.Database.Query.buildDeleteSql" (CLam [PVar "query"] (CCase (CApp (CApp (CVar "Lune.Database.Query.buildWhere") (CSelect (CVar "query") "conditions")) (CInt 1)) [CoreAlt (PVar "whereResult") (CRecord [("sql",CApp (CApp (CVar "Lune.String.append") (CString "DELETE FROM ")) (CApp (CApp (CVar "Lune.String.append") (CSelect (CVar "query") "tableName")) (CSelect (CVar "whereResult") "sql"))),("params",CSelect (CVar "whereResult") "params")])])),CoreDecl "Lune.Database.Query.buildWhere" (CLam [PVar "conds",PVar "paramNum"] (CCase (CVar "conds") [CoreAlt (PCon "Lune.Prelude.Nil" []) (CRecord [("sql",CString ""),("params",CVar "Lune.Prelude.Nil")]),CoreAlt (PCon "Lune.Prelude.Cons" [PWildcard,PWildcard]) (CApp (CApp (CVar "Lune.Database.Query.buildWhereNonEmpty") (CApp (CVar "Lune.Database.Query.reverseList") (CVar "conds"))) (CVar "paramNum"))])),CoreDecl "Lune.Database.Query.buildWhereNonEmpty" (CLam [PVar "conds",PVar "paramNum"] (CCase (CApp (CApp (CVar "Lune.Database.Query.buildClauses") (CVar "conds")) (CVar "paramNum")) [CoreAlt (PVar "result") (CRecord [("sql",CApp (CApp (CVar "Lune.String.append") (CString " WHERE ")) (CSelect (CVar "result") "sql")),("params",CSelect (CVar "result") "params")])])),CoreDecl "Lune.Database.Query.buildClauses" (CLam [PVar "conds",PVar "paramNum"] (CCase (CVar "conds") [CoreAlt (PCon "Lune.Prelude.Nil" []) (CRecord [("sql",CString ""),("params",CVar "Lune.Prelude.Nil")]),CoreAlt (PCon "Lune.Prelude.Cons" [PVar "cond",PCon "Lune.Prelude.Nil" []]) (CApp (CApp (CVar "Lune.Database.Query.buildSingleClause") (CVar "cond")) (CVar "paramNum")),CoreAlt (PCon "Lune.Prelude.Cons" [PVar "cond",PVar "rest"]) (CApp (CApp (CApp (CVar "Lune.Database.Query.buildClauseWithRest") (CVar "cond")) (CVar "rest")) (CVar "paramNum"))])),CoreDecl "Lune.Database.Query.buildSingleClause" (CLam [PVar "cond",PVar "paramNum"] (CCase (CSelect (CVar "cond") "params") [CoreAlt (PCon "Lune.Prelude.Nil" []) (CRecord [("sql",CSelect (CVar "cond") "sql"),("params",CVar "Lune.Prelude.Nil")]),CoreAlt (PCon "Lune.Prelude.Cons" [PWildcard,PCon "Lune.Prelude.Nil" []]) (CRecord [("sql",CApp (CApp (CVar "Lune.String.append") (CSelect (CVar "cond") "sql")) (CApp (CApp (CVar "Lune.String.append") (CString " $")) (CApp (CVar "Lune.String.fromInt") (CVar "paramNum")))),("params",CSelect (CVar "cond") "params")]),CoreAlt (PCon "Lune.Prelude.Cons" [PWildcard,PCon "Lune.Prelude.Cons" [PWildcard,PWildcard]]) (CApp (CApp (CVar "Lune.Database.Query.buildInClause") (CVar "cond")) (CVar "paramNum"))])),CoreDecl "Lune.Database.Query.buildInClause" (CLam [PVar "cond",PVar "paramNum"] (CRecord [("sql",CApp (CApp (CVar "Lune.String.append") (CSelect (CVar "cond") "sql")) (CApp (CApp (CVar "Lune.String.append") (CString " (")) (CApp (CApp (CVar "Lune.String.append") (CApp (CApp (CVar "Lune.Database.Query.buildInPlaceholders") (CSelect (CVar "cond") "params")) (CVar "paramNum"))) (CString ")")))),("params",CSelect (CVar "cond") "params")])),CoreDecl "Lune.Database.Query.buildInPlaceholders" (CLam [PVar "vals",PVar "n"] (CCase (CVar "vals") [CoreAlt (PCon "Lune.Prelude.Nil" []) (CString ""),CoreAlt (PCon "Lune.Prelude.Cons" [PWildcard,PCon "Lune.Prelude.Nil" []]) (CApp (CApp (CVar "Lune.String.append") (CString "$")) (CApp (CVar "Lune.String.fromInt") (CVar "n"))),CoreAlt (PCon "Lune.Prelude.Cons" [PWildcard,PVar "rest"]) (CApp (CApp (CVar "Lune.String.append") (CString "$")) (CApp (CApp (CVar "Lune.String.append") (CApp (CVar "Lune.String.fromInt") (CVar "n"))) (CApp (CApp (CVar "Lune.String.append") (CString ", ")) (CApp (CApp (CVar "Lune.Database.Query.buildInPlaceholders") (CVar "rest")) (CApp (CApp (CVar "Lune.Int.add") (CVar "n")) (CInt 1))))))])),CoreDecl "Lune.Database.Query.buildClauseWithRest" (CLam [PVar "cond",PVar "rest",PVar "paramNum"] (CCase (CSelect (CVar "cond") "params") [CoreAlt (PCon "Lune.Prelude.Nil" []) (CCase (CApp (CApp (CVar "Lune.Database.Query.buildClauses") (CVar "rest")) (CVar "paramNum")) [CoreAlt (PVar "restResult") (CRecord [("sql",CApp (CApp (CVar "Lune.String.append") (CSelect (CVar "cond") "sql")) (CApp (CApp (CVar "Lune.String.append") (CString " AND ")) (CSelect (CVar "restResult") "sql"))),("params",CSelect (CVar "restResult") "params")])]),CoreAlt PWildcard (CCase (CApp (CApp (CVar "Lune.Database.Query.buildClauses") (CVar "rest")) (CApp (CApp (CVar "Lune.Int.add") (CVar "paramNum")) (CApp (CVar "Lune.Database.Query.listLength") (CSelect (CVar "cond") "params")))) [CoreAlt (PVar "restResult") (CCase (CSelect (CVar "cond") "params") [CoreAlt (PCon "Lune.Prelude.Cons" [PWildcard,PCon "Lune.Prelude.Nil" []]) (CRecord [("sql",CApp (CApp (CVar "Lune.String.append") (CSelect (CVar "cond") "sql")) (CApp (CApp (CVar "Lune.String.append") (CString " $")) (CApp (CApp (CVar "Lune.String.append") (CApp (CVar "Lune.String.fromInt") (CVar "paramNum"))) (CApp (CApp (CVar "Lune.String.append") (CString " AND ")) (CSelect (CVar "restResult") "sql"))))),("params",CApp (CApp (CVar "Lune.Database.Query.appendList") (CSelect (CVar "cond") "params")) (CSelect (CVar "restResult") "params"))]),CoreAlt PWildcard (CRecord [("sql",CApp (CApp (CVar "Lune.String.append") (CSelect (CVar "cond") "sql")) (CApp (CApp (CVar "Lune.String.append") (CString " (")) (CApp (CApp (CVar "Lune.String.append") (CApp (CApp (CVar "Lune.Database.Query.buildInPlaceholders") (CSelect (CVar "cond") "params")) (CVar "paramNum"))) (CApp (CApp (CVar "Lune.String.append") (CString ") AND ")) (CSelect (CVar "restResult") "sql"))))),("params",CApp (CApp (CVar "Lune.Database.Query.appendList") (CSelect (CVar "cond") "params")) (CSelect (CVar "restResult") "params"))])])])])),CoreDecl "Lune.Database.Query.reverseList" (CLam [PVar "xs"] (CApp (CApp (CVar "Lune.Database.Query.reverseHelper") (CVar "xs")) (CVar "Lune.Prelude.Nil"))),CoreDecl "Lune.Database.Query.reverseHelper" (CLam [PVar "xs",PVar "acc"] (CCase (CVar "xs") [CoreAlt (PCon "Lune.Prelude.Nil" []) (CVar "acc"),CoreAlt (PCon "Lune.Prelude.Cons" [PVar "x",PVar "rest"]) (CApp (CApp (CVar "Lune.Database.Query.reverseHelper") (CVar "rest")) (CApp (CApp (CVar "Lune.Prelude.Cons") (CVar "x")) (CVar "acc")))])),CoreDecl "Lune.Database.Query.buildOrderBy" (CLam [PVar "maybeOrder"] (CCase (CVar "maybeOrder") [CoreAlt (PCon "Lune.Prelude.Nothing" []) (CString ""),CoreAlt (PCon "Lune.Prelude.Just" [PVar "ord"]) (CApp (CApp (CVar "Lune.String.append") (CString " ORDER BY ")) (CApp (CApp (CVar "Lune.String.append") (CSelect (CVar "ord") "column")) (CCase (CSelect (CVar "ord") "order") [CoreAlt (PCon "Lune.Database.Query.Asc" []) (CString " ASC"),CoreAlt (PCon "Lune.Database.Query.Desc" []) (CString " DESC")])))])),CoreDecl "Lune.Database.Query.buildLimit" (CLam [PVar "maybeLimit"] (CCase (CVar "maybeLimit") [CoreAlt (PCon "Lune.Prelude.Nothing" []) (CString ""),CoreAlt (PCon "Lune.Prelude.Just" [PVar "n"]) (CApp (CApp (CVar "Lune.String.append") (CString " LIMIT ")) (CApp (CVar "Lune.String.fromInt") (CVar "n")))])),CoreDecl "Lune.Database.Query.buildOffset" (CLam [PVar "maybeOffset"] (CCase (CVar "maybeOffset") [CoreAlt (PCon "Lune.Prelude.Nothing" []) (CString ""),CoreAlt (PCon "Lune.Prelude.Just" [PVar "n"]) (CApp (CApp (CVar "Lune.String.append") (CString " OFFSET ")) (CApp (CVar "Lune.String.fromInt") (CVar "n")))])),CoreDecl "Lune.Database.Query.appendList" (CLam [PVar "xs",PVar "ys"] (CCase (CVar "xs") [CoreAlt (PCon "Lune.Prelude.Nil" []) (CVar "ys"),CoreAlt (PCon "Lune.Prelude.Cons" [PVar "x",PVar "rest"]) (CApp (CApp (CVar "Lune.Prelude.Cons") (CVar "x")) (CApp (CApp (CVar "Lune.Database.Query.appendList") (CVar "rest")) (CVar "ys")))])),CoreDecl "Lune.Database.Query.listLength" (CLam [PVar "xs"] (CCase (CVar "xs") [CoreAlt (PCon "Lune.Prelude.Nil" []) (CInt 0),CoreAlt (PCon "Lune.Prelude.Cons" [PWildcard,PVar "rest"]) (CApp (CApp (CVar "Lune.Int.add") (CInt 1)) (CApp (CVar "Lune.Database.Query.listLength") (CVar "rest")))])),CoreDecl "Lune.Database.Query.getDecoder" (CLam [PVar "q"] (CSelect (CVar "q") "decoder")),CoreDecl "Lune.Database.Query.getSql" (CLam [PVar "q"] (CSelect (CApp (CVar "Lune.Database.Query.toSql") (CVar "q")) "sql")),CoreDecl "Lune.Database.Query.getParams" (CLam [PVar "q"] (CSelect (CApp (CVar "Lune.Database.Query.toSql") (CVar "q")) "params")),CoreDecl "Lune.Database.Query.getQueryType" (CLam [PVar "q"] (CSelect (CVar "q") "queryType")),CoreDecl "Lune.Database.Query.hasReturning" (CLam [PVar "q"] (CSelect (CVar "q") "returningFlag")),CoreDecl "DatabaseCRUD.users" (CApp (CVar "Lune.Database.Query.table") (CString "users")),CoreDecl "DatabaseCRUD.users_id" (CApp (CApp (CVar "Lune.Database.Query.column") (CVar "DatabaseCRUD.users")) (CString "id")),CoreDecl "DatabaseCRUD.users_name" (CApp (CApp (CVar "Lune.Database.Query.column") (CVar "DatabaseCRUD.users")) (CString "name")),CoreDecl "DatabaseCRUD.users_email" (CApp (CApp (CVar "Lune.Database.Query.column") (CVar "DatabaseCRUD.users")) (CString "email")),CoreDecl "DatabaseCRUD.userDecoder" (CApp (CApp (CApp (CApp (CVar "Lune.Database.Decode.map3") (CLam [PVar "id",PVar "name",PVar "email"] (CRecord [("id",CVar "id"),("name",CVar "name"),("email",CVar "email")]))) (CApp (CApp (CVar "Lune.Database.Decode.index") (CInt 0)) (CVar "Lune.Database.Decode.int"))) (CApp (CApp (CVar "Lune.Database.Decode.index") (CInt 1)) (CVar "Lune.Database.Decode.string"))) (CApp (CApp (CVar "Lune.Database.Decode.index") (CInt 2)) (CVar "Lune.Database.Decode.string"))),CoreDecl "DatabaseCRUD.insertQuery" (CApp (CVar "Lune.Database.Query.returning") (CApp (CApp (CVar "Lune.Database.Query.values") (CApp (CApp (CVar "Lune.Prelude.Cons") (CApp (CApp (CVar "Lune.Database.Query.set") (CVar "DatabaseCRUD.users_name")) (CApp (CVar "Lune.Database.string") (CString "Alice")))) (CApp (CApp (CVar "Lune.Prelude.Cons") (CApp (CApp (CVar "Lune.Database.Query.set") (CVar "DatabaseCRUD.users_email")) (CApp (CVar "Lune.Database.string") (CString "alice@example.com")))) (CVar "Lune.Prelude.Nil")))) (CApp (CApp (CVar "Lune.Database.Query.insert") (CVar "DatabaseCRUD.users")) (CVar "DatabaseCRUD.userDecoder")))),CoreDecl "DatabaseCRUD.insertNoReturnQuery" (CApp (CApp (CVar "Lune.Database.Query.values") (CApp (CApp (CVar "Lune.Prelude.Cons") (CApp (CApp (CVar "Lune.Database.Query.set") (CVar "DatabaseCRUD.users_name")) (CApp (CVar "Lune.Database.string") (CString "Bob")))) (CApp (CApp (CVar "Lune.Prelude.Cons") (CApp (CApp (CVar "Lune.Database.Query.set") (CVar "DatabaseCRUD.users_email")) (CApp (CVar "Lune.Database.string") (CString "bob@example.com")))) (CVar "Lune.Prelude.Nil")))) (CApp (CApp (CVar "Lune.Database.Query.insert") (CVar "DatabaseCRUD.users")) (CVar "DatabaseCRUD.userDecoder"))),CoreDecl "DatabaseCRUD.updateQuery" (CApp (CVar "Lune.Database.Query.returning") (CApp (CApp (CVar "Lune.Database.Query.where_") (CApp (CApp (CVar "Lune.Database.Query.eq") (CVar "DatabaseCRUD.users_id")) (CApp (CVar "Lune.Database.int") (CInt 42)))) (CApp (CApp (CVar "Lune.Database.Query.values") (CApp (CApp (CVar "Lune.Prelude.Cons") (CApp (CApp (CVar "Lune.Database.Query.set") (CVar "DatabaseCRUD.users_name")) (CApp (CVar "Lune.Database.string") (CString "Updated Name")))) (CVar "Lune.Prelude.Nil"))) (CApp (CApp (CVar "Lune.Database.Query.update") (CVar "DatabaseCRUD.users")) (CVar "DatabaseCRUD.userDecoder"))))),CoreDecl "DatabaseCRUD.deleteQuery" (CApp (CApp (CVar "Lune.Database.Query.where_") (CApp (CApp (CVar "Lune.Database.Query.eq") (CVar "DatabaseCRUD.users_id")) (CApp (CVar "Lune.Database.int") (CInt 42)))) (CApp (CVar "Lune.Database.Query.delete") (CVar "DatabaseCRUD.users"))),CoreDecl "DatabaseCRUD.main" (CApp (CApp (CSelect (CVar "$dictMonad_IO") "then") (CApp (CVar "Lune.IO.println") (CString "=== CRUD Query Builder Examples ==="))) (CApp (CApp (CSelect (CVar "$dictMonad_IO") "then") (CApp (CVar "Lune.IO.println") (CString ""))) (CApp (CApp (CSelect (CVar "$dictMonad_IO") "then") (CVar "DatabaseCRUD.insertExample")) (CApp (CApp (CSelect (CVar "$dictMonad_IO") "then") (CApp (CVar "Lune.IO.println") (CString ""))) (CApp (CApp (CSelect (CVar "$dictMonad_IO") "then") (CVar "DatabaseCRUD.insertNoReturnExample")) (CApp (CApp (CSelect (CVar "$dictMonad_IO") "then") (CApp (CVar "Lune.IO.println") (CString ""))) (CApp (CApp (CSelect (CVar "$dictMonad_IO") "then") (CVar "DatabaseCRUD.updateExample")) (CApp (CApp (CSelect (CVar "$dictMonad_IO") "then") (CApp (CVar "Lune.IO.println") (CString ""))) (CApp (CApp (CSelect (CVar "$dictMonad_IO") "then") (CVar "DatabaseCRUD.deleteExample")) (CApp (CApp (CSelect (CVar "$dictMonad_IO") "then") (CApp (CVar "Lune.IO.println") (CString ""))) (CApp (CVar "Lune.IO.println") (CString "Done!")))))))))))),CoreDecl "DatabaseCRUD.insertExample" (CApp (CApp (CSelect (CVar "$dictMonad_IO") "then") (CApp (CVar "Lune.IO.println") (CString "1. INSERT with RETURNING:"))) (CApp (CApp (CSelect (CVar "$dictMonad_IO") "then") (CApp (CVar "Lune.IO.println") (CString "   Query.insert users userDecoder"))) (CApp (CApp (CSelect (CVar "$dictMonad_IO") "then") (CApp (CVar "Lune.IO.println") (CString "     |> Query.values [set name, set email]"))) (CApp (CApp (CSelect (CVar "$dictMonad_IO") "then") (CApp (CVar "Lune.IO.println") (CString "     |> Query.returning"))) (CApp (CVar "DatabaseCRUD.printSql") (CVar "DatabaseCRUD.insertQuery")))))),CoreDecl "DatabaseCRUD.insertNoReturnExample" (CApp (CApp (CSelect (CVar "$dictMonad_IO") "then") (CApp (CVar "Lune.IO.println") (CString "2. INSERT without RETURNING:"))) (CApp (CApp (CSelect (CVar "$dictMonad_IO") "then") (CApp (CVar "Lune.IO.println") (CString "   Query.insert users userDecoder"))) (CApp (CApp (CSelect (CVar "$dictMonad_IO") "then") (CApp (CVar "Lune.IO.println") (CString "     |> Query.values [set name, set email]"))) (CApp (CVar "DatabaseCRUD.printSql") (CVar "DatabaseCRUD.insertNoReturnQuery"))))),CoreDecl "DatabaseCRUD.updateExample" (CApp (CApp (CSelect (CVar "$dictMonad_IO") "then") (CApp (CVar "Lune.IO.println") (CString "3. UPDATE with WHERE and RETURNING:"))) (CApp (CApp (CSelect (CVar "$dictMonad_IO") "then") (CApp (CVar "Lune.IO.println") (CString "   Query.update users userDecoder"))) (CApp (CApp (CSelect (CVar "$dictMonad_IO") "then") (CApp (CVar "Lune.IO.println") (CString "     |> Query.values [set name]"))) (CApp (CApp (CSelect (CVar "$dictMonad_IO") "then") (CApp (CVar "Lune.IO.println") (CString "     |> Query.where_ (Query.eq users_id 42)"))) (CApp (CApp (CSelect (CVar "$dictMonad_IO") "then") (CApp (CVar "Lune.IO.println") (CString "     |> Query.returning"))) (CApp (CVar "DatabaseCRUD.printSql") (CVar "DatabaseCRUD.updateQuery"))))))),CoreDecl "DatabaseCRUD.deleteExample" (CApp (CApp (CSelect (CVar "$dictMonad_IO") "then") (CApp (CVar "Lune.IO.println") (CString "4. DELETE with WHERE:"))) (CApp (CApp (CSelect (CVar "$dictMonad_IO") "then") (CApp (CVar "Lune.IO.println") (CString "   Query.delete users"))) (CApp (CApp (CSelect (CVar "$dictMonad_IO") "then") (CApp (CVar "Lune.IO.println") (CString "     |> Query.where_ (Query.eq users_id 42)"))) (CApp (CVar "DatabaseCRUD.printSql") (CVar "DatabaseCRUD.deleteQuery"))))),CoreDecl "DatabaseCRUD.printSql" (CLam [PVar "q"] (CApp (CVar "Lune.IO.println") (CApp (CApp (CVar "Lune.String.append") (CString "   SQL: ")) (CApp (CVar "Lune.Database.Query.getSql") (CVar "q")))))]}
