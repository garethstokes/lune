CoreModule {coreName = "HttpParseTest", coreDecls = [CoreDecl "$dictFunctor_IO" (CRecord [("map",CLam [PVar "f",PVar "ma"] (CApp (CApp (CVar "$primIOBind") (CVar "ma")) (CLam [PVar "a"] (CApp (CVar "$primIOPure") (CApp (CVar "f") (CVar "a"))))))]),CoreDecl "$dictApplicative_IO" (CRecord [("$superFunctor",CVar "$dictFunctor_IO"),("pure",CVar "$primIOPure"),("apply",CLam [PVar "mf",PVar "ma"] (CApp (CApp (CVar "$primIOBind") (CVar "mf")) (CLam [PVar "f"] (CApp (CApp (CVar "$primIOBind") (CVar "ma")) (CLam [PVar "a"] (CApp (CVar "$primIOPure") (CApp (CVar "f") (CVar "a"))))))))]),CoreDecl "$dictMonad_IO" (CRecord [("$superApplicative",CVar "$dictApplicative_IO"),("andThen",CVar "$primIOBind"),("then",CVar "$primIOThen")]),CoreDecl "$dictFunctor_Result" (CRecord [("map",CLam [PVar "f",PVar "r"] (CCase (CVar "r") [CoreAlt (PCon "Lune.Prelude.Err" [PVar "e"]) (CApp (CVar "Lune.Prelude.Err") (CVar "e")),CoreAlt (PCon "Lune.Prelude.Ok" [PVar "a"]) (CApp (CVar "Lune.Prelude.Ok") (CApp (CVar "f") (CVar "a")))]))]),CoreDecl "$dictApplicative_Result" (CRecord [("$superFunctor",CVar "$dictFunctor_Result"),("pure",CLam [PVar "a"] (CApp (CVar "Lune.Prelude.Ok") (CVar "a"))),("apply",CLam [PVar "rf",PVar "ra"] (CCase (CVar "rf") [CoreAlt (PCon "Lune.Prelude.Err" [PVar "e"]) (CApp (CVar "Lune.Prelude.Err") (CVar "e")),CoreAlt (PCon "Lune.Prelude.Ok" [PVar "f"]) (CCase (CVar "ra") [CoreAlt (PCon "Lune.Prelude.Err" [PVar "e"]) (CApp (CVar "Lune.Prelude.Err") (CVar "e")),CoreAlt (PCon "Lune.Prelude.Ok" [PVar "a"]) (CApp (CVar "Lune.Prelude.Ok") (CApp (CVar "f") (CVar "a")))])]))]),CoreDecl "$dictMonad_Result" (CRecord [("$superApplicative",CVar "$dictApplicative_Result"),("andThen",CLam [PVar "m",PVar "k"] (CCase (CVar "m") [CoreAlt (PCon "Lune.Prelude.Ok" [PVar "a"]) (CApp (CVar "k") (CVar "a")),CoreAlt (PCon "Lune.Prelude.Err" [PVar "e"]) (CApp (CVar "Lune.Prelude.Err") (CVar "e"))])),("then",CLam [PVar "ra",PVar "rb"] (CCase (CVar "ra") [CoreAlt (PCon "Lune.Prelude.Ok" [PWildcard]) (CVar "rb"),CoreAlt (PCon "Lune.Prelude.Err" [PVar "e"]) (CApp (CVar "Lune.Prelude.Err") (CVar "e"))]))]),CoreDecl "$dictFunctor_STM" (CRecord [("map",CLam [PVar "f",PVar "ma"] (CApp (CApp (CVar "$primSTMBind") (CVar "ma")) (CLam [PVar "a"] (CApp (CVar "$primSTMPure") (CApp (CVar "f") (CVar "a"))))))]),CoreDecl "$dictApplicative_STM" (CRecord [("$superFunctor",CVar "$dictFunctor_STM"),("pure",CVar "$primSTMPure"),("apply",CLam [PVar "mf",PVar "ma"] (CApp (CApp (CVar "$primSTMBind") (CVar "mf")) (CLam [PVar "f"] (CApp (CApp (CVar "$primSTMBind") (CVar "ma")) (CLam [PVar "a"] (CApp (CVar "$primSTMPure") (CApp (CVar "f") (CVar "a"))))))))]),CoreDecl "$dictMonad_STM" (CRecord [("$superApplicative",CVar "$dictApplicative_STM"),("andThen",CVar "$primSTMBind"),("then",CLam [PVar "ma",PVar "mb"] (CApp (CApp (CVar "$primSTMBind") (CVar "ma")) (CLam [PWildcard] (CVar "mb"))))]),CoreDecl "$dictFunctor_Api" (CRecord [("map",CLam [PVar "f",PVar "ma"] (CApp (CApp (CVar "prim_apiAndThen") (CLam [PVar "a"] (CApp (CVar "prim_apiPure") (CApp (CVar "f") (CVar "a"))))) (CVar "ma")))]),CoreDecl "$dictApplicative_Api" (CRecord [("$superFunctor",CVar "$dictFunctor_Api"),("pure",CVar "prim_apiPure"),("apply",CLam [PVar "mf",PVar "ma"] (CApp (CApp (CVar "prim_apiAndThen") (CLam [PVar "f"] (CApp (CApp (CVar "prim_apiAndThen") (CLam [PVar "a"] (CApp (CVar "prim_apiPure") (CApp (CVar "f") (CVar "a"))))) (CVar "ma")))) (CVar "mf")))]),CoreDecl "$dictMonad_Api" (CRecord [("$superApplicative",CVar "$dictApplicative_Api"),("andThen",CLam [PVar "ma",PVar "k"] (CApp (CApp (CVar "prim_apiAndThen") (CVar "k")) (CVar "ma"))),("then",CLam [PVar "ma",PVar "mb"] (CApp (CApp (CVar "prim_apiAndThen") (CLam [PWildcard] (CVar "mb"))) (CVar "ma")))]),CoreDecl "" (CInt 0),CoreDecl "" (CInt 0),CoreDecl "Lune.Prelude.unit" (CVar "Lune.Prelude.Unit"),CoreDecl "" (CInt 0),CoreDecl "" (CInt 0),CoreDecl "" (CInt 0),CoreDecl "" (CInt 0),CoreDecl "" (CInt 0),CoreDecl "" (CInt 0),CoreDecl "" (CInt 0),CoreDecl "" (CInt 0),CoreDecl "" (CInt 0),CoreDecl "" (CInt 0),CoreDecl "" (CInt 0),CoreDecl "" (CInt 0),CoreDecl "" (CInt 0),CoreDecl "Lune.Prelude.fst" (CLam [PVar "p"] (CCase (CVar "p") [CoreAlt (PCon "Lune.Prelude.Pair" [PVar "x",PWildcard]) (CVar "x")])),CoreDecl "" (CInt 0),CoreDecl "Lune.Prelude.snd" (CLam [PVar "p"] (CCase (CVar "p") [CoreAlt (PCon "Lune.Prelude.Pair" [PWildcard,PVar "y"]) (CVar "y")])),CoreDecl "" (CInt 0),CoreDecl "" (CInt 0),CoreDecl "" (CInt 0),CoreDecl "" (CInt 0),CoreDecl "" (CInt 0),CoreDecl "" (CInt 0),CoreDecl "" (CInt 0),CoreDecl "" (CInt 0),CoreDecl "" (CInt 0),CoreDecl "" (CInt 0),CoreDecl "" (CInt 0),CoreDecl "" (CInt 0),CoreDecl "Lune.IO.println" (CVar "prim_putStrLn"),CoreDecl "" (CInt 0),CoreDecl "Lune.IO.readLine" (CVar "prim_readLine"),CoreDecl "" (CInt 0),CoreDecl "Lune.IO.readInt" (CVar "prim_readInt"),CoreDecl "" (CInt 0),CoreDecl "Lune.IO.sleepMs" (CVar "prim_sleepMs"),CoreDecl "" (CInt 0),CoreDecl "Lune.IO.readFile" (CVar "prim_readFile"),CoreDecl "" (CInt 0),CoreDecl "Lune.IO.writeFile" (CVar "prim_writeFile"),CoreDecl "" (CInt 0),CoreDecl "" (CInt 0),CoreDecl "Lune.Json.parse" (CVar "prim_jsonParse"),CoreDecl "" (CInt 0),CoreDecl "Lune.Json.stringify" (CVar "prim_jsonStringify"),CoreDecl "" (CInt 0),CoreDecl "" (CInt 0),CoreDecl "" (CInt 0),CoreDecl "" (CInt 0),CoreDecl "Lune.Http.response" (CLam [PVar "status",PVar "body"] (CRecord [("status",CVar "status"),("headers",CVar "Lune.Prelude.Nil"),("body",CVar "body")])),CoreDecl "" (CInt 0),CoreDecl "Lune.Http.jsonResponse" (CLam [PVar "status",PVar "json"] (CRecord [("status",CVar "status"),("headers",CApp (CApp (CVar "Lune.Prelude.Cons") (CRecord [("key",CString "Content-Type"),("value",CString "application/json")])) (CVar "Lune.Prelude.Nil")),("body",CApp (CVar "prim_jsonStringify") (CVar "json"))])),CoreDecl "" (CInt 0),CoreDecl "Lune.Http.ok" (CLam [PVar "body"] (CApp (CApp (CVar "Lune.Http.response") (CInt 200)) (CVar "body"))),CoreDecl "" (CInt 0),CoreDecl "Lune.Http.created" (CLam [PVar "body"] (CApp (CApp (CVar "Lune.Http.response") (CInt 201)) (CVar "body"))),CoreDecl "" (CInt 0),CoreDecl "Lune.Http.noContent" (CRecord [("status",CInt 204),("headers",CVar "Lune.Prelude.Nil"),("body",CString "")]),CoreDecl "" (CInt 0),CoreDecl "Lune.Http.badRequest" (CLam [PVar "body"] (CApp (CApp (CVar "Lune.Http.response") (CInt 400)) (CVar "body"))),CoreDecl "" (CInt 0),CoreDecl "Lune.Http.unauthorized" (CLam [PVar "body"] (CApp (CApp (CVar "Lune.Http.response") (CInt 401)) (CVar "body"))),CoreDecl "" (CInt 0),CoreDecl "Lune.Http.forbidden" (CLam [PVar "body"] (CApp (CApp (CVar "Lune.Http.response") (CInt 403)) (CVar "body"))),CoreDecl "" (CInt 0),CoreDecl "Lune.Http.notFound" (CLam [PVar "body"] (CApp (CApp (CVar "Lune.Http.response") (CInt 404)) (CVar "body"))),CoreDecl "" (CInt 0),CoreDecl "Lune.Http.conflict" (CLam [PVar "body"] (CApp (CApp (CVar "Lune.Http.response") (CInt 409)) (CVar "body"))),CoreDecl "" (CInt 0),CoreDecl "Lune.Http.serverError" (CLam [PVar "body"] (CApp (CApp (CVar "Lune.Http.response") (CInt 500)) (CVar "body"))),CoreDecl "" (CInt 0),CoreDecl "Lune.Http.redirect" (CLam [PVar "url"] (CRecord [("status",CInt 302),("headers",CApp (CApp (CVar "Lune.Prelude.Cons") (CRecord [("key",CString "Location"),("value",CVar "url")])) (CVar "Lune.Prelude.Nil")),("body",CString "")])),CoreDecl "" (CInt 0),CoreDecl "Lune.Http.jsonOk" (CLam [PVar "json"] (CApp (CApp (CVar "Lune.Http.jsonResponse") (CInt 200)) (CVar "json"))),CoreDecl "" (CInt 0),CoreDecl "Lune.Http.jsonCreated" (CLam [PVar "json"] (CApp (CApp (CVar "Lune.Http.jsonResponse") (CInt 201)) (CVar "json"))),CoreDecl "" (CInt 0),CoreDecl "Lune.Http.withHeader" (CLam [PVar "key",PVar "value",PVar "resp"] (CRecord [("status",CSelect (CVar "resp") "status"),("headers",CApp (CApp (CVar "Lune.Prelude.Cons") (CRecord [("key",CVar "key"),("value",CVar "value")])) (CSelect (CVar "resp") "headers")),("body",CSelect (CVar "resp") "body")])),CoreDecl "" (CInt 0),CoreDecl "Lune.String.append" (CVar "prim_appendString"),CoreDecl "" (CInt 0),CoreDecl "Lune.String.eq" (CVar "prim_eqString"),CoreDecl "" (CInt 0),CoreDecl "Lune.String.fromInt" (CVar "prim_showInt"),CoreDecl "" (CInt 0),CoreDecl "Lune.String.fromFloat" (CVar "prim_showFloat"),CoreDecl "" (CInt 0),CoreDecl "Lune.String.toInt" (CVar "prim_parseInt"),CoreDecl "" (CInt 0),CoreDecl "HttpParseTest.main" (CApp (CApp (CSelect (CVar "$dictMonad_IO") "then") (CApp (CVar "Lune.IO.println") (CString "=== HTTP Parse Test ==="))) (CApp (CApp (CSelect (CVar "$dictMonad_IO") "then") (CVar "HttpParseTest.testParseGet")) (CVar "HttpParseTest.testParsePost"))),CoreDecl "" (CInt 0),CoreDecl "HttpParseTest.testParseGet" (CCase (CApp (CVar "prim_parseHttpRequest") (CString "GET /users/123 HTTP/1.1\r\nHost: localhost\r\n\r\n")) [CoreAlt (PCon "Lune.Prelude.Err" [PVar "e"]) (CApp (CVar "Lune.IO.println") (CApp (CApp (CVar "Lune.String.append") (CString "Parse error: ")) (CVar "e"))),CoreAlt (PCon "Lune.Prelude.Ok" [PVar "req"]) (CApp (CApp (CSelect (CVar "$dictMonad_IO") "then") (CApp (CVar "Lune.IO.println") (CApp (CApp (CVar "Lune.String.append") (CString "Path: ")) (CSelect (CVar "req") "path")))) (CApp (CVar "Lune.IO.println") (CString "GET request parsed successfully")))]),CoreDecl "" (CInt 0),CoreDecl "HttpParseTest.testParsePost" (CCase (CApp (CVar "prim_parseHttpRequest") (CString "POST /users HTTP/1.1\r\nContent-Type: application/json\r\n\r\n{\"name\":\"Alice\"}")) [CoreAlt (PCon "Lune.Prelude.Err" [PVar "e"]) (CApp (CVar "Lune.IO.println") (CApp (CApp (CVar "Lune.String.append") (CString "Parse error: ")) (CVar "e"))),CoreAlt (PCon "Lune.Prelude.Ok" [PVar "req"]) (CApp (CApp (CSelect (CVar "$dictMonad_IO") "then") (CApp (CVar "Lune.IO.println") (CApp (CApp (CVar "Lune.String.append") (CString "Path: ")) (CSelect (CVar "req") "path")))) (CApp (CApp (CSelect (CVar "$dictMonad_IO") "then") (CApp (CVar "Lune.IO.println") (CApp (CApp (CVar "Lune.String.append") (CString "Body: ")) (CSelect (CVar "req") "body")))) (CApp (CVar "Lune.IO.println") (CString "POST request parsed successfully"))))])]}
