module HealthAgent exposing (main)

{-| System health monitoring agent using Nova LLM analysis.

    Demonstrates:
    - Structured tool outputs with Nova.tool
    - JSON decoding of LLM responses
    - User approval workflows
    - RuntimeConfig guards for tool execution
-}

import Lune.IO as IO
import Lune.Task as Task
import Lune.String as Str
import Lune.Int as Int
import Lune.Float as Float
import Lune.List as List
import Lune.Json as RawJson exposing (Json)
import Lune.Json.Decode as D
import Lune.Json.Encode as E
import Nova exposing (newClient, provider, withModel, tool)
import Nova.Core as Core exposing (Error(..), Provider, Response)
import Nova.Tool as Tool
import Nova.Runtime as Runtime exposing (RuntimeConfig, ToolExecError(..))

-- Health check result types

type alias DiskUsage =
  { mountPoint : String
  , totalGb : Float
  , usedGb : Float
  , percentUsed : Int
  }

type alias MemoryUsage =
  { totalMb : Int
  , usedMb : Int
  , availableMb : Int
  , swapUsedMb : Int
  }

type alias ProcessInfo =
  { pid : Int
  , name : String
  , cpuPercent : Float
  , memoryPercent : Float
  }

type alias ServiceStatus =
  { name : String
  , isRunning : Bool
  , uptime : Maybe String
  }

type alias HealthReport =
  { disks : List DiskUsage
  , memory : MemoryUsage
  , topProcesses : List ProcessInfo
  , services : List ServiceStatus
  }

main : Task Unit Unit
main =
  IO.println "Health Agent placeholder"
