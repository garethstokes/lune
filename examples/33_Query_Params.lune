module QueryParams exposing (main)

import Lune.IO as IO
import Lune.Prelude exposing (IO, Unit, Maybe(..), List(..))

main : IO Unit
main =
  do
    let params = prim_parseQueryString "/search?q=hello&page=2&sort=asc"
    printParams params

printParams : List { key : String, value : String } -> IO Unit
printParams ps =
  case ps of
    [] -> IO.println "done"
    Cons p rest ->
      do
        IO.println (prim_appendString p.key (prim_appendString "=" p.value))
        printParams rest
